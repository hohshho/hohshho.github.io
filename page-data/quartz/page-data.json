{"componentChunkName":"component---src-templates-post-tsx","path":"/quartz/","result":{"data":{"site":{"siteMetadata":{"title":"Just Keep Going","description":"Ian's Archive","siteUrl":"https://hohshho.github.io"}},"allMarkdownRemark":{"edges":[{"node":{"id":"d852a9c6-909b-5ddc-a5cf-8f15bbe8609d","html":"<ol start=\"0\">\n<li>들어가며</li>\n</ol>\n<p>최근 데이터 플랫폼을 개발하며, 사용자가 웹 화면에서 직접 작업 실행 주기를 설정하고 변경할 수 있는 동적 스케줄링 기능이 필요했다. 이 요구사항을 만족 시키기 위해 여러 기술적 대안을 찾아보았다.</p>\n<p>구현 방법을 찾아보니</p>\n<ol>\n<li>Shell Script + cron</li>\n<li>Spring Scheduling</li>\n<li>Quartz</li>\n<li>Kafka Streams + 스케줄링 라이브러리(Quartz같은)</li>\n</ol>\n<p>4가지 방법이 있다.</p>\n<p>각각의 장단점을 간단히 살펴보면</p>\n<ol>\n<li>Shell Script + cron: 전통적이고 강력하지만, 스케줄 변경을 위해 서버에 직접 접속해 crontab 파일을 수정해야 하므로 동적 스케줄링 요구사항에는 맞지 않았다.</li>\n<li>Spring Scheduling (@Scheduled): Spring 애플리케이션과 완벽하게 통합되어 Bean을 직접 호출할 수 있다는 큰 장점이 있다. 하지만 동적으로 스케줄을 추가하거나 변경하는 것이 복잡하고, 스케줄 정보가 메모리 기반이라 애플리케이션 재시작 시 정보가 사라지는 단점이 있었다.</li>\n<li>Quartz: 강력한 동적 스케줄링 기능과 실행 정보를 데이터베이스에 영속화하는 기능을 제공한다. 특히 여러 서버가 하나의 DB를 바라보며 동작하는 클러스터링을 지원하여 고가용성 확보에 유리했다.</li>\n<li>Kafka Streams + 스케줄링 라이브러리: MSA 환경에서 수백만 건의 이벤트를 처리하는 대규모 시스템에 적합한 방식이다. 저희 프로젝트의 규모와 요구사항에는 다소 과하다고 판단했다.</li>\n</ol>\n<p>각 기술의 장단점을 비교한 결과, 우리의 주된 요구사항인 **“동적 스케줄링”**과 배치성 작업의 안정적인 실행을 위한 “클러스터링” 및 **“영속성”**을 모두 만족하는 Quartz가 가장 적합한 선택이라고 생각해 Quartz를 사용하기로 결정했다.</p>\n<h1 id=\"1-quartz란\" style=\"position:relative;\"><a href=\"#1-quartz%EB%9E%80\" aria-label=\"1 quartz란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Quartz란?</h1>\n<ul>\n<li>Terracotta라는 회사에 의해 개발된 Job Scheduling 라이브러리</li>\n<li>완전히 자바로 개발되어 어느 자바 프로그램에서도 쉽게 통합해 개발 가능</li>\n<li>Quartz는 수십에서 수천개의 작업도 실행 가능하며 Interval형식이나 Cron 표현식으로 복잡한 스케줄링도 지원</li>\n</ul>\n<p>장점</p>\n<ul>\n<li>DB기반 스케줄러 간의 Clustering 기능 제공</li>\n<li>In-memory Job Scheduler도 제공</li>\n<li>영속성(Persistence): 스케줄 정보를 메모리(In-memory)뿐만 아니라 JDBC를 통해 데이터베이스에 저장할 수 있어, 애플리케이션이 재시작되어도 스케줄 정보가 유실되지 않는다.</li>\n<li>여러 기본 Plug-in 제공\n<ul>\n<li>ShutdownHookPlugin - JVM 종료 이벤트를 캐치해서 스케줄러에게 종료를 알려준다</li>\n<li>LoggingJobHistoryPlugin - Job 실행에 대한 로그를 남겨 디버깅할 때 유용하게 사용할 수 있다</li>\n</ul>\n</li>\n</ul>\n<p>단점</p>\n<ul>\n<li>Clustering 기능을 제공하지만, 단순한 random방식이라 완벽한 Cluster같의 로드 분산이 안된다.</li>\n<li>스케줄링 실행에 대한 History를 보관하지 않는다. 추가 작업이 필요하다.</li>\n<li>Fixed Delay타입을 보장하지 않으므로 추가 작업이 필요하다.</li>\n</ul>\n<h1 id=\"2-quartz의-주요-요소\" style=\"position:relative;\"><a href=\"#2-quartz%EC%9D%98-%EC%A3%BC%EC%9A%94-%EC%9A%94%EC%86%8C\" aria-label=\"2 quartz의 주요 요소 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Quartz의 주요 요소</h1>\n<ul>\n<li>Job : 스케줄링 된 작업을 수행(정보 포함), Job 인스턴스를 정의하고 해당 인스턴스는 Spring 빈으로 등록 가능\n<ul>\n<li>Quartz API에서 단 하나의 메서드를 가진 execute Job 인터페이스를 제공한다. 수행해야 하는 실제 작업을 이 메서드에서 구현한다.</li>\n<li>Job의 Trigger가 발생하면 스케줄러는 JobExecutionContext 개겣를 넘겨주고 execute 메서드를 호출한다.\n<ul>\n<li>JobExecutionContext는 Scheduler, Trigger, JobDetail을 포함해 Job인스턴스에 대한 정보를 제공하는 객체이다.</li>\n</ul>\n</li>\n<li>JobDataMap : JobDataMap은 Job인스턴스가 실행할 때 사용할 수 있게 원하는 정보를 담을 수 있는 객체이다.</li>\n<li>JobDetail : 작업(Job)의 인스턴스를 래핑하고 Job실행에 필요한 추가 정보를 제공 (ex - Job의 이름, 그룹, 기타 파라미터)\n<ul>\n<li>JobDetail객체는 스케줄러에 Job을 등록할 때 사용되고, Quartz는 JobDetail을 통해 어떤 Job을 언제 실행할지를 관리한다.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Trigger : Job을 언제 실행할지를 결정하는 Quartz의 구성 요소\n<ul>\n<li>Trigger와 Job의 관계\n<ul>\n<li>1 Trigger = 1 Job\n<ul>\n<li>반드시 하나의 Trigger는 반드시 하나의 Job을 지정할 수 있다.</li>\n</ul>\n</li>\n<li>N Trigger = 1 Job\n<ul>\n<li>하나의 Job을 여러 시간 떄로 실행시킬 수 있다. (ex - 매주 주말, 매 시간)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>SimpleTrigger :한번 실행하거나 지정된 간격으로 반복 실행할 때 사용</li>\n<li>Crontrigger : Corn과 같은 방식으로 복잡한 시간 기반 스케줄을 설정할 때 사용 (분, 시, 일, 월, 요일)\n<ul>\n<li>복잡한 스케줄링도 실행 가능하다. (ex - 매월 마지막 주말에 오후 3시부터 3시 30분까지)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Scheduler : 작업(Job)과 트리거(Trigger)를 등록/실행 관리하는 역할을 하며, 여러 작업과 트리거를 조정하며 작업을 실행할 시기와 방법 지정\n<ul>\n<li>SchedulerFactory : Scheduler 인스턴스를 생성하고 구성하기 위한 인터페이스</li>\n</ul>\n</li>\n<li>JobStore\n<ul>\n<li>RAM</li>\n<li>JDBC</li>\n<li>기타 JobStore (Redis, MongoDB)</li>\n</ul>\n</li>\n<li>Misfire Instructions\n<ul>\n<li>Misfire는 Job이 실행되어야 하는 시간, fire time을 지키지 못한 실행 불발을 의미한다.</li>\n<li>이런 Misfire는 Scheduler가 종료될 떄나 쓰레드 풀에 사용 가능한 쓰레드가 없는 경우에 발생한다.</li>\n<li>Scheduler가 Misfire된 Trigger에 대해서 어떻게 처리할지에 대한 다양한 policy를 지원한다.\n<ul>\n<li>ex - MISFIREINSTRUCTIONFIRE_NOW - 바로 실행, MISFIREINSTRUCTIONDO_NOTHING - 아무것도 하지 않음</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Listener\n<ul>\n<li>Listener는 Scheduler의 이벤트를 받을 수 있도록 Quartz에서 제공하는 인터페이스이며 2가지가 있다.\n<ul>\n<li>JobListener\n<ul>\n<li>job실행 전후로 이벤트를 받을 수 있다.</li>\n</ul>\n</li>\n<li>TriggerListener\n<ul>\n<li>Trigger가 발생, 불발이 일어날 때, Trigger를 완료할 떄 이벤트를 받을 수 있다.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dd21310a986bf5257a362f8b8517ba3e/dc057/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.668711656441715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABkUlEQVR42o2S6W6DQAyE8/5vlv+5RSAJCQE2XAvLuTDVuKWHSqVashDs8nns8ep+v2O32+F4POL1eqHve0zThKUYhgFlWSLPc9xuNwRBgKIooLWWZKxc15UDY4wkfxrHcRHYdZ0ACfF9H1EUIcsyXK9XYQhQKYUwDBeB05wfiqme6tI0xfP5BLtLkkS+s5gA27YV+uFwQBzHqKrqAzDnO5zfz+ezJFWx+NddfAGbpoHneSL7cvEQK4WubZDHVyShizxyZbbG1EjTDFoXsNaCQtgZO2RXfBcgvrXE4AHn1LclujrH1JfQRYa2beTcjoR10mZd15JUx/dP4PegW6fTCa7r4RGEMFoh8o+I7g4K5cGkN+QJDbCLxv0CUi2hdFGpF7IkRlNlsL3B1GmYzIcKHNiukvvjaH+s2mqpCl3m3B6PB7zLBbosfxS0wyCtcn3mPaRRnOUikEPnJbpPswieXZ+VELTdbsE95j46joP1er0MnHeOKrlvfC51wUJcnXk/ee9P4H+CnVDhZrPBfr8Xt98A7lKfZibey20AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/dd21310a986bf5257a362f8b8517ba3e/a81b5/1.webp 163w,\n/static/dd21310a986bf5257a362f8b8517ba3e/da3ef/1.webp 325w,\n/static/dd21310a986bf5257a362f8b8517ba3e/309d5/1.webp 650w,\n/static/dd21310a986bf5257a362f8b8517ba3e/e0546/1.webp 678w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/dd21310a986bf5257a362f8b8517ba3e/5e043/1.png 163w,\n/static/dd21310a986bf5257a362f8b8517ba3e/e5cc6/1.png 325w,\n/static/dd21310a986bf5257a362f8b8517ba3e/663f3/1.png 650w,\n/static/dd21310a986bf5257a362f8b8517ba3e/dc057/1.png 678w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/dd21310a986bf5257a362f8b8517ba3e/663f3/1.png\"\n            alt=\"1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h1 id=\"3-구현-순서\" style=\"position:relative;\"><a href=\"#3-%EA%B5%AC%ED%98%84-%EC%88%9C%EC%84%9C\" aria-label=\"3 구현 순서 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 구현 순서</h1>\n<ol>\n<li>build.gradle에 의존성 추가</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"20999131558966620000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`\timplementation 'org.springframework.boot:spring-boot-starter-quartz'`, `20999131558966620000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"groovy\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">\timplementation </span><span class=\"mtk8\">&#39;org.springframework.boot:spring-boot-starter-quartz&#39;</span></span></span></code></pre>\n<ol start=\"2\">\n<li>application.yml에 quartz 설정값 추가</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"17178235748737581000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`  quartz:\n    # Quartz가 스케줄 정보를 저장할 방식을 jdbc로 지정 (DB 사용)\n    job-store-type: jdbc\n    jdbc:\n      # 애플리케이션 시작 시 Quartz 관련 테이블을 자동으로 생성/초기화\n      # 개발 초기에는 'always'가 편리하지만, 운영 환경에서는 'never'로 변경하고 DDL을 수동으로 실행하는 것을 권장\n      initialize-schema: always\n    properties:\n      org.quartz.scheduler.instanceName: my-clustered-scheduler\n      org.quartz.scheduler.instanceId: AUTO\n      org.quartz.threadPool.threadCount: 10\n      org.quartz.jobStore.driverDelegateClass: org.quartz.impl.jdbcjobstore.PostgreSQLDelegate\n\n      org.quartz.jobStore.tablePrefix: QRTZ_\n      # --- 클러스터링 설정 (여러 인스턴스로 앱을 실행할 경우 필수) ---\n      org.quartz.jobStore.isClustered: true\n      org.quartz.jobStore.clusterCheckinInterval: 20000`, `17178235748737581000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"yaml\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">quartz</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># Quartz가 스케줄 정보를 저장할 방식을 jdbc로 지정 (DB 사용)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">job-store-type</span><span class=\"mtk1\">: </span><span class=\"mtk8\">jdbc</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">jdbc</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk3\"># 애플리케이션 시작 시 Quartz 관련 테이블을 자동으로 생성/초기화</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk3\"># 개발 초기에는 &#39;always&#39;가 편리하지만, 운영 환경에서는 &#39;never&#39;로 변경하고 DDL을 수동으로 실행하는 것을 권장</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">initialize-schema</span><span class=\"mtk1\">: </span><span class=\"mtk8\">always</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">properties</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">org.quartz.scheduler.instanceName</span><span class=\"mtk1\">: </span><span class=\"mtk8\">my-clustered-scheduler</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">org.quartz.scheduler.instanceId</span><span class=\"mtk1\">: </span><span class=\"mtk8\">AUTO</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">org.quartz.threadPool.threadCount</span><span class=\"mtk1\">: </span><span class=\"mtk7\">10</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">org.quartz.jobStore.driverDelegateClass</span><span class=\"mtk1\">: </span><span class=\"mtk8\">org.quartz.impl.jdbcjobstore.PostgreSQLDelegate</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">org.quartz.jobStore.tablePrefix</span><span class=\"mtk1\">: </span><span class=\"mtk8\">QRTZ_</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk3\"># --- 클러스터링 설정 (여러 인스턴스로 앱을 실행할 경우 필수) ---</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">org.quartz.jobStore.isClustered</span><span class=\"mtk1\">: </span><span class=\"mtk4\">true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">org.quartz.jobStore.clusterCheckinInterval</span><span class=\"mtk1\">: </span><span class=\"mtk7\">20000</span></span></span></code></pre>\n<ul>\n<li>DB 연동 + 클러스터링 설정.</li>\n<li>운영환경에서는 initialize-schema: never로 바꿔야 함.</li>\n</ul>\n<ol start=\"3\">\n<li>QuartzConfig 추가</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"9319842322251114000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@Configuration\n/**\n * Spring Boot의 Quartz 자동 설정을 확장하여 커스텀 설정을 적용하는 클래스.\n */\n@Configuration\npublic class QuartzConfig {\n\n    /**\n     * Quartz Job 인스턴스에 Spring의 @Autowired 의존성을 주입하기 위한 JobFactory를 Bean으로 등록합니다.\n     * @param applicationContext Spring의 ApplicationContext\n     * @return AutowiringSpringBeanJobFactory 인스턴스\n     */\n    @Bean\n    public AutowiringSpringBeanJobFactory autowiringSpringBeanJobFactory(ApplicationContext applicationContext) {\n        AutowiringSpringBeanJobFactory jobFactory = new AutowiringSpringBeanJobFactory();\n        jobFactory.setApplicationContext(applicationContext);\n        return jobFactory;\n    }\n\n    /**\n     * Spring Boot가 자동으로 생성하는 SchedulerFactoryBean에 추가 설정을 적용하기 위한 Customizer입니다.\n     * 이 방법을 사용하면 Spring Boot의 자동 설정(예: auto-startup, DataSource 연결 등)을 그대로 활용하면서\n     * 우리가 필요한 JobFactory만 추가로 설정할 수 있습니다.\n     *\n     * @param jobFactory 위에서 Bean으로 등록한 커스텀 JobFactory\n     * @return SchedulerFactoryBeanCustomizer 인스턴스\n     */\n    @Bean\n    public SchedulerFactoryBeanCustomizer schedulerFactoryBeanCustomizer(AutowiringSpringBeanJobFactory jobFactory) {\n        return schedulerFactoryBean -> {\n            // Spring Boot의 자동 설정을 기반으로, 우리가 만든 JobFactory를 사용하도록 설정합니다.\n            schedulerFactoryBean.setJobFactory(jobFactory);\n            // 여기에 다른 필요한 커스텀 설정을 추가할 수 있습니다.\n            // 예: schedulerFactoryBean.setWaitForJobsToCompleteOnShutdown(true);\n        };\n    }\n}`, `9319842322251114000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">/**</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"> * Spring Boot의 Quartz 자동 설정을 확장하여 커스텀 설정을 적용하는 클래스.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"> */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QuartzConfig</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">    /**</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * Quartz Job 인스턴스에 Spring의 @Autowired 의존성을 주입하기 위한 JobFactory를 Bean으로 등록합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * </span><span class=\"mtk4\">@param</span><span class=\"mtk3\"> </span><span class=\"mtk12\">applicationContext</span><span class=\"mtk3\"> Spring의 ApplicationContext</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * </span><span class=\"mtk4\">@return</span><span class=\"mtk3\"> AutowiringSpringBeanJobFactory 인스턴스</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AutowiringSpringBeanJobFactory</span><span class=\"mtk1\"> </span><span class=\"mtk11\">autowiringSpringBeanJobFactory</span><span class=\"mtk1\">(</span><span class=\"mtk10\">ApplicationContext</span><span class=\"mtk1\"> </span><span class=\"mtk12\">applicationContext</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">AutowiringSpringBeanJobFactory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">jobFactory</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AutowiringSpringBeanJobFactory</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">jobFactory</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setApplicationContext</span><span class=\"mtk1\">(applicationContext);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> jobFactory;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"18\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"19\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"20\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">    /**</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"21\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * Spring Boot가 자동으로 생성하는 SchedulerFactoryBean에 추가 설정을 적용하기 위한 Customizer입니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"22\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * 이 방법을 사용하면 Spring Boot의 자동 설정(예: auto-startup, DataSource 연결 등)을 그대로 활용하면서</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"23\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * 우리가 필요한 JobFactory만 추가로 설정할 수 있습니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"24\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     *</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"25\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * </span><span class=\"mtk4\">@param</span><span class=\"mtk3\"> </span><span class=\"mtk12\">jobFactory</span><span class=\"mtk3\"> 위에서 Bean으로 등록한 커스텀 JobFactory</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"26\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * </span><span class=\"mtk4\">@return</span><span class=\"mtk3\"> SchedulerFactoryBeanCustomizer 인스턴스</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"27\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"28\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"29\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SchedulerFactoryBeanCustomizer</span><span class=\"mtk1\"> </span><span class=\"mtk11\">schedulerFactoryBeanCustomizer</span><span class=\"mtk1\">(</span><span class=\"mtk10\">AutowiringSpringBeanJobFactory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">jobFactory</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"30\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> schedulerFactoryBean </span><span class=\"mtk4\">-&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"31\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// Spring Boot의 자동 설정을 기반으로, 우리가 만든 JobFactory를 사용하도록 설정합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"32\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">schedulerFactoryBean</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setJobFactory</span><span class=\"mtk1\">(jobFactory);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"33\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// 여기에 다른 필요한 커스텀 설정을 추가할 수 있습니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"34\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// 예: schedulerFactoryBean.setWaitForJobsToCompleteOnShutdown(true);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"35\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        };</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"36\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"37\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ul>\n<li>Spring Boot의 자동 설정 대신, SchedulerFactoryBean을 직접 Bean으로 등록하여 세밀하게 제어</li>\n<li>Spring의 DataSource 사용.</li>\n<li>Quartz는 기본적으로 Job객체를 직접 생성하기 떄문에 Spring DI를 받을 수 없다 -> Quartz가 생성한 Job 객체에 @Autowired로 선언된 Spring Bean들을 주입해주는 역할</li>\n<li>AutowiringSpringBeanJobFactory.java: Quartz가 Job 인스턴스를 생성할 때, Spring의 ApplicationContext를 통해 의존성을 주입해주는 핵심적인 역할</li>\n<li>application.yml 설정을 그대로 적용.</li>\n<li>@EnableAutoConfiguration 어노테이션(@SpringBootApplication 어노테이션에 의해 포함됨)에 의해서 application.properties 내의 spring.datasource.* 속성은 정의하면 자동으로 인식</li>\n</ul>\n<ol start=\"4\">\n<li>AutowiringSpringBeanJobFactory 추가</li>\n</ol>\n<ul>\n<li>Quartz가 생성하는 Job 인스턴스에 Spring의 의존성(@Autowired)을 주입하기 위한 핵심 연결 클래스 - 이 클래스는 Spring Boot가 기본으로 제공하지 않으므로, 개발자가 직접 생성</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"92208728947980530000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public final class AutowiringSpringBeanJobFactory extends SpringBeanJobFactory implements ApplicationContextAware {\n\n    private transient AutowireCapableBeanFactory beanFactory;\n\n    @Override\n    public void setApplicationContext(final ApplicationContext context) {\n        beanFactory = context.getAutowireCapableBeanFactory();\n    }\n\n    @Override\n    protected Object createJobInstance(final TriggerFiredBundle bundle) throws Exception {\n        final Object job = super.createJobInstance(bundle);\n        beanFactory.autowireBean(job);\n        return job;\n    }\n}`, `92208728947980530000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AutowiringSpringBeanJobFactory</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SpringBeanJobFactory</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ApplicationContextAware</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk4\">transient</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AutowireCapableBeanFactory</span><span class=\"mtk1\"> </span><span class=\"mtk12\">beanFactory</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setApplicationContext</span><span class=\"mtk1\">(</span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ApplicationContext</span><span class=\"mtk1\"> </span><span class=\"mtk12\">context</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        beanFactory = </span><span class=\"mtk12\">context</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getAutowireCapableBeanFactory</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">protected</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk11\">createJobInstance</span><span class=\"mtk1\">(</span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">TriggerFiredBundle</span><span class=\"mtk1\"> </span><span class=\"mtk12\">bundle</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Exception</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk12\">job</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">super</span><span class=\"mtk1\">.</span><span class=\"mtk11\">createJobInstance</span><span class=\"mtk1\">(bundle);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">beanFactory</span><span class=\"mtk1\">.</span><span class=\"mtk11\">autowireBean</span><span class=\"mtk1\">(job);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> job;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ul>\n<li>핵심 역할: Quartz와 Spring은 서로 다른 생명주기를 가지기 때문에, Quartz가 직접 생성한 Job 객체는 원래 Spring의 DI(의존성 주입) 혜택을 받을 수 없다. 이 클래스는 그 간극을 메워주는 다리 역할</li>\n<li>동작 원리:\n<ul>\n<li>createJobInstance() 메소드는 Quartz 스케줄러가 Job을 실행하기 위해 Job 인스턴스를 생성한 직후에 호출</li>\n<li>이 메소드를 오버라이드하여, Quartz가 막 생성한 순수한 객체(job)를 Spring의 AutowireCapableBeanFactory에 넘겨준다.</li>\n<li>beanFactory.autowireBean(job) 코드가 실행되는 순간, Spring은 해당 객체를 스캔하여 @Autowired가 붙은 모든 필드에 적절한 Bean을 주입</li>\n</ul>\n</li>\n<li>결과: 이 과정을 통해, 우리가 작성한 ExampleJob 클래스 안에서도 SomeService와 같은 다른 Spring Bean들을 @Autowired로 주입받아 사용할 수 있게 된다.</li>\n</ul>\n<ol>\n<li>job Api controller, service, dao 추가</li>\n</ol>\n<p>job을 추가하길 원하는 service에서 job service를 호출해 job등록</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"63600055548636770000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// controller\n@RestController\n@RequestMapping(&quot;/wrk/api/clct&quot;)\n@Tag(name = &quot;Clct Job API&quot;, description = &quot;연계 작업 관리 API 입니다.&quot;)\n@RequiredArgsConstructor\npublic class WrkClctController {\n    ...\n\n    @PostMapping\n    @Operation(summary = &quot;등록&quot;, description = &quot;연계 데이터를 등록합니다.&quot;)\n    public ApiResponse<Map<String, String>> create(@RequestBody @Valid SchedulSaveDto dto) {\n         wrkClctService.insert(dto);\n        Map<String, String> result = Map.of(&quot;schedulId&quot;, dto.getSchedulId());\n        result = Map.of(&quot;datalinkId&quot;, dto.getDatalinkId());\n        return new ApiResponse<>(SuccessCode.CREATED, result);\n    }\n\n    ...\n}\n\n// service\n@Slf4j\n@Service\n@RequiredArgsConstructor\npublic class WrkClctServiceImpl implements WrkClctService {\n    \n    ...\n\n    @Override\n    @Transactional\n    public String insert(SchedulSaveDto dto) {\n        wrkClctDao.datalinkInsert(dto);\n        switch (dto.getClctLinkType()) {\n            case &quot;module&quot;: wrkClctDao.insertDatalinkModule(dto); break;\n            case &quot;file&quot;: wrkClctDao.insertDatalinkFile(dto); break;\n            case &quot;db&quot;: wrkClctDao.insertDatalinkDb(dto); break;\n            case &quot;api&quot;: wrkClctDao.insertDatalinkApi(dto); break;\n            default: throw new IllegalArgumentException(&quot;지원하지 않는 연계 유형입니다: &quot; + dto.getClctLinkType());\n        }\n        wrkClctDao.schedulInsert(dto);\n\n        // 1. 새로 생성된 스케줄의 상세 정보를 DB에서 조회합니다.\n        SchedulDetailDto newSchedul = wrkClctDao.getSchedulDetailById(dto.getSchedulId());\n        if (newSchedul != null) {\n            // 2. 타입과 상관없이, 모든 Job 정보(JobDetail)를 Quartz에 등록합니다.\n            quartzSchedulService.addOrUpdateJob(newSchedul);\n\n            // 3. &quot;once&quot;가 아니고 &quot;실행&quot; 상태일 때만 Cron 스케줄을 등록합니다.\n            if (!&quot;once&quot;.equals(newSchedul.getExcnCycle()) && Objects.equals(&quot;t&quot;, newSchedul.getSchedulExcnYn())) {\n                log.info(&quot;[Quartz-Insert] 신규 정기 스케줄({})을 Quartz에 등록합니다.&quot;, newSchedul.getSchedulId());\n                quartzSchedulService.scheduleCronJob(newSchedul);\n            }\n        }\n\n        return dto.getSchedulId();\n    }\n\n    ...\n}`, `63600055548636770000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">// controller</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">RestController</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">RequestMapping</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/wrk/api/clct&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Tag</span><span class=\"mtk1\">(name = </span><span class=\"mtk8\">&quot;Clct Job API&quot;</span><span class=\"mtk1\">, description = </span><span class=\"mtk8\">&quot;연계 작업 관리 API 입니다.&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">RequiredArgsConstructor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">WrkClctController</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">PostMapping</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Operation</span><span class=\"mtk1\">(summary = </span><span class=\"mtk8\">&quot;등록&quot;</span><span class=\"mtk1\">, description = </span><span class=\"mtk8\">&quot;연계 데이터를 등록합니다.&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ApiResponse</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Map</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">String</span><span class=\"mtk1\">, </span><span class=\"mtk10\">String</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk11\">create</span><span class=\"mtk1\">(@</span><span class=\"mtk10\">RequestBody</span><span class=\"mtk1\"> @</span><span class=\"mtk10\">Valid</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SchedulSaveDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">dto</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">         </span><span class=\"mtk12\">wrkClctService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">insert</span><span class=\"mtk1\">(dto);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">Map</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">String</span><span class=\"mtk1\">, </span><span class=\"mtk10\">String</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">result</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">Map</span><span class=\"mtk1\">.</span><span class=\"mtk11\">of</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;schedulId&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">dto</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulId</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        result = </span><span class=\"mtk12\">Map</span><span class=\"mtk1\">.</span><span class=\"mtk11\">of</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;datalinkId&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">dto</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getDatalinkId</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ApiResponse</span><span class=\"mtk1\">&lt;&gt;(</span><span class=\"mtk12\">SuccessCode</span><span class=\"mtk1\">.</span><span class=\"mtk12\">CREATED</span><span class=\"mtk1\">, result);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"18\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"19\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"20\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"21\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">// service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"22\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Slf4j</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"23\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"24\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">RequiredArgsConstructor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"25\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">WrkClctServiceImpl</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">WrkClctService</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"26\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"27\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"28\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"29\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"30\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Transactional</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"31\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk11\">insert</span><span class=\"mtk1\">(</span><span class=\"mtk10\">SchedulSaveDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">dto</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"32\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">.</span><span class=\"mtk11\">datalinkInsert</span><span class=\"mtk1\">(dto);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"33\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">switch</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">dto</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getClctLinkType</span><span class=\"mtk1\">()) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"34\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;module&quot;</span><span class=\"mtk15\">:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">.</span><span class=\"mtk11\">insertDatalinkModule</span><span class=\"mtk1\">(dto); </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"35\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;file&quot;</span><span class=\"mtk15\">:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">.</span><span class=\"mtk11\">insertDatalinkFile</span><span class=\"mtk1\">(dto); </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"36\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;db&quot;</span><span class=\"mtk15\">:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">.</span><span class=\"mtk11\">insertDatalinkDb</span><span class=\"mtk1\">(dto); </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"37\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;api&quot;</span><span class=\"mtk15\">:</span><span class=\"mtk1\"> </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">.</span><span class=\"mtk11\">insertDatalinkApi</span><span class=\"mtk1\">(dto); </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"38\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">default:</span><span class=\"mtk1\"> </span><span class=\"mtk15\">throw</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">IllegalArgumentException</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;지원하지 않는 연계 유형입니다: &quot;</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">dto</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getClctLinkType</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"39\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"40\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">.</span><span class=\"mtk11\">schedulInsert</span><span class=\"mtk1\">(dto);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"41\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"42\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// 1. 새로 생성된 스케줄의 상세 정보를 DB에서 조회합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"43\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">SchedulDetailDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">newSchedul</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulDetailById</span><span class=\"mtk1\">(</span><span class=\"mtk12\">dto</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulId</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"44\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (newSchedul != </span><span class=\"mtk4\">null</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"45\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// 2. 타입과 상관없이, 모든 Job 정보(JobDetail)를 Quartz에 등록합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"46\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">quartzSchedulService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addOrUpdateJob</span><span class=\"mtk1\">(newSchedul);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"47\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"48\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// 3. &quot;once&quot;가 아니고 &quot;실행&quot; 상태일 때만 Cron 스케줄을 등록합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"49\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (!</span><span class=\"mtk8\">&quot;once&quot;</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equals</span><span class=\"mtk1\">(</span><span class=\"mtk12\">newSchedul</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getExcnCycle</span><span class=\"mtk1\">()) &amp;&amp; </span><span class=\"mtk12\">Objects</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equals</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;t&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">newSchedul</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulExcnYn</span><span class=\"mtk1\">())) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"50\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;[Quartz-Insert] 신규 정기 스케줄({})을 Quartz에 등록합니다.&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">newSchedul</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulId</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"51\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">quartzSchedulService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">scheduleCronJob</span><span class=\"mtk1\">(newSchedul);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"52\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"53\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"54\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"55\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">dto</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulId</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"56\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"57\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"58\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"59\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ul>\n<li>Controller → wrkClctService.insert() 호출.</li>\n<li>wrkClctService.insert()에서:\n<ul>\n<li>DB에 스케줄 정보 저장.</li>\n<li>반복 스케줄이면 QuartzSchedulService.addOrUpdateSchedul() 호출해서 Quartz에 등록.</li>\n</ul>\n</li>\n</ul>\n<ol start=\"6\">\n<li>Job service추가</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"38185169506351735000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@Slf4j\n@Service\n@RequiredArgsConstructor\npublic class QuartzSchedulService {\n\n    private final Scheduler scheduler;\n\n    /**\n     * Job 정보(JobDetail)를 Quartz DB에 등록하거나 갱신합니다.\n     * 이 메소드는 Trigger를 만들지 않습니다.\n     */\n    public void addOrUpdateJob(SchedulDetailDto schedulDetail) {\n        try {\n            JobDetail jobDetail = buildJobDetail(schedulDetail);\n            // .storeDurably()가 설정되어 있으므로 Trigger 없이 Job 정보만 저장/갱신 가능\n            scheduler.addJob(jobDetail, true); // true: 이미 존재하면 덮어쓰기\n            log.info(&quot;Quartz Job 정보 등록/갱신 성공: {}&quot;, schedulDetail.getSchedulTitle());\n        } catch (SchedulerException e) {\n            log.error(&quot;Quartz Job 정보 등록/갱신 실패 (Schedul ID: {})&quot;, schedulDetail.getSchedulId(), e);\n        }\n    }\n\n    /**\n     * Cron Trigger를 등록하거나 업데이트합니다.\n     * 이 메소드가 호출되기 전에 해당 JobDetail이 이미 등록되어 있어야 합니다.\n     */\n    public void scheduleCronJob(SchedulDetailDto schedulDetail) {\n        try {\n            Trigger trigger = buildTrigger(schedulDetail);\n            if (scheduler.checkExists(trigger.getKey())) {\n                scheduler.rescheduleJob(trigger.getKey(), trigger);\n                log.info(&quot;Quartz 스케줄(Cron) 업데이트 성공: {}&quot;, schedulDetail.getSchedulTitle());\n            } else {\n                scheduler.scheduleJob(trigger);\n                log.info(&quot;Quartz 스케줄(Cron) 신규 등록 성공: {}&quot;, schedulDetail.getSchedulTitle());\n            }\n        } catch (SchedulerException e) {\n            log.error(&quot;Quartz 스케줄(Cron) 등록/수정 실패 (Schedul ID: {})&quot;, schedulDetail.getSchedulId(), e);\n        }\n    }\n\n    /**\n     * Quartz에서 스케줄을 삭제합니다.\n     * @param schedulId 삭제할 스케줄의 ID\n     */\n    public void deleteSchedul(String schedulId) {\n        try {\n            JobKey jobKey = new JobKey(schedulId);\n            if (scheduler.checkExists(jobKey)) {\n                scheduler.deleteJob(jobKey);\n                log.info(&quot;Quartz 스케줄 삭제 성공: {}&quot;, schedulId);\n            }\n        } catch (SchedulerException e) {\n            log.error(&quot;Quartz 스케줄 삭제 실패 (Schedul ID: {})&quot;, schedulId, e);\n        }\n    }\n\n    /**\n     * 특정 Job을 즉시 한 번 실행합니다. (수동 실행용)\n     * @param schedulId 즉시 실행할 스케줄(Job)의 ID\n     */\n    public void triggerJobNow(String schedulId) {\n        try {\n            JobKey jobKey = new JobKey(schedulId);\n            // 해당 Job이 DB에 등록되어 있는지 먼저 확인\n            if (scheduler.checkExists(jobKey)) {\n                // 고유한 이름으로 일회성 트리거를 생성\n                String tempTriggerKey = &quot;manual-trigger-&quot; + UUID.randomUUID().toString();\n\n                Trigger manualTrigger = TriggerBuilder.newTrigger()\n                        .forJob(jobKey) // 기존에 등록된 Job을 가르킴\n                        .withIdentity(tempTriggerKey)\n                        .withDescription(&quot;Manual execution for &quot; + schedulId)\n                        .startNow() // &quot;지금 당장 시작하라&quot;는 스케줄\n                        .build();\n\n                // 스케줄러에 일회성 트리거를 등록하여 Job을 실행\n                scheduler.scheduleJob(manualTrigger);\n                log.info(&quot;Job 즉시 실행 요청 성공 (Schedul ID: {})&quot;, schedulId);\n            } else {\n                log.warn(&quot;Job을 찾을 수 없어 즉시 실행할 수 없습니다 (Schedul ID: {})&quot;, schedulId);\n                // 필요하다면 여기서 예외\n                // throw new RuntimeException(&quot;Job not found: &quot; + schedulId);\n            }\n        } catch (SchedulerException e) {\n            log.error(&quot;Job 즉시 실행 요청 실패 (Schedul ID: {})&quot;, schedulId, e);\n        }\n    }\n\n    private JobDetail buildJobDetail(SchedulDetailDto schedulDetail) { // 파라미터 타입 변경\n        return JobBuilder.newJob(DataPlatformJob.class)\n                .withIdentity(schedulDetail.getSchedulId())\n                .withDescription(schedulDetail.getSchedulTitle())\n                .storeDurably()\n                .build();\n    }\n\n    private Trigger buildTrigger(SchedulDetailDto schedulDetail) { // 파라미터 타입 변경\n        return TriggerBuilder.newTrigger()\n                .forJob(schedulDetail.getSchedulId())\n                .withIdentity(schedulDetail.getSchedulId())\n                .withSchedule(CronScheduleBuilder.cronSchedule(createCronExpression(schedulDetail)))\n                .build();\n    }\n\n    private String createCronExpression(SchedulDetailDto schedulDetail) { // 파라미터 타입 변경\n        String sec = schedulDetail.getExcnSec();\n        String min = schedulDetail.getExcnMin();\n        String hour = schedulDetail.getExcnHour();\n        String dayOfMonth = &quot;?&quot;;\n        String month = &quot;*&quot;;\n        String dayOfWeek = &quot;?&quot;;\n\n        switch (schedulDetail.getExcnCycle()) {\n            case &quot;day&quot;: // 매일\n                dayOfMonth = &quot;*&quot;;\n                break;\n            case &quot;week&quot;: // 매주\n                dayOfWeek = String.valueOf(schedulDetail.getExcnWday()); // Integer를 String으로 변환\n                break;\n            case &quot;month&quot;: // 매월\n                dayOfMonth = schedulDetail.getExcnDe();\n                break;\n            default:\n                // &quot;once&quot;나 다른 타입은 Quartz에 등록되지 않으므로, 이 메소드가 호출될 일이 없음\n                // 만약 호출된다면 에러를 던지거나 기본값 처리\n                log.warn(&quot;지원하지 않는 주기 '{}'에 대한 Cron 표현식 생성이 시도되었습니다.&quot;, schedulDetail.getExcnCycle());\n                dayOfMonth = &quot;*&quot;; // 안전을 위한 기본값\n                break;\n        }\n\n        String cron = String.format(&quot;%s %s %s %s %s %s&quot;, sec, min, hour, dayOfMonth, month, dayOfWeek);\n        log.debug(&quot;생성된 Cron: [{}] for Schedul: {}&quot;, cron, schedulDetail.getSchedulTitle());\n        return cron;\n    }\n}`, `38185169506351735000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Slf4j</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">RequiredArgsConstructor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QuartzSchedulService</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Scheduler</span><span class=\"mtk1\"> </span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">    /**</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * Job 정보(JobDetail)를 Quartz DB에 등록하거나 갱신합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * 이 메소드는 Trigger를 만들지 않습니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">addOrUpdateJob</span><span class=\"mtk1\">(</span><span class=\"mtk10\">SchedulDetailDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">JobDetail</span><span class=\"mtk1\"> </span><span class=\"mtk12\">jobDetail</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">buildJobDetail</span><span class=\"mtk1\">(schedulDetail);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// .storeDurably()가 설정되어 있으므로 Trigger 없이 Job 정보만 저장/갱신 가능</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addJob</span><span class=\"mtk1\">(jobDetail, </span><span class=\"mtk4\">true</span><span class=\"mtk1\">); </span><span class=\"mtk3\">// true: 이미 존재하면 덮어쓰기</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Quartz Job 정보 등록/갱신 성공: {}&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulTitle</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"18\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">catch</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">SchedulerException</span><span class=\"mtk1\"> </span><span class=\"mtk12\">e</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"19\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">error</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Quartz Job 정보 등록/갱신 실패 (Schedul ID: {})&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulId</span><span class=\"mtk1\">(), e);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"20\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"21\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"22\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"23\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">    /**</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"24\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * Cron Trigger를 등록하거나 업데이트합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"25\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * 이 메소드가 호출되기 전에 해당 JobDetail이 이미 등록되어 있어야 합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"26\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"27\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">scheduleCronJob</span><span class=\"mtk1\">(</span><span class=\"mtk10\">SchedulDetailDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"28\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"29\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">Trigger</span><span class=\"mtk1\"> </span><span class=\"mtk12\">trigger</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">buildTrigger</span><span class=\"mtk1\">(schedulDetail);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"30\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">.</span><span class=\"mtk11\">checkExists</span><span class=\"mtk1\">(</span><span class=\"mtk12\">trigger</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getKey</span><span class=\"mtk1\">())) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"31\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">.</span><span class=\"mtk11\">rescheduleJob</span><span class=\"mtk1\">(</span><span class=\"mtk12\">trigger</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getKey</span><span class=\"mtk1\">(), trigger);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"32\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Quartz 스케줄(Cron) 업데이트 성공: {}&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulTitle</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"33\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"34\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">.</span><span class=\"mtk11\">scheduleJob</span><span class=\"mtk1\">(trigger);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"35\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Quartz 스케줄(Cron) 신규 등록 성공: {}&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulTitle</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"36\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"37\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">catch</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">SchedulerException</span><span class=\"mtk1\"> </span><span class=\"mtk12\">e</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"38\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">error</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Quartz 스케줄(Cron) 등록/수정 실패 (Schedul ID: {})&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulId</span><span class=\"mtk1\">(), e);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"39\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"40\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"41\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"42\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">    /**</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"43\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * Quartz에서 스케줄을 삭제합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"44\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * </span><span class=\"mtk4\">@param</span><span class=\"mtk3\"> </span><span class=\"mtk12\">schedulId</span><span class=\"mtk3\"> 삭제할 스케줄의 ID</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"45\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"46\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">deleteSchedul</span><span class=\"mtk1\">(</span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">schedulId</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"47\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"48\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">JobKey</span><span class=\"mtk1\"> </span><span class=\"mtk12\">jobKey</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">JobKey</span><span class=\"mtk1\">(schedulId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"49\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">.</span><span class=\"mtk11\">checkExists</span><span class=\"mtk1\">(jobKey)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"50\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">.</span><span class=\"mtk11\">deleteJob</span><span class=\"mtk1\">(jobKey);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"51\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Quartz 스케줄 삭제 성공: {}&quot;</span><span class=\"mtk1\">, schedulId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"52\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"53\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">catch</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">SchedulerException</span><span class=\"mtk1\"> </span><span class=\"mtk12\">e</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"54\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">error</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Quartz 스케줄 삭제 실패 (Schedul ID: {})&quot;</span><span class=\"mtk1\">, schedulId, e);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"55\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"56\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"57\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"58\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">    /**</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"59\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * 특정 Job을 즉시 한 번 실행합니다. (수동 실행용)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"60\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     * </span><span class=\"mtk4\">@param</span><span class=\"mtk3\"> </span><span class=\"mtk12\">schedulId</span><span class=\"mtk3\"> 즉시 실행할 스케줄(Job)의 ID</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"61\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">     */</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"62\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">triggerJobNow</span><span class=\"mtk1\">(</span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">schedulId</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"63\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"64\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">JobKey</span><span class=\"mtk1\"> </span><span class=\"mtk12\">jobKey</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">JobKey</span><span class=\"mtk1\">(schedulId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"65\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// 해당 Job이 DB에 등록되어 있는지 먼저 확인</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"66\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">.</span><span class=\"mtk11\">checkExists</span><span class=\"mtk1\">(jobKey)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"67\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk3\">// 고유한 이름으로 일회성 트리거를 생성</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"68\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">tempTriggerKey</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">&quot;manual-trigger-&quot;</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">UUID</span><span class=\"mtk1\">.</span><span class=\"mtk11\">randomUUID</span><span class=\"mtk1\">().</span><span class=\"mtk11\">toString</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"69\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"70\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk10\">Trigger</span><span class=\"mtk1\"> </span><span class=\"mtk12\">manualTrigger</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">TriggerBuilder</span><span class=\"mtk1\">.</span><span class=\"mtk11\">newTrigger</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"71\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                        .</span><span class=\"mtk11\">forJob</span><span class=\"mtk1\">(jobKey) </span><span class=\"mtk3\">// 기존에 등록된 Job을 가르킴</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"72\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                        .</span><span class=\"mtk11\">withIdentity</span><span class=\"mtk1\">(tempTriggerKey)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"73\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                        .</span><span class=\"mtk11\">withDescription</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Manual execution for &quot;</span><span class=\"mtk1\"> + schedulId)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"74\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                        .</span><span class=\"mtk11\">startNow</span><span class=\"mtk1\">() </span><span class=\"mtk3\">// &quot;지금 당장 시작하라&quot;는 스케줄</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"75\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                        .</span><span class=\"mtk11\">build</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"76\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"77\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk3\">// 스케줄러에 일회성 트리거를 등록하여 Job을 실행</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"78\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">.</span><span class=\"mtk11\">scheduleJob</span><span class=\"mtk1\">(manualTrigger);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"79\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Job 즉시 실행 요청 성공 (Schedul ID: {})&quot;</span><span class=\"mtk1\">, schedulId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"80\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"81\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">warn</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Job을 찾을 수 없어 즉시 실행할 수 없습니다 (Schedul ID: {})&quot;</span><span class=\"mtk1\">, schedulId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"82\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk3\">// 필요하다면 여기서 예외</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"83\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk3\">// throw new RuntimeException(&quot;Job not found: &quot; + schedulId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"84\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"85\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">catch</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">SchedulerException</span><span class=\"mtk1\"> </span><span class=\"mtk12\">e</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"86\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">error</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Job 즉시 실행 요청 실패 (Schedul ID: {})&quot;</span><span class=\"mtk1\">, schedulId, e);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"87\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"88\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"89\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"90\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">JobDetail</span><span class=\"mtk1\"> </span><span class=\"mtk11\">buildJobDetail</span><span class=\"mtk1\">(</span><span class=\"mtk10\">SchedulDetailDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">) { </span><span class=\"mtk3\">// 파라미터 타입 변경</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"91\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">JobBuilder</span><span class=\"mtk1\">.</span><span class=\"mtk11\">newJob</span><span class=\"mtk1\">(</span><span class=\"mtk12\">DataPlatformJob</span><span class=\"mtk1\">.</span><span class=\"mtk12\">class</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"92\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">withIdentity</span><span class=\"mtk1\">(</span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulId</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"93\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">withDescription</span><span class=\"mtk1\">(</span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulTitle</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"94\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">storeDurably</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"95\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">build</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"96\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"97\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"98\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Trigger</span><span class=\"mtk1\"> </span><span class=\"mtk11\">buildTrigger</span><span class=\"mtk1\">(</span><span class=\"mtk10\">SchedulDetailDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">) { </span><span class=\"mtk3\">// 파라미터 타입 변경</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"99\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">TriggerBuilder</span><span class=\"mtk1\">.</span><span class=\"mtk11\">newTrigger</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"100\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">forJob</span><span class=\"mtk1\">(</span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulId</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"101\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">withIdentity</span><span class=\"mtk1\">(</span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulId</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"102\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">withSchedule</span><span class=\"mtk1\">(</span><span class=\"mtk12\">CronScheduleBuilder</span><span class=\"mtk1\">.</span><span class=\"mtk11\">cronSchedule</span><span class=\"mtk1\">(</span><span class=\"mtk11\">createCronExpression</span><span class=\"mtk1\">(schedulDetail)))</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"103\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">build</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"104\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"105\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"106\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk11\">createCronExpression</span><span class=\"mtk1\">(</span><span class=\"mtk10\">SchedulDetailDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">) { </span><span class=\"mtk3\">// 파라미터 타입 변경</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"107\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">sec</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getExcnSec</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"108\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">min</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getExcnMin</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"109\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">hour</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getExcnHour</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"110\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">dayOfMonth</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">&quot;?&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"111\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">month</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">&quot;*&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"112\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">dayOfWeek</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">&quot;?&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"113\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"114\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">switch</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getExcnCycle</span><span class=\"mtk1\">()) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"115\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;day&quot;</span><span class=\"mtk15\">:</span><span class=\"mtk1\"> </span><span class=\"mtk3\">// 매일</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"116\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                dayOfMonth = </span><span class=\"mtk8\">&quot;*&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"117\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"118\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;week&quot;</span><span class=\"mtk15\">:</span><span class=\"mtk1\"> </span><span class=\"mtk3\">// 매주</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"119\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                dayOfWeek = </span><span class=\"mtk12\">String</span><span class=\"mtk1\">.</span><span class=\"mtk11\">valueOf</span><span class=\"mtk1\">(</span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getExcnWday</span><span class=\"mtk1\">()); </span><span class=\"mtk3\">// Integer를 String으로 변환</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"120\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"121\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;month&quot;</span><span class=\"mtk15\">:</span><span class=\"mtk1\"> </span><span class=\"mtk3\">// 매월</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"122\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                dayOfMonth = </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getExcnDe</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"123\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"124\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">default:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"125\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk3\">// &quot;once&quot;나 다른 타입은 Quartz에 등록되지 않으므로, 이 메소드가 호출될 일이 없음</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"126\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk3\">// 만약 호출된다면 에러를 던지거나 기본값 처리</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"127\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">warn</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;지원하지 않는 주기 &#39;{}&#39;에 대한 Cron 표현식 생성이 시도되었습니다.&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getExcnCycle</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"128\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                dayOfMonth = </span><span class=\"mtk8\">&quot;*&quot;</span><span class=\"mtk1\">; </span><span class=\"mtk3\">// 안전을 위한 기본값</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"129\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"130\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"131\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"132\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">cron</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">String</span><span class=\"mtk1\">.</span><span class=\"mtk11\">format</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;%s %s %s %s %s %s&quot;</span><span class=\"mtk1\">, sec, min, hour, dayOfMonth, month, dayOfWeek);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"133\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">debug</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;생성된 Cron: [{}] for Schedul: {}&quot;</span><span class=\"mtk1\">, cron, </span><span class=\"mtk12\">schedulDetail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulTitle</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"134\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> cron;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"135\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"136\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ul>\n<li>Quartz에 Job 등록/수정/삭제/즉시 실행 기능 제공.</li>\n</ul>\n<ol start=\"7\">\n<li>job 추가</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"2177724545384007700\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`import com.egis.dataplatform.clct.dms.wrk.clct.dao.WrkClctDao;\nimport com.egis.dataplatform.clct.dms.wrk.clct.dto.response.SchedulDetailDto;\nimport lombok.extern.slf4j.Slf4j;\nimport org.quartz.DisallowConcurrentExecution;\nimport org.quartz.Job;\nimport org.quartz.JobExecutionContext;\nimport org.quartz.JobExecutionException;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Component;\n\n@Slf4j\n@Component\n@DisallowConcurrentExecution\npublic class DataPlatformJob implements Job {\n\n    // Job은 Spring 컨테이너와 라이프사이클이 다르므로, @Autowired를 통해 Bean을 주입받아야 합니다.\n    @Autowired\n    private WrkClctDao wrkClctDao;\n\n    @Override\n    public void execute(JobExecutionContext context) throws JobExecutionException {\n        String schedulId = context.getJobDetail().getKey().getName();\n        log.info(&quot;>>>>>> Quartz Job 실행 시작 (Schedul ID: {}) <<<<<<&quot;, schedulId);\n\n        try {\n            SchedulDetailDto detail = wrkClctDao.getSchedulDetailById(schedulId);\n            if (detail == null) {\n                throw new JobExecutionException(&quot;스케줄 정보를 찾을 수 없습니다: &quot; + schedulId);\n            }\n\n            log.info(&quot;스케줄 제목: [{}], 연계 유형: [{}]&quot;, detail.getSchedulTitle(), detail.getClctLinkType());\n\n            switch (detail.getClctLinkType()) {\n                case &quot;module&quot;:\n                    log.info(&quot;모듈 실행: {}&quot;, detail.getModuleDfn());\n                    // moduleService.execute(detail);\n                    break;\n                case &quot;file&quot;:\n                    log.info(&quot;파일 수집: {}/{}&quot;, detail.getFileDir(), detail.getFileNm());\n                    // fileService.execute(detail);\n                    break;\n                case &quot;db&quot;:\n                    log.info(&quot;DB 수집: {}.{}.{}&quot;, detail.getDbIp(), detail.getSchmaNm(), detail.getTableNm());\n                    // dbService.execute(detail);\n                    break;\n                case &quot;api&quot;:\n                    log.info(&quot;API 호출: {}&quot;, detail.getApiUrl());\n                    // apiService.execute(detail);\n                    break;\n                default:\n                    log.warn(&quot;지원하지 않는 연계 유형입니다: {}&quot;, detail.getClctLinkType());\n            }\n\n        } catch (Exception e) {\n            log.error(&quot;Job 실행 중 에러 발생 (Schedul ID: {})&quot;, schedulId, e);\n\n            throw new JobExecutionException(e);\n        }\n\n        log.info(&quot;>>>>>> Quartz Job 실행 완료 (Schedul ID: {}) <<<<<<&quot;, schedulId);\n    }\n}`, `2177724545384007700`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">import</span><span class=\"mtk1\"> com.egis.dataplatform.clct.dms.wrk.clct.dao.WrkClctDao;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">import</span><span class=\"mtk1\"> com.egis.dataplatform.clct.dms.wrk.clct.dto.response.SchedulDetailDto;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">import</span><span class=\"mtk1\"> lombok.extern.slf4j.Slf4j;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">import</span><span class=\"mtk1\"> org.quartz.DisallowConcurrentExecution;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">import</span><span class=\"mtk1\"> org.quartz.Job;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">import</span><span class=\"mtk1\"> org.quartz.JobExecutionContext;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">import</span><span class=\"mtk1\"> org.quartz.JobExecutionException;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">import</span><span class=\"mtk1\"> org.springframework.beans.factory.annotation.Autowired;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">import</span><span class=\"mtk1\"> org.springframework.stereotype.Component;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Slf4j</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Component</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">DisallowConcurrentExecution</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">DataPlatformJob</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Job</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">// Job은 Spring 컨테이너와 라이프사이클이 다르므로, @Autowired를 통해 Bean을 주입받아야 합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Autowired</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"18\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">WrkClctDao</span><span class=\"mtk1\"> </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"19\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"20\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"21\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">execute</span><span class=\"mtk1\">(</span><span class=\"mtk10\">JobExecutionContext</span><span class=\"mtk1\"> </span><span class=\"mtk12\">context</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">JobExecutionException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"22\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">schedulId</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">context</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getJobDetail</span><span class=\"mtk1\">().</span><span class=\"mtk11\">getKey</span><span class=\"mtk1\">().</span><span class=\"mtk11\">getName</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"23\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;&gt;&gt;&gt;&gt;&gt;&gt; Quartz Job 실행 시작 (Schedul ID: {}) &lt;&lt;&lt;&lt;&lt;&lt;&quot;</span><span class=\"mtk1\">, schedulId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"24\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"25\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"26\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">SchedulDetailDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">detail</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulDetailById</span><span class=\"mtk1\">(schedulId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"27\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (detail == </span><span class=\"mtk4\">null</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"28\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">throw</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">JobExecutionException</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;스케줄 정보를 찾을 수 없습니다: &quot;</span><span class=\"mtk1\"> + schedulId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"29\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"30\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"31\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;스케줄 제목: [{}], 연계 유형: [{}]&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulTitle</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getClctLinkType</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"32\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"33\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">switch</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getClctLinkType</span><span class=\"mtk1\">()) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"34\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;module&quot;</span><span class=\"mtk15\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"35\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;모듈 실행: {}&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getModuleDfn</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"36\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk3\">// moduleService.execute(detail);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"37\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"38\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;file&quot;</span><span class=\"mtk15\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"39\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;파일 수집: {}/{}&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getFileDir</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getFileNm</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"40\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk3\">// fileService.execute(detail);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"41\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"42\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;db&quot;</span><span class=\"mtk15\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"43\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;DB 수집: {}.{}.{}&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getDbIp</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchmaNm</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getTableNm</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"44\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk3\">// dbService.execute(detail);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"45\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"46\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">case</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;api&quot;</span><span class=\"mtk15\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"47\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;API 호출: {}&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getApiUrl</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"48\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk3\">// apiService.execute(detail);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"49\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"50\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">default:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"51\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">warn</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;지원하지 않는 연계 유형입니다: {}&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getClctLinkType</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"52\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"53\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"54\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">catch</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">Exception</span><span class=\"mtk1\"> </span><span class=\"mtk12\">e</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"55\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">error</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Job 실행 중 에러 발생 (Schedul ID: {})&quot;</span><span class=\"mtk1\">, schedulId, e);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"56\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"57\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">throw</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">JobExecutionException</span><span class=\"mtk1\">(e);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"58\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"59\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"60\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;&gt;&gt;&gt;&gt;&gt;&gt; Quartz Job 실행 완료 (Schedul ID: {}) &lt;&lt;&lt;&lt;&lt;&lt;&quot;</span><span class=\"mtk1\">, schedulId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"61\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"62\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ul>\n<li>Job 실행 시점마다 DB에서 최신 정보를 다시 조회.</li>\n<li>연계 타입(module, file, db, api)에 따라 분기 실행.</li>\n<li>스케줄이 실행될 때 수행할 실제 비즈니스 로직을 execute() 메소드 안에 작성</li>\n</ul>\n<ol start=\"8\">\n<li>SchedulInitializer 추가</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"59099280233435600000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@Slf4j\n@Component\n@RequiredArgsConstructor\npublic class SchedulInitializer implements CommandLineRunner {\n\n    private final Scheduler scheduler;\n    private final WrkClctDao wrkClctDao;\n    private final QuartzSchedulService quartzSchedulService;\n\n    @Override\n    public void run(String... args) {\n        log.info(&quot;===== [Quartz] 스케줄러 동기화 시작 =====&quot;);\n        int registeredCount = 0; // 등록된 스케줄 개수를 셀 변수\n\n        try {\n            // 1. Quartz의 모든 기존 스케줄을 초기화\n            scheduler.clear();\n\n            // 2. DB에서 모든 스케줄의 '상세' 정보를 한번에 조회\n            List<SchedulDetailDto> allSchedulDetails = wrkClctDao.getAllSchedulDetails();\n            log.info(&quot;DB에서 총 {}개의 스케줄 상세 정보를 조회했습니다.&quot;, allSchedulDetails.size());\n\n            for (SchedulDetailDto detail : allSchedulDetails) {\n                if (&quot;once&quot;.equals(detail.getExcnCycle())) {\n                    continue;\n                }\n\n                if (Objects.equals(&quot;t&quot;, detail.getSchedulExcnYn())) {\n                    try {\n                        // 3. 올바른 메소드를 호출하고, 올바른 타입의 객체를 전달합니다.\n                        quartzSchedulService.addOrUpdateSchedul(detail);\n                        registeredCount++; // 등록 성공 시 카운트 증가\n                    } catch (Exception e) {\n                        log.error(&quot;[Quartz] 스케줄 '{}' 등록 중 에러 발생&quot;, detail.getSchedulId(), e);\n                    }\n                }\n            }\n            log.info(&quot;총 {}개의 활성 스케줄을 Quartz에 등록 완료.&quot;, registeredCount);\n\n        } catch (Exception e) {\n            log.error(&quot;[Quartz] 스케줄러 초기화 중 심각한 에러 발생&quot;, e);\n        }\n        log.info(&quot;===== [Quartz] 스케줄러 동기화 완료 =====&quot;);\n    }\n}`, `59099280233435600000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Slf4j</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Component</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">RequiredArgsConstructor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SchedulInitializer</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">CommandLineRunner</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Scheduler</span><span class=\"mtk1\"> </span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">WrkClctDao</span><span class=\"mtk1\"> </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">QuartzSchedulService</span><span class=\"mtk1\"> </span><span class=\"mtk12\">quartzSchedulService</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">run</span><span class=\"mtk1\">(</span><span class=\"mtk10\">String</span><span class=\"mtk1\">... </span><span class=\"mtk12\">args</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;===== [Quartz] 스케줄러 동기화 시작 =====&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">int</span><span class=\"mtk1\"> </span><span class=\"mtk12\">registeredCount</span><span class=\"mtk1\"> = </span><span class=\"mtk7\">0</span><span class=\"mtk1\">; </span><span class=\"mtk3\">// 등록된 스케줄 개수를 셀 변수</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// 1. Quartz의 모든 기존 스케줄을 초기화</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">scheduler</span><span class=\"mtk1\">.</span><span class=\"mtk11\">clear</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"18\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"19\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// 2. DB에서 모든 스케줄의 &#39;상세&#39; 정보를 한번에 조회</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"20\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">SchedulDetailDto</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">allSchedulDetails</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">wrkClctDao</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getAllSchedulDetails</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"21\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;DB에서 총 {}개의 스케줄 상세 정보를 조회했습니다.&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">allSchedulDetails</span><span class=\"mtk1\">.</span><span class=\"mtk11\">size</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"22\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"23\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">SchedulDetailDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">detail</span><span class=\"mtk1\"> </span><span class=\"mtk15\">:</span><span class=\"mtk1\"> allSchedulDetails) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"24\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk8\">&quot;once&quot;</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equals</span><span class=\"mtk1\">(</span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getExcnCycle</span><span class=\"mtk1\">())) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"25\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">continue</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"26\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"27\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"28\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">Objects</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equals</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;t&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulExcnYn</span><span class=\"mtk1\">())) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"29\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk15\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"30\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                        </span><span class=\"mtk3\">// 3. 올바른 메소드를 호출하고, 올바른 타입의 객체를 전달합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"31\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                        </span><span class=\"mtk12\">quartzSchedulService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addOrUpdateSchedul</span><span class=\"mtk1\">(detail);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"32\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                        registeredCount++; </span><span class=\"mtk3\">// 등록 성공 시 카운트 증가</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"33\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    } </span><span class=\"mtk15\">catch</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">Exception</span><span class=\"mtk1\"> </span><span class=\"mtk12\">e</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"34\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                        </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">error</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;[Quartz] 스케줄 &#39;{}&#39; 등록 중 에러 발생&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">detail</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSchedulId</span><span class=\"mtk1\">(), e);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"35\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"36\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"37\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"38\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;총 {}개의 활성 스케줄을 Quartz에 등록 완료.&quot;</span><span class=\"mtk1\">, registeredCount);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"39\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"40\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">catch</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">Exception</span><span class=\"mtk1\"> </span><span class=\"mtk12\">e</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"41\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">error</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;[Quartz] 스케줄러 초기화 중 심각한 에러 발생&quot;</span><span class=\"mtk1\">, e);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"42\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"43\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">log</span><span class=\"mtk1\">.</span><span class=\"mtk11\">info</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;===== [Quartz] 스케줄러 동기화 완료 =====&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"44\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"45\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ul>\n<li>애플리케이션 시작 시 DB ↔ Quartz 상태를 동기화.\n<ul>\n<li>DB에 있는 활성화된 스케줄을 Quartz에 등록.</li>\n<li>기존 Quartz Job/Trigger 모두 초기화 후 재등록.</li>\n</ul>\n</li>\n</ul>\n<ol start=\"9\">\n<li>필요 시 TriggerListener, JobListener 구현</li>\n</ol>\n<ul>\n<li>TriggerListener\n<ul>\n<li>TriggerListener를 상속받아 구현한다.</li>\n<li>메서드 이름으로 쉽게 알 수 있듯이 이벤트(ex. triggerFire, triggerMisfired) 발생시 호출되는 메서드들</li>\n<li>vetoJobExecution메서드는 해당 Trigger를 veto(거부, 금지) 시킬지 결정할 수 있는 메서드\n<ul>\n<li>true이면 veto를 시켜서 Job이 실행되지 않고 false이면 veto를 시키지 않아 Job을 실행시킬 수 있어서 특정 조건을 넣어서 실행 여부를 결정 짓을 수 있는 메서드</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>JobListener\n<ul>\n<li>JobListener를 상속받아 구현한다.</li>\n<li>jobExecutionVetoed는 TriggersListener.vetoJobExecution() 메서드에서 veto를 시킨 경우 호출한다.</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"4-디버깅-방법\" style=\"position:relative;\"><a href=\"#4-%EB%94%94%EB%B2%84%EA%B9%85-%EB%B0%A9%EB%B2%95\" aria-label=\"4 디버깅 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 디버깅 방법</h1>\n<p>방법은 크게 3가지다.</p>\n<ol>\n<li>로그 확인</li>\n</ol>\n<p>어플리케이션 시작 시나 스케줄 등록 API호출 시 콘솔에 출력되는 로그를 통해 확인이 가능하다</p>\n<ol start=\"2\">\n<li>데이터베이스 테이블 직접 조회</li>\n</ol>\n<p>Quartz는 모든 Job과 Trigger 정보를 DB에 저장하므로, DB테이블을 직접 조회하는 것이 가장 확실하다.</p>\n<p>주로 아래의 3개 테이블을 확인하면 된다.</p>\n<ul>\n<li>QRTZ_JOB_DETAILS : 어떤 Job들이 등록되어 있는지 확인한다.</li>\n<li>QRTZ_TRIGGERS : 어떤 Trigger들이 등록되었고, 어떤 Job에 연결되어 있는지 확인한다.</li>\n<li>QRTZ_CRON_TRIGGERS : Cron 스케줄의 상세정보(Cron 표현식)을 확인한다.</li>\n</ul>\n<p>확인하기 좋은 SQL문</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"95419530878656580000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`SELECT\n    A.SCHED_NAME,\n    A.JOB_NAME,\n    A.JOB_GROUP,\n    A.DESCRIPTION AS JOB_DESCRIPTION,\n    B.TRIGGER_NAME,\n    B.TRIGGER_STATE,\n    B.NEXT_FIRE_TIME,\n    B.PREV_FIRE_TIME,\n    C.CRON_EXPRESSION\nFROM\n    QRTZ_JOB_DETAILS A\nJOIN\n    QRTZ_TRIGGERS B ON A.SCHED_NAME = B.SCHED_NAME AND A.JOB_NAME = B.JOB_NAME AND A.JOB_GROUP = B.JOB_GROUP\nLEFT JOIN\n    QRTZ_CRON_TRIGGERS C ON B.SCHED_NAME = C.SCHED_NAME AND B.TRIGGER_NAME = C.TRIGGER_NAME AND B.TRIGGER_GROUP = C.TRIGGER_GROUP\nORDER BY\n    B.NEXT_FIRE_TIME ASC;`, `95419530878656580000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"sql\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">SELECT</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    A.SCHED_NAME,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    A.JOB_NAME,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    A.JOB_GROUP,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    A.DESCRIPTION </span><span class=\"mtk4\">AS</span><span class=\"mtk1\"> JOB_DESCRIPTION,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    B.TRIGGER_NAME,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    B.TRIGGER_STATE,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    B.NEXT_FIRE_TIME,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    B.PREV_FIRE_TIME,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    C.CRON_EXPRESSION</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">FROM</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    QRTZ_JOB_DETAILS A</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">JOIN</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    QRTZ_TRIGGERS B </span><span class=\"mtk4\">ON</span><span class=\"mtk1\"> A.SCHED_NAME = B.SCHED_NAME </span><span class=\"mtk4\">AND</span><span class=\"mtk1\"> A.JOB_NAME = B.JOB_NAME </span><span class=\"mtk4\">AND</span><span class=\"mtk1\"> A.JOB_GROUP = B.JOB_GROUP</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">LEFT JOIN</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    QRTZ_CRON_TRIGGERS C </span><span class=\"mtk4\">ON</span><span class=\"mtk1\"> B.SCHED_NAME = C.SCHED_NAME </span><span class=\"mtk4\">AND</span><span class=\"mtk1\"> B.TRIGGER_NAME = C.TRIGGER_NAME </span><span class=\"mtk4\">AND</span><span class=\"mtk1\"> B.TRIGGER_GROUP = C.TRIGGER_GROUP</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">ORDER BY</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    B.NEXT_FIRE_TIME </span><span class=\"mtk4\">ASC</span><span class=\"mtk1\">;</span></span></span></code></pre>\n<p>위의 쿼리를 실행하면</p>\n<ul>\n<li>TRIGGER_STATE : WAITING (실행 대기 중), ACQUIRED (실행 준비 중), PAUSED (일시 정지) 등의 상태를 확인이 가능하다. WAITING이면 정상이다</li>\n<li>NEXT_FIRE_TIME: 다음 실행 예정 시간이 타임스탬프(timestamp) 형태로 표시된다.</li>\n<li>CRON_EXPRESSION: 등록된 Cron 표현식을 직접 확인이 가능하다.</li>\n</ul>\n<ol start=\"3\">\n<li>JMX(Java Management Extensions)을 통한 실시간 모니터링</li>\n</ol>\n<p>Spring Boot 어플리케이션이 JMX 기능을 활성화하면, JConsole이나 VisualVM같은 모니터링 도구를 통해 실시간으로 Quartz 스케줄러의 상태를 볼 수 있다.</p>\n<p>해당 기술스택은 사용하지 않아서 잘 모르겠지만 찾아보니 사용하는 것 같다.</p>\n<p>추후에 운영환경에서 모니터링 도구가 필요하면 JMX 찾아보고 적용해봐야겠다.</p>\n<h1 id=\"5-quartz의-스레드\" style=\"position:relative;\"><a href=\"#5-quartz%EC%9D%98-%EC%8A%A4%EB%A0%88%EB%93%9C\" aria-label=\"5 quartz의 스레드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Quartz의 스레드</h1>\n<p>Application.yml에 <code>threadPool.threadCount: 10</code>가 있는데 의미는</p>\n<p>Quartz 스케줄러 내부에 “10개의 Worker Thread를 가진 스레드 풀을 만들라는 의미이다.</p>\n<p>실행할 작업(Job)이 생기면 즉시 달려가서 처리하는 것</p>\n<p>작업순서</p>\n<ol>\n<li>Quartz 스케줄러의 메인 스레드(QuartzSchedulerThread)는 clusterCheckinInterval은 주기적으로 데이터베이스(QRTZ_TRIGGERS 테이블)을 확인</li>\n<li>스케줄러 메인 스레드는 3개의 Job을 작업큐에 넣는다.</li>\n<li>각각의 스레드가 작업을 가져가서 execute() 메소드를 실행한다.</li>\n<li>이 작업은 서로를 기다리지 않고 동시에(Concurrently) 병렬로 실행된다.</li>\n</ol>\n<p>DB 락을 누가 먼저 차지하느냐에 따라 결정되는 무작위적인 경쟁 방식을 통해, 결과적으로 여러 노드에 작업이 분산되는 효과를 얻는 Quartz 클러스터링의 동작 방식</p>\n<h1 id=\"6-quartz에서-말하는-클러스터cluster\" style=\"position:relative;\"><a href=\"#6-quartz%EC%97%90%EC%84%9C-%EB%A7%90%ED%95%98%EB%8A%94-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0cluster\" aria-label=\"6 quartz에서 말하는 클러스터cluster permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Quartz에서 말하는 클러스터(Cluster)</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 351px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1766c0c0c766c2f8565547b07ef49cde/7ecec/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.69325153374233%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABAElEQVR42p1S2Y6EMAzj/7+Md0A8IC4Jcd/37ZErddRZDdLu+qVtiB0nRIvjGMMwIIoi+L6PoijQdR3KssS6rpC471ucjDGn73uQ63ke0jQVGkEQQGvbViTyo23bmKZJvOd5ft9VQTVOYcuykGWZeCdJAq2uazRNIyowkXeK08F1XfgJxqQ7miGHHZFXVRU01YF0QfFlWfCEbduEiCwgeYT2jcAEEs7z/CgmiXR2HMfXYtqTi33f3y7UGdI5O3jCo0OCs+Kf4/DzPBdz4+DVFn/tkGDLhmHANE04jgNd1xGG4UfRPwmSxPbGcRQ7yh3k/d+Csm3umeu64Iqpy/5N8AUfkAxhaJiOcQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1766c0c0c766c2f8565547b07ef49cde/a81b5/2.webp 163w,\n/static/1766c0c0c766c2f8565547b07ef49cde/da3ef/2.webp 325w,\n/static/1766c0c0c766c2f8565547b07ef49cde/03e3d/2.webp 351w\"\n              sizes=\"(max-width: 351px) 100vw, 351px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1766c0c0c766c2f8565547b07ef49cde/5e043/2.png 163w,\n/static/1766c0c0c766c2f8565547b07ef49cde/e5cc6/2.png 325w,\n/static/1766c0c0c766c2f8565547b07ef49cde/7ecec/2.png 351w\"\n            sizes=\"(max-width: 351px) 100vw, 351px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1766c0c0c766c2f8565547b07ef49cde/7ecec/2.png\"\n            alt=\"2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Quartz에서 말하는 클러스터란 이미지처럼 <strong>여러 개의 독립적인 애플리케이션 서버(WAS1, WAS2)가 하나의 공유 데이터베이스를 바라보며 동작하는 구조</strong></p>\n<ul>\n<li>이 두 개의 Quartz 인스턴스는 동일한 QRTZ_ 테이블들을 함께 사용합니다.</li>\n<li>이것이 가능하려면 application.yml에 org.quartz.jobStore.isClustered: true 설정이 반드시 필요합니다.</li>\n</ul>\n<h2 id=\"61-로드-밸런싱\" style=\"position:relative;\"><a href=\"#61-%EB%A1%9C%EB%93%9C-%EB%B0%B8%EB%9F%B0%EC%8B%B1\" aria-label=\"61 로드 밸런싱 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6.1 로드 밸런싱</h2>\n<p>Quartz의 로드밸런싱은 “일감을 먼저 차지하기 위한 경쟁(Race to Work)” 방식으로 이루어진다.</p>\n<p>네트워크 로드밸런서와는 다르게 Quartz는 WAS 1이 얼마나 바쁜지, WAS 2가 얼마나 한가한지 전혀 알지 못한다.</p>\n<p>오직 “누가 먼저 데이터베이스 QRTZ_LOCKS 테이블에 락을 거는 데 성공하는가?” 라는, 순전히 타이밍에 의존하는 무작위적인(random) 경쟁으로 로드밸런싱이 이루어진다.</p>\n<p>동작방식</p>\n<ol>\n<li>DB Lock : QRTZ_LOCKS라는 테이블에는 TRIGGERS_ACCESS와 같은 여러 종류의 락(Lock)레코드가 있다.</li>\n<li>락 획득 경쟁 : clusterCheckinInterval마다 Job을 처리하는지 확인하기위해 QRTZ_LOCKS테이블의 TRIGGERS_ACCESS락을 획득하려고 시도한다.</li>\n<li>락을 획득한 노드는 QRTZ_TRIGGERS 테이블을 스캔해 실행해야 할 작업을 찾는다. 그리고 그 작업의 상태를 ACQUIRED로 업데이트해 다른 노드가 가져가지 못하도록 표시한다.</li>\n<li>락 해체 : 일감 선점이 끝나면 즉시 락을 해제하여 다른 노드가 락을 획득하고 남은 일감을 찾아갈 수 있도록 한다.</li>\n<li>작업 실행 : 락 해체와는 별개로, 선점한 작업들을 자신의 스레드 풀에 할당하여 실행한다.</li>\n</ol>\n<p>Tip!!</p>\n<ul>\n<li>Quartz의 핵심 개념은 **“무엇을 할 것인가 (Job)“**와 **“언제 할 것인가 (Trigger)“**를 분리하는 것\n<ul>\n<li>Job (JobDetail): 실제 수행할 작업의 내용과 속성을 정의합니다. (예: “A라는 작업을 한다”)</li>\n<li>Trigger: Job을 실행시킬 시점이나 조건을 정의합니다. (예: “매일 5시에”, “매주 월요일에”, “지금 당장”)</li>\n</ul>\n</li>\n<li>하나의 Job에 여러 개의 Trigger를 붙일 수 있습니다. 예를 들어, 하나의 DataPlatformJob에 대해\n<ul>\n<li>매일 5시에 실행되는 Cron Trigger (정기 스케줄)</li>\n<li>사용자가 ‘즉시 실행’ 버튼을 누를 때마다 생성되는 Simple Trigger (수동 실행)</li>\n<li>이렇게 두 종류의 Trigger가 동시에 존재 가능</li>\n</ul>\n</li>\n<li>.storeDurably()가 없다면: Job은 반드시 최소 하나 이상의 Trigger와 함께 등록한다. 만약 마지막 Trigger가 삭제되면 Job도 함께 삭제됩니다.</li>\n<li>.storeDurably()가 있다면: Job은 트리거가 하나도 없어도 DB에 독립적으로 존재할 수 있다. 이것이 바로 “실행 주기가 없는(once) 작업도 수동으로 실행”하거나, “정기 스케줄과 수동 실행을 모두 지원”하는 기능의 핵심</li>\n<li>추후에 Muti WAS환경 적용에 필요하면 다음 글 참고하자 - <a href=\"https://blog.advenoh.pe.kr/multi-was-%ED%99%98%EA%B2%BD%EC%9D%84-%EC%9C%84%ED%95%9C-cluster-%ED%99%98%EA%B2%BD%EC%9D%98-quartz-job-scheduler-%EA%B5%AC%ED%98%84/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Multi WAS 환경을 위한 Cluster 환경의 Quartz Job Scheduler 구현</a></li>\n</ul>\n<h1 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h1>\n<p><a href=\"https://blog.advenoh.pe.kr/quartz-job-scheduler%EB%9E%80/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Quartz Job Scheduler란? - Frank Oh</a><br>\n<a href=\"https://adjh54.tistory.com/170\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">[Java] 스케줄링 &#x26; Spring Boot Quartz 이해하고 적용하기 -1 : 설정 및 간단예시 - Contributor9</a><br>\n<a href=\"https://blog.advenoh.pe.kr/spring-boot-quartz%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-job-scheduler-%EA%B5%AC%ED%98%84-In-memory/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Boot + Quartz을 이용한 Job Scheduler 구현 (In-memory)</a><br>\n<a href=\"https://blog.advenoh.pe.kr/multi-was-%ED%99%98%EA%B2%BD%EC%9D%84-%EC%9C%84%ED%95%9C-cluster-%ED%99%98%EA%B2%BD%EC%9D%98-quartz-job-scheduler-%EA%B5%AC%ED%98%84/#332-Quartz%EC%97%90-dataSource-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Multi WAS 환경을 위한 Cluster 환경의 Quartz Job Scheduler 구현</a></p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk3 { color: #6A9955; }\n  .default-dark .mtk7 { color: #B5CEA8; }\n  .default-dark .mtk10 { color: #4EC9B0; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .mtk15 { color: #C586C0; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#1-quartz%EB%9E%80\">1. Quartz란?</a></p>\n</li>\n<li>\n<p><a href=\"#2-quartz%EC%9D%98-%EC%A3%BC%EC%9A%94-%EC%9A%94%EC%86%8C\">2. Quartz의 주요 요소</a></p>\n</li>\n<li>\n<p><a href=\"#3-%EA%B5%AC%ED%98%84-%EC%88%9C%EC%84%9C\">3. 구현 순서</a></p>\n</li>\n<li>\n<p><a href=\"#4-%EB%94%94%EB%B2%84%EA%B9%85-%EB%B0%A9%EB%B2%95\">4. 디버깅 방법</a></p>\n</li>\n<li>\n<p><a href=\"#5-quartz%EC%9D%98-%EC%8A%A4%EB%A0%88%EB%93%9C\">5. Quartz의 스레드</a></p>\n</li>\n<li>\n<p><a href=\"#6-quartz%EC%97%90%EC%84%9C-%EB%A7%90%ED%95%98%EB%8A%94-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0cluster\">6. Quartz에서 말하는 클러스터(Cluster)</a></p>\n<ul>\n<li><a href=\"#61-%EB%A1%9C%EB%93%9C-%EB%B0%B8%EB%9F%B0%EC%8B%B1\">6.1 로드 밸런싱</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>","frontmatter":{"title":"Quartz를 활용한 동적 스케줄링 시스템 구축기","summary":["데이터 플랫폼 개발 중 마주한 동적 스케줄링 요구사항. Spring Scheduling, Cron 등 여러 대안을 비교 분석하고, 최종적으로 Quartz를 선택한 이유와 그 과정에서 얻은 핵심 개념 및 구현 노하우를 정리해 본다."],"date":"2025.06.13.","category":["JAVA"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAtUlEQVR42q2SvQrCQBCE8/4PIAg2EhCsBSsLEbUUYkAFLTSo8T/xcskFs7cjoilsvKiZbln4mNkdC0XEjKKyjCwAOo5Bp3M5wIeSVhu3sfscNP8HFCrDtdOFnM0h2BzfMp1t4keoDddwvBCbi/otcu4hJcbIj9F0jhisBGTGb/viDl/2KAgRuVPIpYfDwkOy3Ru//hno7yAqVUi7gaRuI+31fwTmXKWggxAgglYKTFRObb4p9x3WOxL+xHfnvwAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/f784bddc9194832ab3765b5252fc49b0/1c869/thumbnail.png","srcSet":"/static/f784bddc9194832ab3765b5252fc49b0/7991d/thumbnail.png 368w,\n/static/f784bddc9194832ab3765b5252fc49b0/66749/thumbnail.png 735w,\n/static/f784bddc9194832ab3765b5252fc49b0/1c869/thumbnail.png 1470w","sizes":"(min-width: 1470px) 1470px, 100vw"},"sources":[{"srcSet":"/static/f784bddc9194832ab3765b5252fc49b0/90d11/thumbnail.webp 368w,\n/static/f784bddc9194832ab3765b5252fc49b0/81303/thumbnail.webp 735w,\n/static/f784bddc9194832ab3765b5252fc49b0/9be43/thumbnail.webp 1470w","type":"image/webp","sizes":"(min-width: 1470px) 1470px, 100vw"}]},"width":1470,"height":738}},"publicURL":"/static/f784bddc9194832ab3765b5252fc49b0/thumbnail.png"}}}}]}},"pageContext":{"slug":"/quartz/","series":[],"lastmod":"2025.06.13."}},"staticQueryHashes":["2383754777"],"slicesMap":{}}