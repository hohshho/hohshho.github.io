{"componentChunkName":"component---src-templates-post-tsx","path":"/SpringSecurity1/","result":{"data":{"site":{"siteMetadata":{"title":"Just Keep Going","description":"Ian's Archive","siteUrl":"https://hohshho.github.io"}},"allMarkdownRemark":{"edges":[{"node":{"id":"50594e15-5f72-5c8d-8c85-7dbcc2351bbe","html":"<p>해당 포스팅은 정수원님의<br>\n<a href=\"https://www.inflearn.com/course/%EC%BD%94%EC%96%B4-%EC%8A%A4%ED%94%84%EB%A7%81-%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0/dashboard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">스프링 시큐리티 - Spring Boot 기반으로 개발하는 Spring Security</a> 강의를 참고하여 작성했습니다.</p>\n<p>강의 예제는 원리 이해하는 부분은 <a href=\"https://github.com/spring-projects/spring-boot/releases/tag/v3.0.1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">springboot starter 3.0.1</a>\n(security 6.0.1), 구현하는 부분은 Springboot 2.7.3을 사용해 진행</p>\n<!-- TODO: https://lelecoder.com/140 보고 필터 관련 글 써보자 -->\n<h1 id=\"용어-정리\" style=\"position:relative;\"><a href=\"#%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC\" aria-label=\"용어 정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>용어 정리</h1>\n<p>인증 : 어떤 개체(사용자 또는 장치)의 신원을 확인하는 과정<br>\n인가 : 어떤 개체가 어떤 리소스에 접근할 수 있는지 또는 어떤 동작을 수행할 수 있는지를 검증하는 것, 즉 접근 권한을 얻는 일</p>\n<h1 id=\"기본-api-및-filter\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EB%B3%B8-api-%EB%B0%8F-filter\" aria-label=\"기본 api 및 filter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기본 API 및 Filter</h1>\n<h2 id=\"자동-구성-항목\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EB%8F%99-%EA%B5%AC%EC%84%B1-%ED%95%AD%EB%AA%A9\" aria-label=\"자동 구성 항목 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자동 구성 항목</h2>\n<p>Spring Security 의존성 추가 시 자동 구성</p>\n<ul>\n<li>모든 요청은 인증이 되어야 접근</li>\n<li>인증 방식 Form 로그인 방식 / httpBasic 로그인 방식 제공</li>\n<li>기본 로그인 페이지 제공 (기본 계정 : id : user / password 랜덤 문자열)</li>\n<li>CSRF 공격 방지</li>\n<li>세션 고정 보호</li>\n<li>보안 헤더 통합</li>\n</ul>\n<p>추가로 계정 추가, 권한 추가, DB연동 등 작업 필요</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"76348064762828520000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@Configuration\n@EnableWebSecurity // WebSecurity Configuration, Web보안 활성화\npublic class SecurityConfig{\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        // 인가 정책\n        http\n                .authorizeHttpRequests((authz) -> authz // 규칙 지정\n                        .anyRequest().authenticated() // 모든 요청이 인증을 요청하게 설정\n                )\n                // 인증 정책\n                .formLogin(withDefaults());\n        return http.build();\n    }\n}`, `76348064762828520000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">EnableWebSecurity</span><span class=\"mtk1\"> </span><span class=\"mtk3\">// WebSecurity Configuration, Web보안 활성화</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityConfig</span><span class=\"mtk1\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityFilterChain</span><span class=\"mtk1\"> </span><span class=\"mtk11\">filterChain</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpSecurity</span><span class=\"mtk1\"> </span><span class=\"mtk12\">http</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Exception</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">// 인가 정책</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">authorizeHttpRequests</span><span class=\"mtk1\">((authz) </span><span class=\"mtk4\">-&gt;</span><span class=\"mtk1\"> authz </span><span class=\"mtk3\">// 규칙 지정</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        .</span><span class=\"mtk11\">anyRequest</span><span class=\"mtk1\">().</span><span class=\"mtk11\">authenticated</span><span class=\"mtk1\">() </span><span class=\"mtk3\">// 모든 요청이 인증을 요청하게 설정</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk3\">// 인증 정책</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">formLogin</span><span class=\"mtk1\">(</span><span class=\"mtk11\">withDefaults</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">http</span><span class=\"mtk1\">.</span><span class=\"mtk11\">build</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/authorization/authorize-http-requests.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http요청 승인</a></p>\n<p>설정하고 서버를 실행하면 user계정의 password가 실행 마다 변경되면서 console창에 노출이 되는데</p>\n<p>application.properties파일에 이를 명시할 수 있다.</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"87157109813414760000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`spring.security.user.name=user\nspring.security.user.password=1111`, `87157109813414760000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"yml\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">spring.security.user.name=user</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">spring.security.user.password=1111</span></span></span></code></pre>\n<h2 id=\"login-form-인증-과정\" style=\"position:relative;\"><a href=\"#login-form-%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95\" aria-label=\"login form 인증 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Login Form 인증 과정</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/340459b8a72e8ea8b21ca2da5bb4ad7d/4c40c/loginFormProccess.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.52760736196319%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAADeElEQVR42m2Ty05bVxSG8wSVSkXAPvjcL/bx/XpsH2PKJWAgggYTIpqA8QUMBJKoShVVVVoFMLcESqVIbV+gg3aUdtJJX6HDdtZZn+OrfHAaaDv4tbWlpW//a61/3xiSNQRJRTVCOKUypdFx3IkK7uQssYyDqJmIqoFiBAlG4lTcENXREHdGw8yVLT4qm5SSCj5JIyBr3HgLlDQTM2ijDQkE5mr4dk6RQjECgz5U3ULSg0xMjHHezvFmb5ofv6zww/Mpft6f5rN7Nv2Cgqj0gF2JsspQymXAnUadWsKcX8E3PINQmkayIii6iU/UGFIsQrEko5MVZCPkPSSoFn7pknMJVAwCPj/RTy+Y+/Uv5t/8zsJPf7D4y58Uv/8NMT+GKGk4qSDPFoM8XYzyfCXD5w8yPLsXZ3fewtAVD/qPw27/Vm4Yc3iS6OwSycU1zPIURnEc2QojSDofljI8Xc7yyXKBR0tZNudj7FTT1GciaJqCIF2ZYXf4smYi3OznZuU+fe0DRDuBEhC9heiWjVMawU67RLIlrESeDwSd9/2qdwrXWu5J1i2C0QSheIp4No9i2qiW7QG7SxuSdUw7ih4Mk846aGbosjtFR5D/B9hVPJ3BcUvkCkX6fUP4RLlXrCLJMslUkkw2w61b4ximQUAUkSQRUVa8B3tAFUGx2Kw6vFhNeQP/opZlr+ly0CyQioeYLCc5a+fZq2XYr2fZr2c4bOXpNB3Ot4fZWUjiE68Bg+xUk5zWIxysxenUYnRWY3RW7EugG+HlA4XjtQgvGzGv7rQe5aQR51XNYGumG27jusOHdwsct3Ls1R06raLnZK+WJBW3GS/YvLgrcNRyOF53OFnPc7JR4GTDpfOxTmNCwCebPaCkEDAi7E77eN3Q+O7JCN88cvl2N8/hwnukYyaTbpjjpQHP1atWgrP1FGetBKdrUU6W/bSn/O+AXmz0ENWxMNvVLE9qszxeneHxyhT1iokdDjFRsDm4b9Jp5uk0snSaOToth8N1l6NajMakdMVhr+0B0fQy1eeX6fN1pdAvmgxIJrPlMF9vxLnYLvLVZpaLzRznGynONx1eb6V5eFtl8N0M3/4W1fvg16UyKOrcHktzvlXkeL3ISdvltO1y1Mx694udEbbvxL26/+Tw3+qGthtkO5ogEktgR6Iomn5FBoqmIWuGl8O/ATEnGoSBJX+KAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/340459b8a72e8ea8b21ca2da5bb4ad7d/a81b5/loginFormProccess.webp 163w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/da3ef/loginFormProccess.webp 325w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/309d5/loginFormProccess.webp 650w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/78344/loginFormProccess.webp 975w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/bdb72/loginFormProccess.webp 1300w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/fb2fc/loginFormProccess.webp 1918w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/340459b8a72e8ea8b21ca2da5bb4ad7d/5e043/loginFormProccess.png 163w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/e5cc6/loginFormProccess.png 325w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/663f3/loginFormProccess.png 650w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/d880f/loginFormProccess.png 975w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/4c573/loginFormProccess.png 1300w,\n/static/340459b8a72e8ea8b21ca2da5bb4ad7d/4c40c/loginFormProccess.png 1918w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/340459b8a72e8ea8b21ca2da5bb4ad7d/663f3/loginFormProccess.png\"\n            alt=\"loginFormProccess\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ol>\n<li>\n<p><strong>UsernamePasswordAuthenticationFilter</strong> 에서 요청 ID, Password를 통해 Token을 생성한다</p>\n</li>\n<li>\n<p>생성한 token을 <strong>AuthenticationManager</strong>에서 확인한다.</p>\n</li>\n<li>\n<p>실패 시\n3.1) <a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SecurityContextHolder</a>에서 인증 정보가 지워진다.<br>\n3.2) <a href=\"https://docs.spring.io/spring-security/site/docs/6.0.1/api/org/springframework/security/web/authentication/RememberMeServices.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RememberMeServices.loginFail</a>이 호출된다.<br>\n3.3) SecurityConfig에서 설정한 <strong>AuthenticationFailureHandler</strong>가 호출 된다.</p>\n</li>\n<li>\n<p>성공 시<br>\n4.1) <strong>SessionAuthenticationStrategy</strong>에 새로운 로그인을 알린다.<br>\n4.2)<a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/architecture.html#servlet-authentication-securitycontextholder\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SecurityContextHolder</a>에 인증정보(username, password, authorities(사용자의 권한 정보)) 저장<br>\n4.3) ApplicationEventPublisher 생성<br>\n4.4) SecurityConfig에서 설정한 <strong>AuthenticationSuccessHandler</strong>가 호출 된다.</p>\n</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"39586757683467846000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`http\n        .formLogin() // form 로그인 인증 기능 적용\n//                .loginPage(&quot;/loginPage&quot;)\n        .defaultSuccessUrl(&quot;/&quot;)\n        .failureUrl(&quot;/login&quot;)\n        .usernameParameter(&quot;username&quot;)\n        .passwordParameter(&quot;password&quot;)\n        .loginProcessingUrl(&quot;/login_proc&quot;)\n        .successHandler(new AuthenticationSuccessHandler() {\n            // 요청, 응답, 인증 객체\n            @Override\n            public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException, ServletException {\n                System.out.println(authentication.getName());\n                response.sendRedirect(&quot;/&quot;);\n            }\n        })\n        .failureHandler(new AuthenticationFailureHandler() {\n            @Override\n            public void onAuthenticationFailure(HttpServletRequest request, HttpServletResponse response, AuthenticationException exception) throws IOException, ServletException {\n\n                response.sendRedirect(&quot;/login&quot;);\n            }\n        })\n        .permitAll();`, `39586757683467846000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">formLogin</span><span class=\"mtk1\">() </span><span class=\"mtk3\">// form 로그인 인증 기능 적용</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//                .loginPage(&quot;/loginPage&quot;)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">defaultSuccessUrl</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">failureUrl</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/login&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">usernameParameter</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;username&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">passwordParameter</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;password&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">loginProcessingUrl</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/login_proc&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">successHandler</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AuthenticationSuccessHandler</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk3\">// 요청, 응답, 인증 객체</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">onAuthenticationSuccess</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">, </span><span class=\"mtk10\">Authentication</span><span class=\"mtk1\"> </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\">, </span><span class=\"mtk10\">ServletException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">System</span><span class=\"mtk1\">.</span><span class=\"mtk12\">out</span><span class=\"mtk1\">.</span><span class=\"mtk11\">println</span><span class=\"mtk1\">(</span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getName</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">response</span><span class=\"mtk1\">.</span><span class=\"mtk11\">sendRedirect</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">failureHandler</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AuthenticationFailureHandler</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">onAuthenticationFailure</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">, </span><span class=\"mtk10\">AuthenticationException</span><span class=\"mtk1\"> </span><span class=\"mtk12\">exception</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\">, </span><span class=\"mtk10\">ServletException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">response</span><span class=\"mtk1\">.</span><span class=\"mtk11\">sendRedirect</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/login&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">permitAll</span><span class=\"mtk1\">();</span></span></span></code></pre>\n<h2 id=\"logout과정\" style=\"position:relative;\"><a href=\"#logout%EA%B3%BC%EC%A0%95\" aria-label=\"logout과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Logout과정</h2>\n<p>CompositeLogoutHandler의 구성을 살펴보면 logout handler로 CookieClearing, CsrfLogoutHandler, SecurityContextLogoutHandler, LogoutSuccessEventPublishingLogoutHandler이 구성되어 있다</p>\n<p>logout시 동작을 대략적으로 정리해보면</p>\n<ol>\n<li>HTTP 세션 무효화</li>\n<li>구성된 모든 RememberMe 인증 정리</li>\n<li>SecurityContextHolder.clearContext()</li>\n<li>리다이렉션</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"55320863968055820000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`http\n        .logout()\n        .logoutUrl(&quot;/logout&quot;)\n        .logoutSuccessUrl(&quot;login&quot;)\n        .addLogoutHandler(new LogoutHandler() {\n            @Override\n            public void logout(HttpServletRequest request, HttpServletResponse response, authentication authentication) {\n                HttpSession session = request.getSession();\n                session.invalidate();\n            }\n        })\n        .logoutSuccessHandler(new LogoutSuccessHandler() {\n            @Override\n            public void onLogoutSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException, ServletException {\n                    response.sendRedirect(&quot;/login&quot;);\n                }\n            })\n        .deleteCookies(&quot;remember-me&quot;)`, `55320863968055820000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">logout</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">logoutUrl</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/logout&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">logoutSuccessUrl</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;login&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">addLogoutHandler</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">LogoutHandler</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">logout</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">, </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\"> </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk10\">HttpSession</span><span class=\"mtk1\"> </span><span class=\"mtk12\">session</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">request</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getSession</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">session</span><span class=\"mtk1\">.</span><span class=\"mtk11\">invalidate</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">logoutSuccessHandler</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">LogoutSuccessHandler</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">onLogoutSuccess</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">, </span><span class=\"mtk10\">Authentication</span><span class=\"mtk1\"> </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\">, </span><span class=\"mtk10\">ServletException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk12\">response</span><span class=\"mtk1\">.</span><span class=\"mtk11\">sendRedirect</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/login&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">deleteCookies</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;remember-me&quot;</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/logout.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring security logout</a></p>\n<h2 id=\"rememberme-인증-영구-로그인-인증\" style=\"position:relative;\"><a href=\"#rememberme-%EC%9D%B8%EC%A6%9D-%EC%98%81%EA%B5%AC-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%9D%B8%EC%A6%9D\" aria-label=\"rememberme 인증 영구 로그인 인증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RememberMe 인증 (영구 로그인 인증)</h2>\n<blockquote>\n<p><strong>토근 기반 인증</strong>을 사용해 세션이 만료되고 웹 브라우저가 종료된 후에도 App이 사용자를 기억하는 기능</p>\n</blockquote>\n<p>Spring Security는 2가지 방법 제공</p>\n<ul>\n<li>\n<ol>\n<li>해싱을 사용하여 쿠키 기반 토큰의 보안 유지 기능 (보통 14일)</li>\n</ol>\n</li>\n<li>\n<ol start=\"2\">\n<li>DB / 기타 영구 저장 매커니즘을 사용해 생성된 토큰 저장</li>\n</ol>\n</li>\n</ul>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/rememberme.html#remember-me-persistent-token\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">영구 저장 토큰 방식</a></p>\n<h3 id=\"인증-과정\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95\" aria-label=\"인증 과정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증 과정</h3>\n<ol>\n<li>\n<p>세션이 만료 되었거나, Security Context에 인증 정보가 없는 경우(인증 객체가 Null인 경우) <strong>RememberMeAuthenticationFilter</strong>가 탐지</p>\n</li>\n<li>\n<p>Token 일치 여부 -> User계정 확인 -> 새로운 Authentication 생성</p>\n</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"50324874003873956000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`http\n  .rememberMe()\n  .rememberMeParameter(&quot;remember&quot;) // 파라미터 변경 / 기본 파라미터 명은 remember-me\n  .tokenValiditySeconds(3600) // remeberme 시간 설정 가능 / default(14)\n  .alwaysRemember(false); // 기능이 활성화 되지 않아도 항상 리하는 것 여부 / default false\n  userDetailsService(userDetailsService); // 사용자 계정을 조회하는 과정 (필수로 설정 해야한다)`, `50324874003873956000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  .</span><span class=\"mtk11\">rememberMe</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  .</span><span class=\"mtk11\">rememberMeParameter</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;remember&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk3\">// 파라미터 변경 / 기본 파라미터 명은 remember-me</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  .</span><span class=\"mtk11\">tokenValiditySeconds</span><span class=\"mtk1\">(</span><span class=\"mtk7\">3600</span><span class=\"mtk1\">) </span><span class=\"mtk3\">// remeberme 시간 설정 가능 / default(14)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  .</span><span class=\"mtk11\">alwaysRemember</span><span class=\"mtk1\">(</span><span class=\"mtk4\">false</span><span class=\"mtk1\">); </span><span class=\"mtk3\">// 기능이 활성화 되지 않아도 항상 리하는 것 여부 / default false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk11\">userDetailsService</span><span class=\"mtk1\">(userDetailsService); </span><span class=\"mtk3\">// 사용자 계정을 조회하는 과정 (필수로 설정 해야한다)</span></span></span></code></pre>\n<ul>\n<li>rememberMeParameter 이름을 화면상의 이름과 일치 시켜 준다.</li>\n<li>사용 시 remember-me 쿠키값이 추가된다.</li>\n</ul>\n<h3 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h3>\n<ul>\n<li>Remember Me기능 사용 시, 스프링 시큐리티는 인증 객체 관련 정보를 Remember Me 쿠키에 저장한 후 사용자에게 전달</li>\n<li>Remember Me 쿠키가 유효하면 JSESSIONID가 없어도 Remember Me 쿠키를 통해 로그인 처리</li>\n</ul>\n<h2 id=\"익명사용자-필터\" style=\"position:relative;\"><a href=\"#%EC%9D%B5%EB%AA%85%EC%82%AC%EC%9A%A9%EC%9E%90-%ED%95%84%ED%84%B0\" aria-label=\"익명사용자 필터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>익명사용자 필터</h2>\n<blockquote>\n<p>AnonymousAuthenticationFilter가 처리 하는데, 익명 사용자와 인증 사용자를 구분해서 처리하기 위한 용도</p>\n</blockquote>\n<p>Authentication을 검사하고 사용자의 Authentication정보가 아니라면 AnonymousAuthenticationToken을 생성 후 SecurityContext에 넣는다.</p>\n<ul>\n<li>화면에서 인증 여부를 구현할 때 isAnonymous()와 isAuthenticated()로 구분해서 사용</li>\n<li>인증 객체를 세션에 저장하지 않는다.</li>\n<li>사용자가 인증을 받지 않았으면 인증되지 않은 사용자의 토큰을 만들어 인증된 사용자와 구분하기 위한 용도</li>\n</ul>\n<p>잠시 정리를 해보면 Spring Security는 기본적으로<br>\n<strong>SecurityContextHolder 내부의 SecurityContext에 인증정보가 담긴 Authentication 객체 값이 존재</strong><br>\n해야 하는 구조로 <strong>익명 사용자라 할지라도 Authentication 객체가 null이 아니다</strong></p>\n<h2 id=\"동시-세션-제어\" style=\"position:relative;\"><a href=\"#%EB%8F%99%EC%8B%9C-%EC%84%B8%EC%85%98-%EC%A0%9C%EC%96%B4\" aria-label=\"동시 세션 제어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>동시 세션 제어</h2>\n<blockquote>\n<p>동일한 계정으로 접속했을 때 만들어지는 세션을 제어하는 방법</p>\n</blockquote>\n<ol>\n<li>\n<p>이전 사용자 세션 만료</p>\n<blockquote>\n<p>동일 계정으로 누군가 로그인 했을 때, 이전에 사용하던 사용자의 세션을 만료</p>\n</blockquote>\n</li>\n<li>\n<p>현재 사용자 인증 실패</p>\n<blockquote>\n<p>이미 동일 계정으로 접속하고 있는 사람이 있을 경우, 현재 인증 요청한 사용자의 인증 과정에서 인증 예외 처리</p>\n</blockquote>\n</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"92896138159917470000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// 동시 세션 제어\nhttp\n        .sessionManagement()\n        .maximumSessions(1)                 // 최대 허용 가능 세션 수 (1) , -1 -> 무제한 로그인 세션 허용\n        .maxSessionsPreventsLogin(false)    // true : 현재 사용자 인증 실패, false : 기존 사용자 인증 실패\n//      .invalidSessionUrl(&quot;/invalid&quot;)      // 세션이 유효하지 않을 경우 이동 할 페이지\n        .expiredUrl(&quot;/expired&quot;);            // 세션이 만료 된 경우 이동 할 페이지`, `92896138159917470000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// 동시 세션 제어</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">sessionManagement</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">maximumSessions</span><span class=\"mtk1\">(</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)                 </span><span class=\"mtk3\">// 최대 허용 가능 세션 수 (1) , -1 -&gt; 무제한 로그인 세션 허용</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">maxSessionsPreventsLogin</span><span class=\"mtk1\">(</span><span class=\"mtk4\">false</span><span class=\"mtk1\">)    </span><span class=\"mtk3\">// true : 현재 사용자 인증 실패, false : 기존 사용자 인증 실패</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//      .invalidSessionUrl(&quot;/invalid&quot;)      // 세션이 유효하지 않을 경우 이동 할 페이지</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">expiredUrl</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/expired&quot;</span><span class=\"mtk1\">);            </span><span class=\"mtk3\">// 세션이 만료 된 경우 이동 할 페이지</span></span></span></code></pre>\n<h2 id=\"세션-고정-보호\" style=\"position:relative;\"><a href=\"#%EC%84%B8%EC%85%98-%EA%B3%A0%EC%A0%95-%EB%B3%B4%ED%98%B8\" aria-label=\"세션 고정 보호 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>세션 고정 보호</h2>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"30045081765081182000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// 세션 고정 보호\nhttp\n        .sessionManagement()    // 세션 관리 설정 모드 사용.\n        .sessionFixation()\n            .changeSessionId(); // 기존 사용자의 세션에 Session ID만 변경\n//          .none();            //세션 고정 보호를 하지 않음.\n//          .newSession()       // 인증 성공 시 새로운 세션 사용`, `30045081765081182000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// 세션 고정 보호</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">sessionManagement</span><span class=\"mtk1\">()    </span><span class=\"mtk3\">// 세션 관리 설정 모드 사용.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">sessionFixation</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            .</span><span class=\"mtk11\">changeSessionId</span><span class=\"mtk1\">(); </span><span class=\"mtk3\">// 기존 사용자의 세션에 Session ID만 변경</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//          .none();            //세션 고정 보호를 하지 않음.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//          .newSession()       // 인증 성공 시 새로운 세션 사용</span></span></span></code></pre>\n<h2 id=\"세션-정책\" style=\"position:relative;\"><a href=\"#%EC%84%B8%EC%85%98-%EC%A0%95%EC%B1%85\" aria-label=\"세션 정책 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>세션 정책</h2>\n<blockquote>\n<p>세션 생성, 사용 여부를 설정 가능 (ALWAYS, IF_REQUIRED, NEVER, STATELESS)</p>\n</blockquote>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"41922888644504460000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// 세션 정책\nhttp\n        .sessionManagement()\n//      .sessionCreationPolicy(SessionCreationPolicy.ALWAYS);     // Spring Security가 항상 세션 설정\n        .sessionCreationPolicy(SessionCreationPolicy.IF_REQUIRED);  // 필요 시 생성(default)\n//      .sessionCreationPolicy(SessionCreationPolicy.NEVER);      // 생성x, 존재하면 사용\n//      .sessionCreationPolicy(SessionCreationPolicy.STATELESS);  // 생성x, 존재해도 사용x (JWT 사용 시)`, `41922888644504460000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// 세션 정책</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">sessionManagement</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//      .sessionCreationPolicy(SessionCreationPolicy.ALWAYS);     // Spring Security가 항상 세션 설정</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        .</span><span class=\"mtk11\">sessionCreationPolicy</span><span class=\"mtk1\">(</span><span class=\"mtk12\">SessionCreationPolicy</span><span class=\"mtk1\">.</span><span class=\"mtk12\">IF_REQUIRED</span><span class=\"mtk1\">);  </span><span class=\"mtk3\">// 필요 시 생성(default)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//      .sessionCreationPolicy(SessionCreationPolicy.NEVER);      // 생성x, 존재하면 사용</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//      .sessionCreationPolicy(SessionCreationPolicy.STATELESS);  // 생성x, 존재해도 사용x (JWT 사용 시)</span></span></span></code></pre>\n<h2 id=\"sessionmanagementfilter-concurrentsessionfilter\" style=\"position:relative;\"><a href=\"#sessionmanagementfilter-concurrentsessionfilter\" aria-label=\"sessionmanagementfilter concurrentsessionfilter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SessionManagementFilter, ConcurrentSessionFilter</h2>\n<p>SessionManagementFilter는</p>\n<ul>\n<li>동시 세션 제어</li>\n<li>세션 고정 보호</li>\n<li>세션 관리</li>\n<li>세션 생성 정책 설정</li>\n</ul>\n<p>4가지 기능을 수행하는데 동시 세션을 관리하는데 있어서 ConcurrentSessionFilter의 도움을 받는다.</p>\n<p><strong>사용자 요청이 들어올 때 마다, ConcurrentSessionFilter를 통해 매번 세션이 만료되었는지 확인</strong>\n-> 만료 되었으면 <strong>1. 로그아웃, 2. 세션 만료를 사용자에게 알림</strong></p>\n<h2 id=\"권한-설정과-표현식\" style=\"position:relative;\"><a href=\"#%EA%B6%8C%ED%95%9C-%EC%84%A4%EC%A0%95%EA%B3%BC-%ED%91%9C%ED%98%84%EC%8B%9D\" aria-label=\"권한 설정과 표현식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>권한 설정과 표현식</h2>\n<blockquote>\n<p>URL과 Method에 대해 권한 설정</p>\n</blockquote>\n<h3 id=\"선언적-방식\" style=\"position:relative;\"><a href=\"#%EC%84%A0%EC%96%B8%EC%A0%81-%EB%B0%A9%EC%8B%9D\" aria-label=\"선언적 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>선언적 방식</h3>\n<blockquote>\n<p>URL과 Method 방식 존재</p>\n</blockquote>\n<h4 id=\"1-url\" style=\"position:relative;\"><a href=\"#1-url\" aria-label=\"1 url permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. URL</h4>\n<blockquote>\n<p>HttpSecurity 객체를 사용해 설정</p>\n</blockquote>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"97356150975165900000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`http\n    .requestMatchers(&quot;/users/**&quot;).hasRole(&quot;USER&quot;);`, `97356150975165900000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    .</span><span class=\"mtk11\">requestMatchers</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/users/**&quot;</span><span class=\"mtk1\">).</span><span class=\"mtk11\">hasRole</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;USER&quot;</span><span class=\"mtk1\">);</span></span></span></code></pre>\n<details>\n<summary><b>Http 객체 설정 (Toggle)</b></summary>\n<table>\n<thead>\n<tr>\n<th>Method</th>\n<th>Describe</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>hasRole(String)</td>\n<td>사용자가 주어진 역할이 있다면 접근 허용</td>\n</tr>\n<tr>\n<td>hasAuthority(String)</td>\n<td>사용자가 주어진 권한이 있다면 접근 허용 ex) hasAuthority(‘read’)</td>\n</tr>\n<tr>\n<td>hasAnyRole(String…,)</td>\n<td>사용자가 주어진 권한이 있다면 접근 허용. (하나라도 있으면 , 로 구분)</td>\n</tr>\n<tr>\n<td>hasAnyAuthority(String…)</td>\n<td>사용자가 주어진 권한 중 어떤 것이라도 있따면 접근 허용</td>\n</tr>\n<tr>\n<td>hasIpAddress(String)</td>\n<td>주어진 IP로부터 요청이 온 경우 접근 허용</td>\n</tr>\n<tr>\n<td>permitAll()</td>\n<td>모든 요청 허용</td>\n</tr>\n<tr>\n<td>denyAll()</td>\n<td>모든 요청 접근 차단</td>\n</tr>\n<tr>\n<td>isAuthenticated()</td>\n<td>로그인 인증을 받은 사용자는 권한에 관계 없이 허용, 익명 사용자는 로그인 페이지로 이동</td>\n</tr>\n<tr>\n<td>isFullyAuthenticated()</td>\n<td>자동 로그인하지 않고 로그인 인증을 한 사용자는 권한에 관계 없이 허용</td>\n</tr>\n<tr>\n<td>isAnonymous()</td>\n<td>권한이 없는 익명의 사용자만 접근을 허용함 (로그인되어 권한이 있으면 접근 불가)</td>\n</tr>\n<tr>\n<td>isRememberMe()</td>\n<td>자동 로그인 대상 사용자의 경우 접근을 허용</td>\n</tr>\n</tbody>\n</table>\n</details>\n</br>\n<h4 id=\"method\" style=\"position:relative;\"><a href=\"#method\" aria-label=\"method permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Method</h4>\n<blockquote>\n<p>@Pre and @Post Annotations 어노테이션을 이용해 권한 설정</p>\n</blockquote>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/authorization/expression-based.html#_method_security_expressions\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@Pre and @Post Annotations doc</a></p>\n<h3 id=\"2-동적-방식-db연동\" style=\"position:relative;\"><a href=\"#2-%EB%8F%99%EC%A0%81-%EB%B0%A9%EC%8B%9D-db%EC%97%B0%EB%8F%99\" aria-label=\"2 동적 방식 db연동 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 동적 방식 (DB연동)</h3>\n<p>뒤에서 설명</p>\n<h3 id=\"주의-사항\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9D%98-%EC%82%AC%ED%95%AD\" aria-label=\"주의 사항 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주의 사항</h3>\n<ul>\n<li>경로 표현을 생략하는 경우 <strong>모든 요청은 인증을 받아야 접근 가능</strong></li>\n<li>구체적인 경로는 앞에 작성, 뒤로 갈 수록 큰 범위의 경로 설정</li>\n<li>하위 경로 표현 시 **로 표현</li>\n</ul>\n<h2 id=\"예외-처리-및-요청-캐시-필터\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC-%EB%B0%8F-%EC%9A%94%EC%B2%AD-%EC%BA%90%EC%8B%9C-%ED%95%84%ED%84%B0\" aria-label=\"예외 처리 및 요청 캐시 필터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예외 처리 및 요청 캐시 필터</h2>\n<blockquote>\n<p>에러 처리 기능은 **ExceptionTranslationFilter()**가 처리</p>\n</blockquote>\n<ul>\n<li>AuthenticationException -> 인증 예외 / AccessDeniedException -> 인가 예외</li>\n<li>RequestCache -> 사용자의 요청 정보 세션에 저장</li>\n<li>SavedRequest -> 사용자의 request 파라미터, 헤더값 등 저장</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"78759889108479500000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`SavedRequest savedRequest = requestCache.getRequest(request, response);`, `78759889108479500000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">SavedRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">savedRequest</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">requestCache</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRequest</span><span class=\"mtk1\">(request, response);</span></span></span></code></pre>\n<h3 id=\"authenticationexception\" style=\"position:relative;\"><a href=\"#authenticationexception\" aria-label=\"authenticationexception permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AuthenticationException</h3>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"46496335026411350000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        ...\n        http\n                .exceptionHandling()\n                .authenticationEntryPoint(new AuthenticationEntryPoint() {\n                    @Override\n                    public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException {\n                        response.sendRedirect(&quot;/login&quot;);\n                    }\n                })\n                .accessDeniedHandler(new AccessDeniedHandler() {\n                    @Override\n                    public void handle(HttpServletRequest request, HttpServletResponse response, AccessDeniedException accessDeniedException) throws IOException, ServletException {\n                        response.sendRedirect(&quot;denied&quot;);\n                    }\n                });\n\n    }`, `46496335026411350000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityFilterChain</span><span class=\"mtk1\"> </span><span class=\"mtk11\">filterChain</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpSecurity</span><span class=\"mtk1\"> http) throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">exceptionHandling</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">authenticationEntryPoint</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AuthenticationEntryPoint</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">commence</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">, </span><span class=\"mtk10\">AuthenticationException</span><span class=\"mtk1\"> </span><span class=\"mtk12\">authException</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\">, </span><span class=\"mtk10\">ServletException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        </span><span class=\"mtk12\">response</span><span class=\"mtk1\">.</span><span class=\"mtk11\">sendRedirect</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/login&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">accessDeniedHandler</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AccessDeniedHandler</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">handle</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">, </span><span class=\"mtk10\">AccessDeniedException</span><span class=\"mtk1\"> </span><span class=\"mtk12\">accessDeniedException</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\">, </span><span class=\"mtk10\">ServletException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        </span><span class=\"mtk12\">response</span><span class=\"mtk1\">.</span><span class=\"mtk11\">sendRedirect</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;denied&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span></code></pre>\n<h2 id=\"csrf처리\" style=\"position:relative;\"><a href=\"#csrf%EC%B2%98%EB%A6%AC\" aria-label=\"csrf처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSRF처리</h2>\n<blockquote>\n<p>Spring Security는 기본적으로 CSRF 사용 설정이 되어있으며, X-CSRF-TOKEN값을 헤더에 추가한다</p>\n</blockquote>\n<p>view template, Spring form 태그 사용 시 csrf토큰이 자동으로 설정</p>\n<p>기본적인 폼태그 사용할 땐 _csrf 값으로 추가</p>\n<h1 id=\"주요-아키텍처\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98\" aria-label=\"주요 아키텍처 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 아키텍처</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/20e367d35b8dc6d9ce15855ecfccf33a/66205/DelegatingFilterAndFilterChainProxy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.94478527607362%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB10lEQVR42mWSTY8SQRCG+SOePHn05IED8ewPkL+xR+AgMZwIZuPeCMmeACMfCcToehDxg5suw0KA1RAWZMguLLgwDMMMw8xjutchG63kTVfX211V/Xb5NpsN6/UaXddZrVZyFRAxwzAQvFgty2K320lomsZsNmOxWDCfz6UvYuKcD2A6vabZbNJud+j1ejQaZyhKQyb1TFyYTqdMJhPq9TqKotDtdmm1WnJ/eXWJ67q3CcFF1xaowwtGw770d7stjuNI1rZt0uk0oVBIolQqybjHeya6lwnXtstY29IdLekMbxhrNobtyorCVFUll8uRzWbJZDIUCoV9996ZfULH1Ply+pOD6EuiL1I8Pzzm4NkhJ18VjL/aDgYDgsEggUAAv99POByWmm4Mk9HvPm++veJt/TVXSxUfrknp43fuPwzw+MlTiXsPHnGcO9lX7XQ6RCIREokEsViMeDwuP9CxXdrjU47eRTl6H+Xi+sftk9Ubi0/dJZXmhA9nEz6fawznW6mtMCF8KpWiVqtRqVRIJpOyc1nQsbEdE9ux2NqW9ymw1lf8GvQZ9HvSv6uPGItyuUyxWCSfz1OtVmXn/5rUUM6ZnLUNpmVJCF9AcAKmaf4nvsfdhZjDPxMDhD6BiRG4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/20e367d35b8dc6d9ce15855ecfccf33a/a81b5/DelegatingFilterAndFilterChainProxy.webp 163w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/da3ef/DelegatingFilterAndFilterChainProxy.webp 325w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/309d5/DelegatingFilterAndFilterChainProxy.webp 650w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/78344/DelegatingFilterAndFilterChainProxy.webp 975w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/bdb72/DelegatingFilterAndFilterChainProxy.webp 1300w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/01f14/DelegatingFilterAndFilterChainProxy.webp 2548w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/20e367d35b8dc6d9ce15855ecfccf33a/5e043/DelegatingFilterAndFilterChainProxy.png 163w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/e5cc6/DelegatingFilterAndFilterChainProxy.png 325w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/663f3/DelegatingFilterAndFilterChainProxy.png 650w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/d880f/DelegatingFilterAndFilterChainProxy.png 975w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/4c573/DelegatingFilterAndFilterChainProxy.png 1300w,\n/static/20e367d35b8dc6d9ce15855ecfccf33a/66205/DelegatingFilterAndFilterChainProxy.png 2548w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/20e367d35b8dc6d9ce15855ecfccf33a/663f3/DelegatingFilterAndFilterChainProxy.png\"\n            alt=\"DelegatingFilterAndFilterChainProxy\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h4 id=\"servlet-container\" style=\"position:relative;\"><a href=\"#servlet-container\" aria-label=\"servlet container permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Servlet Container</h4>\n<ul>\n<li><strong>SecurityFilterAutoConfiguration</strong>에서 springSecurityFilterChain을 가져올 수 있게 DelegatingFilterProxy가 생성</li>\n</ul>\n<h4 id=\"spring-container\" style=\"position:relative;\"><a href=\"#spring-container\" aria-label=\"spring container permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spring Container</h4>\n<ul>\n<li><strong>WebSecurityConfiguration</strong> 클래스에서 WebSecurity 클래스가 <strong>springSecurityFilterChain이름으로 생성된 Bean들을 FilterChainProxy로 생성</strong>시켜 준다.</li>\n</ul>\n<p><strong>모든 요청은 DelegatingFilterProxy에서 시작</strong></p>\n<h2 id=\"delegatingfilterproxy\" style=\"position:relative;\"><a href=\"#delegatingfilterproxy\" aria-label=\"delegatingfilterproxy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DelegatingFilterProxy</h2>\n<p>Filter는 Servlet 2.3에서 부터 제공되는 기술로<br>\n<strong>서블렛을 통해 어떤 요청이 들어올 때 서블릿 자원에 들어오기 전에 처리</strong><br>\n즉, 요청에 대한 최종 접근 전, 후로 처리할 수 있게 하는 것이다.</p>\n<p>이 필터는 서블릿 스펙의 기술이며 Servlet 컨테이너에서 생성되고, 실행이 되기 때문에<br>\nSpring에서 만든 Bean을 Injection 해서 사용할 수 없다.</p>\n<p>Spring이 사용하는 기능을 사용하기 위해</p>\n<p><strong>DelegatingFilterProxy</strong>는 <strong>ApplicationContext</strong>에서<br>\n<strong>springSecurityFilterChain이름을 가진 스프링 빈(FilterChainProxy)을 찾아서 그 빈에게 요청을 위임</strong>한다</p>\n<h2 id=\"filterchainproxy\" style=\"position:relative;\"><a href=\"#filterchainproxy\" aria-label=\"filterchainproxy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FilterChainProxy</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4f6780b6c3149c5126721058e8552a30/6d612/filterChainProxy.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.09815950920245%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABc0lEQVR42oWTWW7DMAxEe65slrWREu0ATZOmAXr/a0xByXLibP0gLAnww3CG/DCeMI57XHLGRUb8yIhf2eOQBJ4zAmfEJOBhhOdU73lAHwirncG66xf1seocEvc4Dg59zAgpF5CnVM4NqOfOBWx7h5312NyBFsDMFl/iYGNGbDCe4JQqkDNYhnJ2kQv4KXDdOTAp0MNNChtMf6Y8lFKImRQ+a/VBobasQMpSQOqTeqaQ0qLp34IWQFV4nBQ27yhVZcYHrLb/gx4UnkcPG9PsWwun3Vs55tkS4+MLhWzxmR1sSHBUq4VTQ6lW2EDlJ2291YuxsTgPHp7UO7mGwjInXN5vRke/6u/G2Ocpn8QjkixSbknfpt6S1zcd7vvxmRWexCHMg30d6rmmd90YPauyty0r0IcMn6YAuG0Mz1CSunL3bS6BpgK/xSFGQZi8atvS1k49ZBmLb28HWz0ksjgkbTmVtjzlknSYWleYKlsb+1adAv8Akub2YjbBrt8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4f6780b6c3149c5126721058e8552a30/a81b5/filterChainProxy.webp 163w,\n/static/4f6780b6c3149c5126721058e8552a30/da3ef/filterChainProxy.webp 325w,\n/static/4f6780b6c3149c5126721058e8552a30/309d5/filterChainProxy.webp 650w,\n/static/4f6780b6c3149c5126721058e8552a30/a7d94/filterChainProxy.webp 936w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4f6780b6c3149c5126721058e8552a30/5e043/filterChainProxy.png 163w,\n/static/4f6780b6c3149c5126721058e8552a30/e5cc6/filterChainProxy.png 325w,\n/static/4f6780b6c3149c5126721058e8552a30/663f3/filterChainProxy.png 650w,\n/static/4f6780b6c3149c5126721058e8552a30/6d612/filterChainProxy.png 936w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4f6780b6c3149c5126721058e8552a30/663f3/filterChainProxy.png\"\n            alt=\"filterChainProxy\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ol>\n<li>springSecurityFilterChain의 이름으로 생성되는 필터 빈</li>\n<li>DelegatingFilterProxy로 부터 요청을 위임받고 실제 보안 처리</li>\n<li>SpringSecurity 초기화 시 생성되는 필터들을 관리하고 제어</li>\n<li>사용자 요청을 필터 순서대로 호출하여 전달</li>\n<li>모든 Filter를 통과 시 보안 처리 완료</li>\n</ol>\n<h2 id=\"filter-초기화-다중-보안-설정\" style=\"position:relative;\"><a href=\"#filter-%EC%B4%88%EA%B8%B0%ED%99%94-%EB%8B%A4%EC%A4%91-%EB%B3%B4%EC%95%88-%EC%84%A4%EC%A0%95\" aria-label=\"filter 초기화 다중 보안 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Filter 초기화 다중 보안 설정</h2>\n<blockquote>\n<p>여러개의 SecurityFilterChain 클래스를 만들어 url에 따라 다른 보안 정책이 적용될 수 있게 설정하면 WebSecurity에서 FilterChainProxy가 만들어 질 때 url에 따라 다른 정책이 적용될 수 있게 filter chain이 생성된다.</p>\n</blockquote>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"55848553049046550000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`    @Bean\n    @Order(1)\n    public SecurityFilterChain apiFilterChain(HttpSecurity http) throws Exception {\n        http\n                .securityMatcher(&quot;/api/**&quot;)\n                .authorizeHttpRequests(authorize -> authorize\n                        .anyRequest().hasRole(&quot;ADMIN&quot;)\n                )\n                .httpBasic(withDefaults());\n        return http.build();\n    }\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        ...\n    }`, `55848553049046550000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Order</span><span class=\"mtk1\">(</span><span class=\"mtk7\">1</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityFilterChain</span><span class=\"mtk1\"> </span><span class=\"mtk11\">apiFilterChain</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpSecurity</span><span class=\"mtk1\"> http) throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">securityMatcher</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/api/**&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">authorizeHttpRequests</span><span class=\"mtk1\">(authorize </span><span class=\"mtk4\">-&gt;</span><span class=\"mtk1\"> authorize</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                        .</span><span class=\"mtk11\">anyRequest</span><span class=\"mtk1\">().</span><span class=\"mtk11\">hasRole</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;ADMIN&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">httpBasic</span><span class=\"mtk1\">(</span><span class=\"mtk11\">withDefaults</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">http</span><span class=\"mtk1\">.</span><span class=\"mtk11\">build</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityFilterChain</span><span class=\"mtk1\"> </span><span class=\"mtk11\">filterChain</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpSecurity</span><span class=\"mtk1\"> http) throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span></code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/72a7742ec283e06fa237948fd5886ea2/23a6b/securityFilterChains.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.404907975460123%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAsUlEQVR42o2MSWrDUBAFdRorEMiwMcGKjPTHHr7khQO5/0kqSBYkyyyKeq+hX3eenY/JOE/Gy1V4nZS32XgPzvMonC6Z/uBpKPRDph/Kn/zbT5dC1zRxN2OtjVyNIEYUJ2oj6UKylew3SruRfWWM9UF6+DOU3dcke+6aBb5ccXFEjaKOeKOa72hbdrb7RiyVWIRwOFUlVdnznCvdYpHvpqzboBj5GI1VCbnu3p7GOf6LHx5kjtHc99CIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/72a7742ec283e06fa237948fd5886ea2/a81b5/securityFilterChains.webp 163w,\n/static/72a7742ec283e06fa237948fd5886ea2/da3ef/securityFilterChains.webp 325w,\n/static/72a7742ec283e06fa237948fd5886ea2/309d5/securityFilterChains.webp 650w,\n/static/72a7742ec283e06fa237948fd5886ea2/78344/securityFilterChains.webp 975w,\n/static/72a7742ec283e06fa237948fd5886ea2/bdb72/securityFilterChains.webp 1300w,\n/static/72a7742ec283e06fa237948fd5886ea2/2df7d/securityFilterChains.webp 1766w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/72a7742ec283e06fa237948fd5886ea2/5e043/securityFilterChains.png 163w,\n/static/72a7742ec283e06fa237948fd5886ea2/e5cc6/securityFilterChains.png 325w,\n/static/72a7742ec283e06fa237948fd5886ea2/663f3/securityFilterChains.png 650w,\n/static/72a7742ec283e06fa237948fd5886ea2/d880f/securityFilterChains.png 975w,\n/static/72a7742ec283e06fa237948fd5886ea2/4c573/securityFilterChains.png 1300w,\n/static/72a7742ec283e06fa237948fd5886ea2/23a6b/securityFilterChains.png 1766w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/72a7742ec283e06fa237948fd5886ea2/663f3/securityFilterChains.png\"\n            alt=\"securityFilterChains\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/configuration/java.html#_multiple_httpsecurity_instances\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">multiple-httpsecurity- instances - Spring Security Doc</a></p>\n<h2 id=\"인증authentication\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9Dauthentication\" aria-label=\"인증authentication permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증(Authentication)</h2>\n<blockquote>\n<p>어떤 개체(사용자 또는 장치)의 신원을 확인하는 과정</p>\n</blockquote>\n<p><a href=\"#login-form-%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95\">인증 흐름</a>과 같이 진행이 되고 생성되는 Authentication Token의 구조를 살펴보면</p>\n<ol>\n<li>principal : 사용자 ID 또는 User객체</li>\n<li>credentials : 사용자 비밀번호, 대부분의 경우에 인증된 후 값이 지워져서 유출되지 않는다.</li>\n<li>authorities : 인증된 사용자의 권한 목록</li>\n<li>details : 인증 부가 정보</li>\n<li>Authenticated : 인증 여부</li>\n</ol>\n<p>로 이루어져 있다.</p>\n<p>UsernamePasswordAuthenticationFilter -> Authentication 객체<br>\n-> AuthenticationManager의 구현체 ProviderManager가 인증 처리</p>\n<h3 id=\"securitycontext\" style=\"position:relative;\"><a href=\"#securitycontext\" aria-label=\"securitycontext permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SecurityContext</h3>\n<blockquote>\n<p>필요 시 언제든지 Authentication 객체를 꺼내 쓸 수 있게 저장되는 저장소</p>\n</blockquote>\n<ul>\n<li>ThreadLocal에 저장되어 아무 곳에서나 참조 가능</li>\n<li>인증 완료 시, Httpsession에 저장 (App내 전역적인 참조 가능)</li>\n</ul>\n<h3 id=\"securitycontextholder\" style=\"position:relative;\"><a href=\"#securitycontextholder\" aria-label=\"securitycontextholder permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SecurityContextHolder</h3>\n<blockquote>\n<p>SecurityContext를 감싸고 있는 wrapper 클래스</p>\n</blockquote>\n<ul>\n<li>SecurityContext객체 저장 방식\n<ul>\n<li>MODE_THREADLOCAL : 스레드 당 SecurityContext 객체 할당 (default)</li>\n<li>MODE_INHERITABLETHREADLOCAL : 메인 스레드와 자식 스레드에 관하여 동일한 SecurityContext를 유지</li>\n<li>MODE_GLOBAL : 응용 프로그램에서 단 하나의 SecurityContext저장 (static 변수로)</li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/088166de4a83f6231408e6dc2f191e99/c977d/SecurityContextHolderFlow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.104294478527606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABuklEQVR42l2SXWsaQRSG9y+nF9566w9ooVCkpgErmlap1OZCLHSJJCGtrh9JJMq2wUSNbnbX3Z39cNenzFrbkoGHYZh3zjnznqN4nsf/uK5LGETc3A04OnnNp/Mi9fP3VM+O0H5eEPhhqhNCpDx/r8gAexzHSXfP9bDXNitziWEumS0feLJX2I6V3q/X6xSp3xXh4bi7YpQgCAjDMCVJEuTZDSJEuMH3AwI/wDQtPE8gV6VSIZPJkM1myeVyLBYLiEO2kSDwBcp4PGY4HPK11eLg4AX9Xg8xaPOkqbieh67rTCYTDMPAsiyq1Sr5fJ5SqcThYYHh9YhL3aI5WKDPLZTZbMZ0OqXT6fK2UKA/GDA+bXLbbrF2HFarFfP5PP2i7/s0Gg1UVUXTNFT1G5c/ND6c/eJNc8T30T2KFCVJRLwJiOMY2zLo9Pv0r0dYpplaIDXSn81mQ7vdplwuU6vVqNfrPD4uSEJB7DsIz0GJI8Fp94GXxyPeNW55dXzDRe8OxzZS76Txe2SV0muZWLLdbtNO7xryp8tRKLiaLCl+uaL4ucvH1gT93iQMBI7zbwL2yKC2bf9N8nxsfgPi40d4lxzWNAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/088166de4a83f6231408e6dc2f191e99/a81b5/SecurityContextHolderFlow.webp 163w,\n/static/088166de4a83f6231408e6dc2f191e99/da3ef/SecurityContextHolderFlow.webp 325w,\n/static/088166de4a83f6231408e6dc2f191e99/309d5/SecurityContextHolderFlow.webp 650w,\n/static/088166de4a83f6231408e6dc2f191e99/78344/SecurityContextHolderFlow.webp 975w,\n/static/088166de4a83f6231408e6dc2f191e99/bdb72/SecurityContextHolderFlow.webp 1300w,\n/static/088166de4a83f6231408e6dc2f191e99/080e1/SecurityContextHolderFlow.webp 2574w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/088166de4a83f6231408e6dc2f191e99/5e043/SecurityContextHolderFlow.png 163w,\n/static/088166de4a83f6231408e6dc2f191e99/e5cc6/SecurityContextHolderFlow.png 325w,\n/static/088166de4a83f6231408e6dc2f191e99/663f3/SecurityContextHolderFlow.png 650w,\n/static/088166de4a83f6231408e6dc2f191e99/d880f/SecurityContextHolderFlow.png 975w,\n/static/088166de4a83f6231408e6dc2f191e99/4c573/SecurityContextHolderFlow.png 1300w,\n/static/088166de4a83f6231408e6dc2f191e99/c977d/SecurityContextHolderFlow.png 2574w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/088166de4a83f6231408e6dc2f191e99/663f3/SecurityContextHolderFlow.png\"\n            alt=\"SecurityContextHolderFlow\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ul>\n<li>ThreadLocal에 SecurityContextHolder를 담고 있다.</li>\n<li>HttpSession에 SPRING_SECURITY_CONTEXT이름으로 저장</li>\n</ul>\n<p>SecurityContextHolder에서 인증정보 가져오는 방법</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"38713355124568950000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`Authentication authentication = SecurityContextHolder.getContext().getAuthentication();`, `38713355124568950000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">Authentication</span><span class=\"mtk1\"> </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">SecurityContextHolder</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getContext</span><span class=\"mtk1\">().</span><span class=\"mtk11\">getAuthentication</span><span class=\"mtk1\">();</span></span></span></code></pre>\n<h3 id=\"securitypersistencefilter\" style=\"position:relative;\"><a href=\"#securitypersistencefilter\" aria-label=\"securitypersistencefilter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SecurityPersistenceFilter</h3>\n<blockquote>\n<p>SecurityContext 객체의 생성, 저장, 조회</p>\n</blockquote>\n<ul>\n<li>여러 필터들이 Authentication 객체를 쓸 수 있도록 하기 위해서 SecurityContextPersistenceFilter는 2번째에 위치</li>\n<li>SecurityContextPersistenceFilter에서 인증 전인지, 인증 후인지를 판단 SecurityContext에 Authentication 객체 존재 유무 결정</li>\n</ul>\n<h4 id=\"익명-사용자\" style=\"position:relative;\"><a href=\"#%EC%9D%B5%EB%AA%85-%EC%82%AC%EC%9A%A9%EC%9E%90\" aria-label=\"익명 사용자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>익명 사용자</h4>\n<ul>\n<li>새로운 SecurityContext 객체를 생성하여 SecurityContextHolder에 저장</li>\n<li>AnonymouseAuthenticationFilter에서 AnonymousAuthenticationToken 객체를 SecurityContext에 저장</li>\n</ul>\n<h4 id=\"인증-시\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D-%EC%8B%9C\" aria-label=\"인증 시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증 시</h4>\n<ul>\n<li>새로운 SecurityContext객체를 생성하여 SecurityContextHolder에 저장</li>\n<li>UsernamePasswordAuthenticationFilter에서 인증 성공 후 SecurityContext 에 UsernamePasswordAuthentication 객체를 SecurityContext에 저장</li>\n<li>인증이 최종 완료되면 Session 에 SecurityContext를 저장</li>\n</ul>\n<h4 id=\"인증-후\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D-%ED%9B%84\" aria-label=\"인증 후 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증 후</h4>\n<ul>\n<li>Session에서 SecurityContext 꺼내 SecurityContextHolder에서 저장</li>\n<li>SecurityContext안에 Authentication 객체가 존재하면 계속 인증을 유지</li>\n</ul>\n<h4 id=\"최종-응답-시-공통\" style=\"position:relative;\"><a href=\"#%EC%B5%9C%EC%A2%85-%EC%9D%91%EB%8B%B5-%EC%8B%9C-%EA%B3%B5%ED%86%B5\" aria-label=\"최종 응답 시 공통 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>최종 응답 시 공통</h4>\n<ul>\n<li>SecurityContextHolder안의 SecurityContext객체에서 보관하던 인증정보 반드시 초기화</li>\n<li>초기화 시 SecurityContextHolder.clearContext() 사용</li>\n</ul>\n<h4 id=\"securitypersistencefilter-flow\" style=\"position:relative;\"><a href=\"#securitypersistencefilter-flow\" aria-label=\"securitypersistencefilter flow permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SecurityPersistenceFilter Flow</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2b836417c87f4dff019efaf7c23d6dc0/53e2b/SecurityPersistenceFilter.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.852760736196316%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABu0lEQVR42mWQ22vUQBTG8/8/iG/ii1IQrCCLRKUgrWjcNHF3E1cfymZJ9pauyeSyucwlW1j45AxMqe3Dx5zr78w5Vjrzsf81w204QTr1sA+nYLMfYBMHbOqgmLm4nXpIf7pgfxna9oC2zsG7Ck3N0DUlyrKClBKe58F6dW7jo7fCm0/XeHf5G18mCTLHRmSfYWm/RvrNxoerCGfvx3j7+QarP1+RBy8RXDzD1nuBMrqAe+3DHY8xGo1gHQ4HZDlD07RQwxFcSCgpoASHFByDkhBSoes5BOWOdxhYgPj7c8i9i+F4B845TqcTgiCAJYQAqes6rJIE8/kccZyAsQJCSgzDAKWUrlFKapsGDqKBFL0e9gRIRX3fI0kSrbIs9YCmaVBVFWiLru/vY23XoecCUip9uydAEyRolmUaQs1kx3GM9XqtY+Qvl0vsdju0bQuzHfURMAzD/4FURL+hl4BG1EDxNE21ttutFsVo0Gaz0bbv+7BoXboTAYuiQJ7n9z8kEGMMdV1rn14jU2POQK/jOLAoSatQYxRFWCwWeiLBaQj93qxFthHlHq+sb0jOQ1GBuac5hwE8BD7OGeA/wJ/kyQrgq18AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2b836417c87f4dff019efaf7c23d6dc0/a81b5/SecurityPersistenceFilter.webp 163w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/da3ef/SecurityPersistenceFilter.webp 325w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/309d5/SecurityPersistenceFilter.webp 650w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/78344/SecurityPersistenceFilter.webp 975w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/bdb72/SecurityPersistenceFilter.webp 1300w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/8727b/SecurityPersistenceFilter.webp 2630w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2b836417c87f4dff019efaf7c23d6dc0/5e043/SecurityPersistenceFilter.png 163w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/e5cc6/SecurityPersistenceFilter.png 325w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/663f3/SecurityPersistenceFilter.png 650w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/d880f/SecurityPersistenceFilter.png 975w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/4c573/SecurityPersistenceFilter.png 1300w,\n/static/2b836417c87f4dff019efaf7c23d6dc0/53e2b/SecurityPersistenceFilter.png 2630w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2b836417c87f4dff019efaf7c23d6dc0/663f3/SecurityPersistenceFilter.png\"\n            alt=\"SecurityPersistenceFilter\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ol>\n<li>\n<p>FilterChainProxy에 2번째 위치하며 모든 요청에서 수행</p>\n</li>\n<li>\n<p>내부적으로 HttpSecurityContextRepository가 SecurityContext객체 생성, 조회하는 역할을 하는 로직 수행<br>\na. 인증 전</p>\n<ul>\n<li>새로운 컨텍스트 생성 (SecurityContext는 null)</li>\n<li>인증 필터(AuthFilter)가 인증 처리</li>\n<li>인증객체(Authentication)생성 후 SecurityContext 객체안에 저장</li>\n<li>Session에 SecurityContext저장</li>\n</ul>\n<p>b. 인증 후</p>\n<ul>\n<li>Session에서 SecurityContext가 있는지 확인</li>\n<li>SecurityContext를 꺼내 SecurityContextHolder에 저장</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"인증-흐름-authentication-flow\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D-%ED%9D%90%EB%A6%84-authentication-flow\" aria-label=\"인증 흐름 authentication flow permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증 흐름 (Authentication Flow)</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4e99efbbeb87c92808bb57ae18218616/ae5c4/AuthenticationFlow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.852760736196316%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABsUlEQVR42mVRy47TQBD0/38CSIQDC6eFCHFBSHtYdmFFEoc9ENaBJCZ+xePHjD0PO6dadVuOEnEozYxdVV3d7cXLGdKfPqIf35AsZxD+A/Lld+TzO9RRiEq2OOQlDqKEKCTapoaqMsjqAK0KNE2DsixR1zW01vBeTN7i/c0jXl3f4OrzAv8eFwg/vcavDxOI2ym+PvzFm+kS7z4ucP3lD7L1LbLFS8SzCWQwRfD0G3f395jP50jTFF5VVSCopkGjNYwx6J2F1RqdszCW4KCNg3UdnDXonEZnNZwd+NbaEzyR58jSFI1SSJIE2+0WUioYQwQH5xwTjRnE9F1rwxg4lls9GZKg73ueQxAECIInPsuyYqJSClJKNjsej8wdi3Rdx/cLw6GqQdu2JzENOo5j+L6P1WqF/X7P6dfrNXcQhiGKokCWZcjznLX/GfLs+p5BlcmchLvd7rTFzWaDKNyhKAQvgN50UoCLlsmAYlNVSkIEug8jCBBFEaeg5aVJwncCFSJcJKTWKMnYKiUZydQeFaC2qCCB/o0zGzd8vmmPhEIIJlHaceCE8yWci8YRnb9Hw2cSlOskHzep4QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4e99efbbeb87c92808bb57ae18218616/a81b5/AuthenticationFlow.webp 163w,\n/static/4e99efbbeb87c92808bb57ae18218616/da3ef/AuthenticationFlow.webp 325w,\n/static/4e99efbbeb87c92808bb57ae18218616/309d5/AuthenticationFlow.webp 650w,\n/static/4e99efbbeb87c92808bb57ae18218616/78344/AuthenticationFlow.webp 975w,\n/static/4e99efbbeb87c92808bb57ae18218616/bdb72/AuthenticationFlow.webp 1300w,\n/static/4e99efbbeb87c92808bb57ae18218616/35f29/AuthenticationFlow.webp 2622w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4e99efbbeb87c92808bb57ae18218616/5e043/AuthenticationFlow.png 163w,\n/static/4e99efbbeb87c92808bb57ae18218616/e5cc6/AuthenticationFlow.png 325w,\n/static/4e99efbbeb87c92808bb57ae18218616/663f3/AuthenticationFlow.png 650w,\n/static/4e99efbbeb87c92808bb57ae18218616/d880f/AuthenticationFlow.png 975w,\n/static/4e99efbbeb87c92808bb57ae18218616/4c573/AuthenticationFlow.png 1300w,\n/static/4e99efbbeb87c92808bb57ae18218616/ae5c4/AuthenticationFlow.png 2622w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4e99efbbeb87c92808bb57ae18218616/663f3/AuthenticationFlow.png\"\n            alt=\"AuthenticationFlow\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ol>\n<li>UsernamePasswordAuthenticationFilter는 요청을 가로채서 Authentication(인증정보) 생성</li>\n<li>AuthenticationManager는 적절한 Provider를 찾아 인증 처리 위임</li>\n<li>AuthenticationProvider는 실제 ID/PW 인증 처리를 하는데 ID의 경우 UserDetailsService를 사용해 조회 -> 조회 한 UserDetails 정보로 PW 검증</li>\n<li>AuthenticationProvider는 인증 성공 후 유저정보(UserDetails) + 권한 정보(authorities) 담아 토큰 생성</li>\n<li>UsernamePasswordAuthenticationFilter가 인증 객체를 전달 받아 SecurityContext에 인증 정보 저장</li>\n</ol>\n<h3 id=\"authenticationmanager\" style=\"position:relative;\"><a href=\"#authenticationmanager\" aria-label=\"authenticationmanager permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AuthenticationManager</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ecdd5b39cf65ef365af96f97b0b4196b/0beb1/AuthenticationManager.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.036809815950924%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABq0lEQVR42n2SaW/aQBCG/f9/RVIapXLbJFSNKjWpeuQQAQQq4CiGcAVzGHx7DwNOn8pERe2XfnhmNZrZd2f3XUNKyf/Q6y2bPGed52TbHKk0UgqkEKj1L2JngNupkOh8128UQQixZy+mFFqkzK4/YpUP6Xwo0f90hJiNkNkakSboYEjiDXl8qBNOO2gZYWil2aw3e7TKUEqSpilKpMiRhWdVmbcqyF4T5bukUpNEK54nZaLOAcufBzyPTXQ4wrCcBie3Jco3bzi9KdF+qhGFMV3bZukFfLWWvLvqcnJlU74b05/5xFFIGvsE9hlO4zXT5hGr9jE6esKYBw6206bdq/MwaTELJghRTJiQpILBLMIauLR7U+wnn6UfEccxSRygJl9Y3Z/iWmfI4TkqcjCmzpRGvcn3z5c0602cyRSt9f4t+49d7iq3XP/4xn2nRRgEO2OKCbeTc5aNVzi1Q7aj9+hwjBGGIYvFAnfpMl/MKfI/YkopqtUapvkW0zS5uLhktfJ2Bxa3KNzOMrVj53zhcrEpy7JdU7EW+d/fxvd9PM/bkyTJP/VC+EX8hd+WfU6lCzzEpwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ecdd5b39cf65ef365af96f97b0b4196b/a81b5/AuthenticationManager.webp 163w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/da3ef/AuthenticationManager.webp 325w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/309d5/AuthenticationManager.webp 650w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/78344/AuthenticationManager.webp 975w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/bdb72/AuthenticationManager.webp 1300w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/b6b27/AuthenticationManager.webp 2202w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ecdd5b39cf65ef365af96f97b0b4196b/5e043/AuthenticationManager.png 163w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/e5cc6/AuthenticationManager.png 325w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/663f3/AuthenticationManager.png 650w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/d880f/AuthenticationManager.png 975w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/4c573/AuthenticationManager.png 1300w,\n/static/ecdd5b39cf65ef365af96f97b0b4196b/0beb1/AuthenticationManager.png 2202w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ecdd5b39cf65ef365af96f97b0b4196b/663f3/AuthenticationManager.png\"\n            alt=\"AuthenticationManager\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<blockquote>\n<p>AuthenticationProvider 목록 중에서 인증 처리 요건에 맞는 AuthenticationProvider를 찾아 인증 처리 위임</p>\n</blockquote>\n<ul>\n<li>AuthenticationManager 는 인터페이스로 실제 구현체는 <strong>ProviderManager</strong></li>\n<li>ProviderManager에 인증 처리 요건에 맞는 것이 없을 경우 부모 ProviderManager에서 탐색 후 처리</li>\n</ul>\n<h3 id=\"authenticationprovider\" style=\"position:relative;\"><a href=\"#authenticationprovider\" aria-label=\"authenticationprovider permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AuthenticationProvider</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e42b0d3646ee4c1287683d3cdcb853eb/5a2eb/AuthenticationProvider.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.171779141104295%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB2UlEQVR42n2Sy25SURSGeTUTEodOOsAn8J0caIyJExsH5ggqA3qjtaYgxVBti3QfegCl575v53D7zAGsE+NKvqzB/vNn/Wvtktaa/6IU2ubYBcRS492O0NLAEjKbkec5i8WC+XxOlmWU/mVibYa1FmsNJpuhRz+Iz49QgwvOv7V533xL4+wjw58CcSNotVq02208z6MkpaQgTdMtCXf+FD+4w/d/ESQxydUXBs4Lks4RV24P53gXp/mai0EXVwzXZp1OZ2O4Wq0oKEYuahJ67J48Z/fgGW8OnnJ82SC57tJ/95Jpax9v6HFydMph45B2q71OtIk820Su1+tUq1VqtRqO4yBcgck1aRqRyohYS9R1h8mHV8ivTYw1SK1IZYo2GiUNcotShlKlUmFnZ4dK5THlcpm9vf31pDqfY+crzGyJHgvC7jH+ZYcwDImiaEuItQFZFmCzAGOjzQ7jOF4LUinR4ZSkd0rU+0zS+4QS3zH5jMTm3Nx6DAYDhLhBCA8hzhi5j3D7D3H7D5iMn1Ayxqz3oIrjaIOajpmeVBk3q0ybDullC11olMIas73+BmMUUXhL4A8JfJc4GlFSSlFw/22Mxc6X2MVy3XU+u3/7o/2LxpgZxm4xOb8BW+OUMlLiWjYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e42b0d3646ee4c1287683d3cdcb853eb/a81b5/AuthenticationProvider.webp 163w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/da3ef/AuthenticationProvider.webp 325w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/309d5/AuthenticationProvider.webp 650w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/78344/AuthenticationProvider.webp 975w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/bdb72/AuthenticationProvider.webp 1300w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/92ed1/AuthenticationProvider.webp 3132w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e42b0d3646ee4c1287683d3cdcb853eb/5e043/AuthenticationProvider.png 163w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/e5cc6/AuthenticationProvider.png 325w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/663f3/AuthenticationProvider.png 650w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/d880f/AuthenticationProvider.png 975w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/4c573/AuthenticationProvider.png 1300w,\n/static/e42b0d3646ee4c1287683d3cdcb853eb/5a2eb/AuthenticationProvider.png 3132w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e42b0d3646ee4c1287683d3cdcb853eb/663f3/AuthenticationProvider.png\"\n            alt=\"AuthenticationProvider\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ul>\n<li>\n<p>AuthenticationProvider 는 인터페이스로 2개의 메서드 존재</p>\n<ul>\n<li>authenticate(authentication) : 실제적인 인증처리를 위한 검증 메서드</li>\n<li>supports(authentication): 인증처리가 가능한 Provider인지 검사하는 메서드</li>\n</ul>\n</li>\n<li>\n<p>아이디 검증</p>\n<ul>\n<li>존재 -> UserDetails 반환 / 존재 x -> UserNotFoundException</li>\n</ul>\n</li>\n<li>\n<p>패스워드 검증</p>\n<ul>\n<li>반환된 UserDetails에 저장된 password와 로그인시 입력한 패스워드(authentication.password)가 일치하는지 비교</li>\n<li>일치하지 않을 경우 BadCredentialException 발생</li>\n<li>일반적으로 패스워드를 저장할 때 Password Encoder를 이용해 암호화 하여 저장하기 때문에 해당 클래스(PasswordEncoder)를 이용해 두 암호를 비교</li>\n</ul>\n</li>\n<li>\n<p>추가 검증</p>\n<ul>\n<li>추가적으로 사용자가 정의한 검증 조건 검증</li>\n<li>검증이 모두 성공하면 최종적으로 인증객체를 생성 후 AuthenticationManager에 전달</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"인가authorization\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EA%B0%80authorization\" aria-label=\"인가authorization permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인가(Authorization)</h2>\n<blockquote>\n<p>어떤 개체가 어떤 리소스에 접근할 수 있는지 접근 권한 할당</p>\n</blockquote>\n<h3 id=\"시큐리티가-지원하는-권한-계층\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0%EA%B0%80-%EC%A7%80%EC%9B%90%ED%95%98%EB%8A%94-%EA%B6%8C%ED%95%9C-%EA%B3%84%EC%B8%B5\" aria-label=\"시큐리티가 지원하는 권한 계층 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>시큐리티가 지원하는 권한 계층</h3>\n<ul>\n<li>웹 계층 : URL요청에 따른 메뉴 혹은 화면단위의 레벨 보안</li>\n<li>서비스 계층 : 메소드 같은 기능 단위의 레벨 보안</li>\n<li>도메인 계층 : 객체 단위의 레벨 보안</li>\n</ul>\n<h3 id=\"authorizationfilter\" style=\"position:relative;\"><a href=\"#authorizationfilter\" aria-label=\"authorizationfilter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AuthorizationFilter</h3>\n<blockquote>\n<p>마지막에 위치한 필터로 승인, 거부를 최종적으로 결정</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3ca2220120829f65ea3761ed56dde342/db1d4/FilterSecurityInterceptor.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.012269938650306%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB7ElEQVR42n2SS2/TQBSF83ubJeyoWPIvQJSqipCygBZEJZBQHwlUTd2mTVNSN0ntJI3t2MSPGXtiJ/2QJyobJBZHujNX99yrc05FpgvkfIg/bRMNTZxvNYb7NQZfdjB335K0viKFQKoCVcBiCWn+iJQpUsp/UCkbKktRKtWDmRQEM5dO+wLXdRCeQxwrZnd17o6e0zt8wYPxijicEccJYRgSxzFCCI1K+XBdF282I4oiHMfhonuL0e4wmUzwPBchc6RzTGi+xuttI+33JPEcpRYopUjTlDzPybKMShAEXF9f0+v18H1f141mk+NGg9ZZi7E9QmUZc1HgRSu8sCBIHpFpqg+xLEtjNBpRclWe2Iui0BtWqxWe/5verck8CBgPBkxsi44V8Pmkz+5xl8POlLxY8m5ri2q1yubmJhsbGxwcHJQaSpIkYTp9wB677H03qX26oL5/xc6HM44MG8u6x+zb/DztcmrccH5p4vuBnis1LFHKpTUsCYWU60YU4/oh/YHF5dUN46mPP/WYeQGe1aBvvME0thl160RhoLUrjSyJdb12eW3300eRLxjeW5yfG4gkRkYhiVwy79eY/Khy33yG3365djkR+rKS8K/LT4RCSFQqsb2EvROLjw2T5i8fofO2zmFWoLP4vxz+AS88lCa/QttFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3ca2220120829f65ea3761ed56dde342/a81b5/FilterSecurityInterceptor.webp 163w,\n/static/3ca2220120829f65ea3761ed56dde342/da3ef/FilterSecurityInterceptor.webp 325w,\n/static/3ca2220120829f65ea3761ed56dde342/309d5/FilterSecurityInterceptor.webp 650w,\n/static/3ca2220120829f65ea3761ed56dde342/78344/FilterSecurityInterceptor.webp 975w,\n/static/3ca2220120829f65ea3761ed56dde342/bdb72/FilterSecurityInterceptor.webp 1300w,\n/static/3ca2220120829f65ea3761ed56dde342/f0b73/FilterSecurityInterceptor.webp 3056w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3ca2220120829f65ea3761ed56dde342/5e043/FilterSecurityInterceptor.png 163w,\n/static/3ca2220120829f65ea3761ed56dde342/e5cc6/FilterSecurityInterceptor.png 325w,\n/static/3ca2220120829f65ea3761ed56dde342/663f3/FilterSecurityInterceptor.png 650w,\n/static/3ca2220120829f65ea3761ed56dde342/d880f/FilterSecurityInterceptor.png 975w,\n/static/3ca2220120829f65ea3761ed56dde342/4c573/FilterSecurityInterceptor.png 1300w,\n/static/3ca2220120829f65ea3761ed56dde342/db1d4/FilterSecurityInterceptor.png 3056w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3ca2220120829f65ea3761ed56dde342/663f3/FilterSecurityInterceptor.png\"\n            alt=\"FilterSecurityInterceptor\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ul>\n<li>인증객체 없이 보호자원에 접근을 시도하면 AuthenticationException 발생</li>\n<li>인증 후 자원에 접근 가능한 권한이 존재하지 않을 경우 AccessDeniedException 을 발생</li>\n<li>HTTP 자원의 보안을 처리하는 필터 (URL방식으로 접근 할 경우 동작)</li>\n<li>권한 처리를 AccessDecisionManager에게 맡김</li>\n</ul>\n<h3 id=\"accessdecisionmanager\" style=\"position:relative;\"><a href=\"#accessdecisionmanager\" aria-label=\"accessdecisionmanager permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AccessDecisionManager</h3>\n<blockquote>\n<p>인증,요청,권한 정보를 이용해서 사용자의 자원접근을 허용/거부 여부를 최종 결정하는 주체</p>\n</blockquote>\n<ul>\n<li>여러 개의 Voter들을 가질 수 있고, Voter들로부터 접근허용, 거부, 보류에 해당하는 각각의 값을 리턴받아 판단, 결정</li>\n</ul>\n<h4 id=\"접근결정의-세-가지-유형-구현체\" style=\"position:relative;\"><a href=\"#%EC%A0%91%EA%B7%BC%EA%B2%B0%EC%A0%95%EC%9D%98-%EC%84%B8-%EA%B0%80%EC%A7%80-%EC%9C%A0%ED%98%95-%EA%B5%AC%ED%98%84%EC%B2%B4\" aria-label=\"접근결정의 세 가지 유형 구현체 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>접근결정의 세 가지 유형 (구현체)</h4>\n<ol>\n<li>AffirmativeBased : OR 연산자와 같은 논리</li>\n<li>ConsensusBased : 다수결</li>\n<li>UnanimousBased : AND 연산자와 같은 논리</li>\n</ol>\n<p>권한 부여 과정에서 판단하는 값 (3가지)</p>\n<ul>\n<li>Authenticaion - 인증정보(user)</li>\n<li>FilterInvocator - 요청 정보(requestMatchers(“/user”))</li>\n<li>ConfigAttributes - 권한 정보(hasRole(“USER”))</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"27213116376119407000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`http\n    .authorizeHttpRequests((authz) -> authz // 규칙 지정\n            .requestMatchers(&quot;/user&quot;).hasRole(&quot;USER&quot;)\n            .requestMatchers(&quot;/admin/pay&quot;).hasRole(&quot;ADMIN&quot;)\n            .requestMatchers(&quot;/admin/**&quot;).hasAnyRole(&quot;ADMIN&quot;, &quot;SYS&quot;)\n            .anyRequest().authenticated() // 모든 요청이 인증을 요청하게 설정\n    );`, `27213116376119407000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    .</span><span class=\"mtk11\">authorizeHttpRequests</span><span class=\"mtk1\">((authz) </span><span class=\"mtk4\">-&gt;</span><span class=\"mtk1\"> authz </span><span class=\"mtk3\">// 규칙 지정</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            .</span><span class=\"mtk11\">requestMatchers</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/user&quot;</span><span class=\"mtk1\">).</span><span class=\"mtk11\">hasRole</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;USER&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            .</span><span class=\"mtk11\">requestMatchers</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/admin/pay&quot;</span><span class=\"mtk1\">).</span><span class=\"mtk11\">hasRole</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;ADMIN&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            .</span><span class=\"mtk11\">requestMatchers</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/admin/**&quot;</span><span class=\"mtk1\">).</span><span class=\"mtk11\">hasAnyRole</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;ADMIN&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;SYS&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            .</span><span class=\"mtk11\">anyRequest</span><span class=\"mtk1\">().</span><span class=\"mtk11\">authenticated</span><span class=\"mtk1\">() </span><span class=\"mtk3\">// 모든 요청이 인증을 요청하게 설정</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    );</span></span></span></code></pre>\n<h2 id=\"정리-1\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC-1\" aria-label=\"정리 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3d48feaa6861a31f403be6c1613cc78b/f97d7/flow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.533742331288344%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACcElEQVR42i2SW28SYRCG9396652/wcQbvVEv1KQIjbSFGmuAWGhTEG05KLBAA8uptYC22ANlWWDZ3e9jS6uP6caLN5OZvHN6ZxRzZqIbOoNBh5+9CuOZgWmaSCGRYoGUC4SUCCEQwkFIF2fxF+kuPVgLmAlwXDyeYhgT+mc9kppKopDhSFMZ/T7HkYKpaXjQdR19NMJ2XCbDJseFF0wuy8yu65xVnnCiPuOy8RJ7PkZZSpv2yOVRepeHCT87nSvM4Qjt9Dsfcs/ZqweZmhPmcwvLstH1KzqNA0bXA4zJkE47T72Rp9ctM7fmKHd3S/4C1+MSp4OPuLd/WC6XLG9vcKSNdB0cx8ayLP7c3aKbCzLaOZeG4HomyR8ZfDsaU+nNEO4SJRqN8ub1K4LvwqysrLO+tkYwGGQ1sMr7zfcE/AFCoRB+v5+NjQ18vhU2N8O89fkIh0ME/D42wyFWAwFisRhKuVwmEomwv/+VWCxCKpXk4OCAdDpNIpFga2uL7e1tj5NMJr1YPp9nb2+PbDZLJBolnoiTTKbI5fIoZ6e/qNeqdLs/aLfbnJycUK/XqdVqtFot6lqDw8NDSiWVTqfD8fGxh0wmQ7VapVgsoqoqhULBs8r3Yo3Ipy+k90vYts14PPYmuMd9g2azRbvVpFIue5e+11LTNGLRKLlslm63y3A49AqWSiUULfeGz+EHFHcfe+JfXFx466RSKUa6juVILNtBHxsYkymnZwPUSpVW54hao0mv32c2nWIYBo7joHS1OGryKS01hJSSRrNJPB5nZ2eHfr+P695g2w5CSBwhvEd3b25YuC5y4Xr+fZ78//z/AIibtbNFnkBkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/3d48feaa6861a31f403be6c1613cc78b/a81b5/flow.webp 163w,\n/static/3d48feaa6861a31f403be6c1613cc78b/da3ef/flow.webp 325w,\n/static/3d48feaa6861a31f403be6c1613cc78b/309d5/flow.webp 650w,\n/static/3d48feaa6861a31f403be6c1613cc78b/78344/flow.webp 975w,\n/static/3d48feaa6861a31f403be6c1613cc78b/bdb72/flow.webp 1300w,\n/static/3d48feaa6861a31f403be6c1613cc78b/fab06/flow.webp 2000w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/3d48feaa6861a31f403be6c1613cc78b/5e043/flow.png 163w,\n/static/3d48feaa6861a31f403be6c1613cc78b/e5cc6/flow.png 325w,\n/static/3d48feaa6861a31f403be6c1613cc78b/663f3/flow.png 650w,\n/static/3d48feaa6861a31f403be6c1613cc78b/d880f/flow.png 975w,\n/static/3d48feaa6861a31f403be6c1613cc78b/4c573/flow.png 1300w,\n/static/3d48feaa6861a31f403be6c1613cc78b/f97d7/flow.png 2000w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/3d48feaa6861a31f403be6c1613cc78b/663f3/flow.png\"\n            alt=\"flow\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"초기화\" style=\"position:relative;\"><a href=\"#%EC%B4%88%EA%B8%B0%ED%99%94\" aria-label=\"초기화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>초기화</h3>\n<ol>\n<li>\n<p>Security가 초기화 될 때 Security Config 구성대로 생성 된 Filters를 <strong>WebSecurity가 FilterChainProxy 생성</strong> (springSecurityFilterChain 이름을 가진다)</p>\n</li>\n<li>\n<p><strong>DelegatingFilterProxy</strong>가 springSecurityFilterChain이름을 가진 <strong>FilterChainProxy를 찾아 요청을 위임</strong>한다.</p>\n</li>\n</ol>\n<h3 id=\"인증\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D\" aria-label=\"인증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증</h3>\n<ol start=\"3\">\n<li>\n<p><strong>SecurityPersistenceFilter</strong>가 SecurityContext가 있는지 확인 후, 없으면 <strong>Authentication 객체 생성 후 SecurityContext에 저장</strong></p>\n</li>\n<li>\n<p>Logout 요청이 없는경우 특별한 동작 x</p>\n</li>\n<li>\n<p><strong>UsernamePasswordAuthenticationFilter</strong>에서 UserDetailsService로 <strong>ID, PW 검사 후 인증 정보를 더해 SecurityContext에 저장</strong></p>\n</li>\n<li>\n<p>인증 성공 시 뒤에있는 Session ManagementFilter 과정도 동시에 처리, <strong>동시 세션에 대한 처리</strong>한다</p>\n</li>\n<li>\n<p><strong>사용자가 정의한 SuccessHandler 작업 수행, 특정한 경로로 리다이렉트</strong></p>\n</li>\n<li>\n<p>다시 요청이 들어와서 SecurityContextPersistenceFilter가 ContextHolder에서 loadContext 후 진행</p>\n</li>\n</ol>\n<p>ConcurrentSessionFilter ~ SessionManagementFilter는 해당사항이 있을 경우만 진행</p>\n<h3 id=\"인가\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EA%B0%80\" aria-label=\"인가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인가</h3>\n<ol start=\"9\">\n<li>\n<p>ExceptionTranslationFilter로 감싸 FilterSecurityInterceptor 인가 필터가 인증 객체부터 검사</p>\n</li>\n<li>\n<p>AccessDecisionManager가 실행</p>\n</li>\n</ol>\n<h1 id=\"인증-구현\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A6%9D-%EA%B5%AC%ED%98%84\" aria-label=\"인증 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인증 구현</h1>\n<h2 id=\"정적자원-관리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EC%A0%81%EC%9E%90%EC%9B%90-%EA%B4%80%EB%A6%AC\" aria-label=\"정적자원 관리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정적자원 관리</h2>\n<blockquote>\n<p>WebIgnore 설정 시 js, css, image같은 정적 자원들을 보안 필터에서 예외시킨다.</p>\n</blockquote>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"88837668572881960000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// SecurityConfig\n\n@Override\npublic void configure(WebSecurity web) throws Exception {\n   web.ignoring().requestMatchers(PathRequest.toStaticResources().atCommonLocations());\n}`, `88837668572881960000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// SecurityConfig</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">configure</span><span class=\"mtk1\">(</span><span class=\"mtk10\">WebSecurity</span><span class=\"mtk1\"> web) throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">   </span><span class=\"mtk12\">web</span><span class=\"mtk1\">.</span><span class=\"mtk11\">ignoring</span><span class=\"mtk1\">().</span><span class=\"mtk11\">requestMatchers</span><span class=\"mtk1\">(</span><span class=\"mtk12\">PathRequest</span><span class=\"mtk1\">.</span><span class=\"mtk11\">toStaticResources</span><span class=\"mtk1\">().</span><span class=\"mtk11\">atCommonLocations</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/36b6080456ecf6b82c6a37fac3e7f01c/5266f/webIgnore.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 99.38650306748465%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAABtklEQVR42qVUa87bMAzriRbHeltOWmD3PxMHKxu+YsOApftBOLERhqRkPcQUJB0sVKAFJbASiDv2fb+Fhw6HPRV6KDQZJDs67/WTve9ord0jnGl4HowzBc/vLxyvJ0ZMZB6ISHSimwpV0XsDcy+7rAIWBtGF25ZJBGqGcQzkGdAhBaJ+224RskgpUVOICoivwvT+H4TLYmTA0+FpMFd06mCmzwiFBa4BFYPZhauN+ENCFfh0+DRYKGwKxLhsf0SobKXQzCG6siSI8mW5faSQr+xSYbUuhVQ53lVZhCaOsER4ICKgKlBniK0OoPuES4mGFNgYEgy2+xX+ylAMGUepW1gR6CLla2ioC+QfK/5gUTg3TN0xpCFiYOSJYQNhgb5fA6KwnvfV7O1r77fmf4gowgivQ3EOxlEQxEiwGNa5j7zUyw4Vh9C6ro4YA2sWvJOWwpBeJMdMHHPgmIFzOs5pyEzMHEhXZEWSGMuFK8KvQorI+7QxKDUoE8xHYQ2LjEut++pRgvEO9ShlHg7nXv2r5eKd0AxbWzktbGjbVuu2NXzbfuX0dr7et+3nN3/mWFX+ZKr8rco/AE77f3kTVZhSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/36b6080456ecf6b82c6a37fac3e7f01c/a81b5/webIgnore.webp 163w,\n/static/36b6080456ecf6b82c6a37fac3e7f01c/da3ef/webIgnore.webp 325w,\n/static/36b6080456ecf6b82c6a37fac3e7f01c/309d5/webIgnore.webp 650w,\n/static/36b6080456ecf6b82c6a37fac3e7f01c/78344/webIgnore.webp 975w,\n/static/36b6080456ecf6b82c6a37fac3e7f01c/bdb72/webIgnore.webp 1300w,\n/static/36b6080456ecf6b82c6a37fac3e7f01c/f57db/webIgnore.webp 1464w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/36b6080456ecf6b82c6a37fac3e7f01c/5e043/webIgnore.png 163w,\n/static/36b6080456ecf6b82c6a37fac3e7f01c/e5cc6/webIgnore.png 325w,\n/static/36b6080456ecf6b82c6a37fac3e7f01c/663f3/webIgnore.png 650w,\n/static/36b6080456ecf6b82c6a37fac3e7f01c/d880f/webIgnore.png 975w,\n/static/36b6080456ecf6b82c6a37fac3e7f01c/4c573/webIgnore.png 1300w,\n/static/36b6080456ecf6b82c6a37fac3e7f01c/5266f/webIgnore.png 1464w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/36b6080456ecf6b82c6a37fac3e7f01c/663f3/webIgnore.png\"\n            alt=\"webIgnore\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"passwordencoder\" style=\"position:relative;\"><a href=\"#passwordencoder\" aria-label=\"passwordencoder permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PasswordEncoder</h2>\n<blockquote>\n<p>비밀번호를 안전하게 암호화</p>\n</blockquote>\n<p>기본 타입 : bcrypt</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/98c96a36f642c5117ced164d9b6af34a/5e75c/passwordEncoder.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.54601226993866%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAACkElEQVR42pWUW3LbOBBFtSKLJF4NknhSNC3Hk9TsfzEnBUhWyjMTO/Nxqhtk8bK7cYHTkRPXtHDkQikbpVRyKqRS2XNhXVfWlMgpkWJkCYHU8hQJIZBrYd+3zrYVTiIOsROT1kzqjlZM08Q4TgzDwPl8/i1PT093bvnJeY9ZDMYbJiNM2qGMYpwGhmFkHMcu/s5jPf77XeM0z8I6KxavEGfxfkY6nkmp/tH/4eScIHpkdRNxtoSOwxjbK7wxfMg/FbRO0EZhvcXIjGkjEI+WNgb9wLYot3yaPhE01mG8Q1LCpQ0XKxIXJAk+SY8uOFwUXHRd8NMKm6CdNRIDLj4j+biJpozkil0LZq6YOfcNG79quVc4q16VSzuSd9ya0a19WVB2RrnG0i01jn8k2CpsLWV8Kbiw3mdn0EYzNrvcffnlLhsraFF9RjYUJG/YEDHzfMO3Kv2DcVJfC8rsWEJrcUXZBWVMN+7NrCOqxe7J6U986ImL53pcqHUj1wshreQgxMWQgyMGwVpz9+Mv/muDTtq6/vey7ZR9o9SNFFdSLp22DiGilPqI1j0Ow/mD2ftJcdZyOV6orxeWWVNTpF4O9pcrpV46l/3g+bhyXL9xvL7x/PJKyhURwVjT6WfZe2GZPde3H+x/vRCicGyFb9//5vXtB9e37+RWZUzElHvVMRVCzISUWZa1j8M5i9aakzEOpTR520jPuR8xb1W/99YQWdaAuFaFxVpHP/viH9E6h7UWY28j6D7sgnVjOyqxRkqKfd1abTHmSsyFXLbeZnvWKm1VO+/Qj/vzbuz2oMSFVCJrDF2wbjv1svfYPmyz0trcMOaRvwuN74LW+Z50K5ybFW7X1PuNPJzP3R7Db/inbX4CTVSQv9J+jP0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/98c96a36f642c5117ced164d9b6af34a/a81b5/passwordEncoder.webp 163w,\n/static/98c96a36f642c5117ced164d9b6af34a/da3ef/passwordEncoder.webp 325w,\n/static/98c96a36f642c5117ced164d9b6af34a/309d5/passwordEncoder.webp 650w,\n/static/98c96a36f642c5117ced164d9b6af34a/78344/passwordEncoder.webp 975w,\n/static/98c96a36f642c5117ced164d9b6af34a/bdb72/passwordEncoder.webp 1300w,\n/static/98c96a36f642c5117ced164d9b6af34a/2b697/passwordEncoder.webp 2154w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/98c96a36f642c5117ced164d9b6af34a/5e043/passwordEncoder.png 163w,\n/static/98c96a36f642c5117ced164d9b6af34a/e5cc6/passwordEncoder.png 325w,\n/static/98c96a36f642c5117ced164d9b6af34a/663f3/passwordEncoder.png 650w,\n/static/98c96a36f642c5117ced164d9b6af34a/d880f/passwordEncoder.png 975w,\n/static/98c96a36f642c5117ced164d9b6af34a/4c573/passwordEncoder.png 1300w,\n/static/98c96a36f642c5117ced164d9b6af34a/5e75c/passwordEncoder.png 2154w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/98c96a36f642c5117ced164d9b6af34a/663f3/passwordEncoder.png\"\n            alt=\"passwordEncoder\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"userdetails\" style=\"position:relative;\"><a href=\"#userdetails\" aria-label=\"userdetails permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UserDetails</h2>\n<blockquote>\n<p>Spring Security에서 사용자의 정보를 담는 인터페이스</p>\n</blockquote>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"17519814247383580000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`\n// Account, AccountDto 생성\n@Getter\n@Entity\n@NoArgsConstructor(access = AccessLevel.PROTECTED)\npublic class Account implements UserDetails, Serializable {\n    ...\n}\n\n// UserService상속받아 구현체 생성\n@Slf4j\n@Service(&quot;userService&quot;)\npublic class UserServiceImpl implements UserService {\n\n    @Autowired\n    private UserRepository userRepository;\n\n    @Autowired\n    private RoleRepository roleRepository;\n\n    @Autowired\n    private PasswordEncoder passwordEncoder;\n\n    @Transactional\n    @Override\n    public void createUser(Account account) {\n\n        Role role = roleRepository.findByRoleName(&quot;ROLE_USER&quot;);\n        Set<Role> roles = new HashSet<>();\n        roles.add(role);\n        account.setUserRoles(roles);\n        userRepository.save(account);\n    }\n    ...\n}`, `17519814247383580000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Account, AccountDto 생성</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Getter</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Entity</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">NoArgsConstructor</span><span class=\"mtk1\">(access = </span><span class=\"mtk12\">AccessLevel</span><span class=\"mtk1\">.</span><span class=\"mtk12\">PROTECTED</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Account</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UserDetails</span><span class=\"mtk1\">, </span><span class=\"mtk10\">Serializable</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// UserService상속받아 구현체 생성</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Slf4j</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Service</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;userService&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UserServiceImpl</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UserService</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Autowired</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UserRepository</span><span class=\"mtk1\"> </span><span class=\"mtk12\">userRepository</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Autowired</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RoleRepository</span><span class=\"mtk1\"> </span><span class=\"mtk12\">roleRepository</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Autowired</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">PasswordEncoder</span><span class=\"mtk1\"> </span><span class=\"mtk12\">passwordEncoder</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Transactional</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">createUser</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Account</span><span class=\"mtk1\"> </span><span class=\"mtk12\">account</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">Role</span><span class=\"mtk1\"> </span><span class=\"mtk12\">role</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">roleRepository</span><span class=\"mtk1\">.</span><span class=\"mtk11\">findByRoleName</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;ROLE_USER&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">Set</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Role</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">roles</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">HashSet</span><span class=\"mtk1\">&lt;&gt;();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">roles</span><span class=\"mtk1\">.</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(role);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">account</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setUserRoles</span><span class=\"mtk1\">(roles);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">userRepository</span><span class=\"mtk1\">.</span><span class=\"mtk11\">save</span><span class=\"mtk1\">(account);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p><a href=\"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/core/userdetails/UserDetails.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">UserDetails</a>, Serializable을 상속해 확장 가능</p>\n<table>\n<thead>\n<tr>\n<th>메소드</th>\n<th>리턴 타입</th>\n<th>설명</th>\n<th>기본값</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>getAuthorities()</td>\n<td>Collection&#x3C;? extends GrantedAuthority></td>\n<td>계정의 권한 목록을 리턴</td>\n<td></td>\n</tr>\n<tr>\n<td>getPassword()</td>\n<td>String</td>\n<td>계정의 비밀번호를 리턴</td>\n<td></td>\n</tr>\n<tr>\n<td>getUsername()</td>\n<td>String</td>\n<td>계정의 고유한 값을 리턴( ex : DB PK값, 중복이 없는 이메일 값 )</td>\n<td></td>\n</tr>\n<tr>\n<td>isAccountNonExpired()</td>\n<td>boolean</td>\n<td>계정의 만료 여부 리턴</td>\n<td>true ( 만료 안됨 )</td>\n</tr>\n<tr>\n<td>isAccountNonLocked()</td>\n<td>boolean</td>\n<td>계정의 잠김 여부 리턴</td>\n<td>true ( 잠기지 않음 )</td>\n</tr>\n<tr>\n<td>isCredentialsNonExpired()</td>\n<td>boolean</td>\n<td>비밀번호 만료 여부 리턴</td>\n<td>true ( 만료 안됨 )</td>\n</tr>\n<tr>\n<td>isEnabled()</td>\n<td>boolean</td>\n<td>계정의 활성화 여부 리턴</td>\n<td>true ( 활성화 됨 )</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li><a href=\"https://programmer93.tistory.com/68\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">getUsername() 사용 시 SSO 같은 서버를 만들게 되면 정책에 따라서 중복이 될 수도 있기에 주의</a></li>\n<li>사용한 Account 엔티티는 반드시 <a href=\"https://devlog-wjdrbs96.tistory.com/268\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">직렬화(Serializable)</a></li>\n</ul>\n<h2 id=\"customuserdetailsservicedb-연동-구현\" style=\"position:relative;\"><a href=\"#customuserdetailsservicedb-%EC%97%B0%EB%8F%99-%EA%B5%AC%ED%98%84\" aria-label=\"customuserdetailsservicedb 연동 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CustomUserDetailsService(DB 연동 구현)</h2>\n<blockquote>\n<p>사용자 이름, 암호 및 사용자 이름과 암호로 인증하기 위한 기타 속성을 검색하는 데 사용</p>\n</blockquote>\n<ul>\n<li>UserDetailsService을 상속받아 loadUserByUsername을 구현</li>\n<li>\n<ol>\n<li>ID 존재 여부 확인, 2) User 권한 확인 후 security.core.userdetails.User를 상속받은 AccountContext({유저 정보}, 권한)으로 리턴</li>\n</ol>\n</li>\n<li>권한 정보는 <strong>GrantedAutority타입</strong>으로 담아야 함</li>\n<li>AccountContext를 확장해서 사용 시 정의한 클래스로 객체 생성해 반환</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"15160786056876384000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// AccountContext\n// UserDetails 타입으로 계정에 관한 정보를 넣어주어야 스프링 시큐리티가 요구하는 스펙(인증 메서드를 사용하기 위한 인자 조건)을 맞출 수 있다\n@Data\npublic class AccountContext extends User {\n    private Account account;\n\n    public AccountContext(Account account, List<GrantedAuthority> roles) {\n        super(account.getUsername(), account.getPassword(), roles);\n        this.account = account;\n    }\n}\n\n// UserDetailsServiceImpl\n@Slf4j\n@Service(&quot;userDetailsService&quot;)\npublic class UserDetailsServiceImpl implements UserDetailsService {\n\n    @Autowired\n    private UserRepository userRepository;\n\n    @Autowired\n    private HttpServletRequest request;\n\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n\n        Account account = userRepository.findByUsername(username);\n        if (account == null) {\n            if (userRepository.countByUsername(username) == 0) {\n                throw new UsernameNotFoundException(&quot;No user found with username: &quot; + username);\n            }\n        }\n        Set<String> userRoles = account.getUserRoles()\n                .stream()\n                .map(userRole -> userRole.getRoleName())\n                .collect(Collectors.toSet());\n\n        List<GrantedAuthority> collect = userRoles.stream().map(SimpleGrantedAuthority::new).collect(Collectors.toList());\n        return new AccountContext(account, collect);\n    }\n}`, `15160786056876384000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// AccountContext</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// UserDetails 타입으로 계정에 관한 정보를 넣어주어야 스프링 시큐리티가 요구하는 스펙(인증 메서드를 사용하기 위한 인자 조건)을 맞출 수 있다</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AccountContext</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">User</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Account</span><span class=\"mtk1\"> </span><span class=\"mtk12\">account</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AccountContext</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Account</span><span class=\"mtk1\"> </span><span class=\"mtk12\">account</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">GrantedAuthority</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">roles</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">super</span><span class=\"mtk1\">(</span><span class=\"mtk12\">account</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getUsername</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">account</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getPassword</span><span class=\"mtk1\">(), roles);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">account</span><span class=\"mtk1\"> = account;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// UserDetailsServiceImpl</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Slf4j</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Service</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;userDetailsService&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UserDetailsServiceImpl</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UserDetailsService</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Autowired</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UserRepository</span><span class=\"mtk1\"> </span><span class=\"mtk12\">userRepository</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Autowired</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UserDetails</span><span class=\"mtk1\"> </span><span class=\"mtk11\">loadUserByUsername</span><span class=\"mtk1\">(</span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">username</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UsernameNotFoundException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">Account</span><span class=\"mtk1\"> </span><span class=\"mtk12\">account</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">userRepository</span><span class=\"mtk1\">.</span><span class=\"mtk11\">findByUsername</span><span class=\"mtk1\">(username);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (account == </span><span class=\"mtk4\">null</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">userRepository</span><span class=\"mtk1\">.</span><span class=\"mtk11\">countByUsername</span><span class=\"mtk1\">(username) == </span><span class=\"mtk7\">0</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">throw</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">UsernameNotFoundException</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;No user found with username: &quot;</span><span class=\"mtk1\"> + username);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">Set</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">String</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">userRoles</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">account</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getUserRoles</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">stream</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">map</span><span class=\"mtk1\">(userRole </span><span class=\"mtk4\">-&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">userRole</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRoleName</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                .</span><span class=\"mtk11\">collect</span><span class=\"mtk1\">(</span><span class=\"mtk12\">Collectors</span><span class=\"mtk1\">.</span><span class=\"mtk11\">toSet</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">GrantedAuthority</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">collect</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">userRoles</span><span class=\"mtk1\">.</span><span class=\"mtk11\">stream</span><span class=\"mtk1\">().</span><span class=\"mtk11\">map</span><span class=\"mtk1\">(SimpleGrantedAuthority</span><span class=\"mtk15\">::new</span><span class=\"mtk1\">).</span><span class=\"mtk11\">collect</span><span class=\"mtk1\">(</span><span class=\"mtk12\">Collectors</span><span class=\"mtk1\">.</span><span class=\"mtk11\">toList</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AccountContext</span><span class=\"mtk1\">(account, collect);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h2 id=\"form인증-구현\" style=\"position:relative;\"><a href=\"#form%EC%9D%B8%EC%A6%9D-%EA%B5%AC%ED%98%84\" aria-label=\"form인증 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Form인증 구현</h2>\n<h3 id=\"customauthenticationprovider\" style=\"position:relative;\"><a href=\"#customauthenticationprovider\" aria-label=\"customauthenticationprovider permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CustomAuthenticationProvider</h3>\n<blockquote>\n<p>CustomUserDetailsService에서 만든 AccountContext를 검증</p>\n</blockquote>\n<p>구현</p>\n<ol>\n<li><strong>AuthenticationProvider</strong> 클래스를 상속받아 인증 절차를 수행하는 authenticate, supports 함수 구현</li>\n<li>Security Config 파일에서 authenticationProvider bean 등록</li>\n<li>Security Config 파일에서 2에서 생성한 <strong>빈 객체</strong>를 <strong>configure</strong> 설정으로 전달</li>\n</ol>\n<p>특징</p>\n<ul>\n<li>supports 함수는 Authentication 객체를 이 AuthenticationProvider가 인증 가능한 클래스인지 확인</li>\n<li>supports를 통과한 뒤 authenticate 메서드가 호출</li>\n<li>만약 JWT token을 사용하고, DB에 저장하고 있다면 이런 정보를 추가로 Token에 담아 전달 가능</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"24468340944005472000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// FormAuthenticationProvider\n@Slf4j\npublic class FormAuthenticationProvider implements AuthenticationProvider {\n\n    @Autowired\n    private UserDetailsService userDetailsService;\n\n    private PasswordEncoder passwordEncoder;\n\n    public FormAuthenticationProvider(PasswordEncoder passwordEncoder) {\n        this.passwordEncoder = passwordEncoder;\n    }\n\n    @Override\n    @Transactional\n    public Authentication authenticate(Authentication authentication) throws AuthenticationException {\n\n        String loginId = authentication.getName();\n        String password = (String) authentication.getCredentials();\n\n        AccountContext accountContext = (AccountContext) userDetailsService.loadUserByUsername(loginId);\n\n        if (!passwordEncoder.matches(password, accountContext.getPassword())) {\n            throw new BadCredentialsException(&quot;Invalid password&quot;);\n        }\n\n        String secretKey = ((FormWebAuthenticationDetails) authentication.getDetails()).getSecretKey();\n        if (secretKey == null || !secretKey.equals(&quot;secret&quot;)) {\n            throw new IllegalArgumentException(&quot;Invalid Secret&quot;);\n        }\n\n        return new UsernamePasswordAuthenticationToken(accountContext.getAccount(), null, accountContext.getAuthorities());\n    }\n\n    @Override\n    public boolean supports(Class<?> authentication) {\n        return authentication.equals(UsernamePasswordAuthenticationToken.class);\n    }\n\n}\n\n// SecurityConfig.java\n@Override\nprotected void configure(AuthenticationManagerBuilder auth) throws Exception {\n    auth.authenticationProvider(authenticationProvider());\n}\n\n@Bean\npublic AuthenticationProvider authenticationProvider() {\n    return new FormAuthenticationProvider(passwordEncoder());\n}\n\n@Override\npublic AuthenticationManager authenticationManagerBean() throws Exception {\n    return super.authenticationManagerBean();\n}\n`, `24468340944005472000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// FormAuthenticationProvider</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Slf4j</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FormAuthenticationProvider</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AuthenticationProvider</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Autowired</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UserDetailsService</span><span class=\"mtk1\"> </span><span class=\"mtk12\">userDetailsService</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">PasswordEncoder</span><span class=\"mtk1\"> </span><span class=\"mtk12\">passwordEncoder</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">FormAuthenticationProvider</span><span class=\"mtk1\">(</span><span class=\"mtk10\">PasswordEncoder</span><span class=\"mtk1\"> </span><span class=\"mtk12\">passwordEncoder</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">passwordEncoder</span><span class=\"mtk1\"> = passwordEncoder;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Transactional</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Authentication</span><span class=\"mtk1\"> </span><span class=\"mtk11\">authenticate</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Authentication</span><span class=\"mtk1\"> </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AuthenticationException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">loginId</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getName</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">password</span><span class=\"mtk1\"> = (String) </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getCredentials</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">AccountContext</span><span class=\"mtk1\"> </span><span class=\"mtk12\">accountContext</span><span class=\"mtk1\"> = (AccountContext) </span><span class=\"mtk12\">userDetailsService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">loadUserByUsername</span><span class=\"mtk1\">(loginId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (!</span><span class=\"mtk12\">passwordEncoder</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(password, </span><span class=\"mtk12\">accountContext</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getPassword</span><span class=\"mtk1\">())) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">throw</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">BadCredentialsException</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Invalid password&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">secretKey</span><span class=\"mtk1\"> = ((FormWebAuthenticationDetails) </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getDetails</span><span class=\"mtk1\">()).</span><span class=\"mtk11\">getSecretKey</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (secretKey == </span><span class=\"mtk4\">null</span><span class=\"mtk1\"> || !</span><span class=\"mtk12\">secretKey</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equals</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;secret&quot;</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">throw</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">IllegalArgumentException</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Invalid Secret&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">UsernamePasswordAuthenticationToken</span><span class=\"mtk1\">(</span><span class=\"mtk12\">accountContext</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getAccount</span><span class=\"mtk1\">(), </span><span class=\"mtk4\">null</span><span class=\"mtk1\">, </span><span class=\"mtk12\">accountContext</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getAuthorities</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">boolean</span><span class=\"mtk1\"> </span><span class=\"mtk11\">supports</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Class</span><span class=\"mtk1\">&lt;</span><span class=\"mtk4\">?</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equals</span><span class=\"mtk1\">(</span><span class=\"mtk12\">UsernamePasswordAuthenticationToken</span><span class=\"mtk1\">.</span><span class=\"mtk12\">class</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// SecurityConfig.java</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">protected</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">configure</span><span class=\"mtk1\">(</span><span class=\"mtk10\">AuthenticationManagerBuilder</span><span class=\"mtk1\"> auth) throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">auth</span><span class=\"mtk1\">.</span><span class=\"mtk11\">authenticationProvider</span><span class=\"mtk1\">(</span><span class=\"mtk11\">authenticationProvider</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AuthenticationProvider</span><span class=\"mtk1\"> </span><span class=\"mtk11\">authenticationProvider</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">FormAuthenticationProvider</span><span class=\"mtk1\">(</span><span class=\"mtk11\">passwordEncoder</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AuthenticationManager</span><span class=\"mtk1\"> </span><span class=\"mtk11\">authenticationManagerBean</span><span class=\"mtk1\">() throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">super</span><span class=\"mtk1\">.</span><span class=\"mtk11\">authenticationManagerBean</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<p>추가로 AuthenticationManager를 외부에서 사용하기 위한 설정은 AuthenticationManagerBean 을 이용하여 Sprint Securtiy 밖으로 AuthenticationManager 빼 내야 한다.</p>\n<h4 id=\"userdetails-정보-확장\" style=\"position:relative;\"><a href=\"#userdetails-%EC%A0%95%EB%B3%B4-%ED%99%95%EC%9E%A5\" aria-label=\"userdetails 정보 확장 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UserDetails 정보 확장</h4>\n<p>예제에선 secret_key를 추가로 받아 인증과정에 추가</p>\n<ul>\n<li>Details를 담는 AuthenticationDetailsSource 작성</li>\n<li>WebAuthenticationDetails</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"14228620939051928000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@Component\npublic class FormAuthenticationDetailsSource implements AuthenticationDetailsSource<HttpServletRequest, WebAuthenticationDetails> {\n    @Override\n    public WebAuthenticationDetails buildDetails(HttpServletRequest context) {\n        return new FormWebAuthenticationDetails(context);\n    }\n}\n\n//사용자가 전달하는 추가적인 파라미터들을 저장\npublic class FormWebAuthenticationDetails extends WebAuthenticationDetails {\n\n    private String secretKey;\n\n    public FormWebAuthenticationDetails(HttpServletRequest request) {\n        super(request);\n        secretKey = request.getParameter(&quot;secret_key&quot;);\n    }\n\n    public String getSecretKey() {\n        return secretKey;\n    }\n}\n\n// config 추가\nhttp.authenticationDetailsSource(authenticationDetailsSource)`, `14228620939051928000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Component</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FormAuthenticationDetailsSource</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AuthenticationDetailsSource</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\">, </span><span class=\"mtk10\">WebAuthenticationDetails</span><span class=\"mtk1\">&gt; {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">WebAuthenticationDetails</span><span class=\"mtk1\"> </span><span class=\"mtk11\">buildDetails</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">context</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">FormWebAuthenticationDetails</span><span class=\"mtk1\">(context);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//사용자가 전달하는 추가적인 파라미터들을 저장</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FormWebAuthenticationDetails</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">WebAuthenticationDetails</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">secretKey</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">FormWebAuthenticationDetails</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">super</span><span class=\"mtk1\">(request);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        secretKey = </span><span class=\"mtk12\">request</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getParameter</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;secret_key&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getSecretKey</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> secretKey;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// config 추가</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">http</span><span class=\"mtk1\">.</span><span class=\"mtk11\">authenticationDetailsSource</span><span class=\"mtk1\">(authenticationDetailsSource)</span></span></span></code></pre>\n<h3 id=\"login-logout-처리-및-핸들러-구현\" style=\"position:relative;\"><a href=\"#login-logout-%EC%B2%98%EB%A6%AC-%EB%B0%8F-%ED%95%B8%EB%93%A4%EB%9F%AC-%EA%B5%AC%ED%98%84\" aria-label=\"login logout 처리 및 핸들러 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Login, Logout 처리 및 핸들러 구현</h3>\n<ol>\n<li>login 설정</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"57458276015059370000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`http\n    .formLogin()\n    .loginPage(&quot;/login&quot;) // 사용자 정의 로그인 페이지, default: /login\n    .loginProcessingUrl(&quot;/login&quot;) // 로그인 Form Action Url, default: /login\n    .defaultSeccessUrl(&quot;/&quot;)\n    .permitAll()`, `57458276015059370000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    .</span><span class=\"mtk11\">formLogin</span><span class=\"mtk1\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    .</span><span class=\"mtk11\">loginPage</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/login&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk3\">// 사용자 정의 로그인 페이지, default: /login</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    .</span><span class=\"mtk11\">loginProcessingUrl</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/login&quot;</span><span class=\"mtk1\">) </span><span class=\"mtk3\">// 로그인 Form Action Url, default: /login</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    .</span><span class=\"mtk11\">defaultSeccessUrl</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    .</span><span class=\"mtk11\">permitAll</span><span class=\"mtk1\">()</span></span></span></code></pre>\n<p><a href=\"https://stackoverflow.com/questions/53140629/spring-security-loginpage-vs-loginprocessingurl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">loginProcessingUrl은 Spring Security가 Form인증을 처리할 경로로 Spring MVC 및 컨트롤러에 요청을 전달하지 않는다.</a></p>\n<ol start=\"2\">\n<li>\n<p>logout</p>\n<ol>\n<li>view source에서 logout</li>\n<li>session 해제 Controller 구현 - SecurityContextHolder에서 context를 직접 가져와 해제해준다.</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"93466226395202240000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@GetMapping(value = &quot;/logout&quot;)\npublic String logout(HttpServletRequest request, HttpServletResponse response) throws Exception {\n\n    Authentication authentication = SecurityContextHolder.getContext().getAuthentication();\n    if (authentication != null) {\n        new SecurityContextLogoutHandler().logout(request, response, authentication);\n    }\n\n    return &quot;redirect:/login&quot;;\n}`, `93466226395202240000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">GetMapping</span><span class=\"mtk1\">(value = </span><span class=\"mtk8\">&quot;/logout&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk11\">logout</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> request, </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> response) throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">Authentication</span><span class=\"mtk1\"> </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">SecurityContextHolder</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getContext</span><span class=\"mtk1\">().</span><span class=\"mtk11\">getAuthentication</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (authentication != </span><span class=\"mtk4\">null</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">SecurityContextLogoutHandler</span><span class=\"mtk1\">().</span><span class=\"mtk11\">logout</span><span class=\"mtk1\">(request, response, authentication);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;redirect:/login&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n</li>\n<li>\n<p>인증 성공 handler 구현</p>\n</li>\n</ol>\n<p>SimpleUrlAuthenticationSuccessHandler 을 상속받아 구현 - 인증 성공 후 페이지 이동 기능 구현</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"77039035848007660000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@Component\n@Slf4j\npublic class FormAuthenticationSuccessHandler extends SimpleUrlAuthenticationSuccessHandler {\n\n    private RequestCache requestCache = new HttpSessionRequestCache();\n\n    private RedirectStrategy redirectStrategy = new DefaultRedirectStrategy();\n\n    @Override\n    public void onAuthenticationSuccess(final HttpServletRequest request, final HttpServletResponse response, final Authentication authentication) throws IOException {\n\n        setDefaultTargetUrl(&quot;/&quot;);\n\n        SavedRequest savedRequest = requestCache.getRequest(request, response);\n\n        if (savedRequest != null) {\n            String targetUrl = savedRequest.getRedirectUrl();\n            redirectStrategy.sendRedirect(request, response, targetUrl);\n        } else {\n            redirectStrategy.sendRedirect(request, response, getDefaultTargetUrl());\n        }\n    }\n}`, `77039035848007660000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Component</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Slf4j</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FormAuthenticationSuccessHandler</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SimpleUrlAuthenticationSuccessHandler</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RequestCache</span><span class=\"mtk1\"> </span><span class=\"mtk12\">requestCache</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">HttpSessionRequestCache</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RedirectStrategy</span><span class=\"mtk1\"> </span><span class=\"mtk12\">redirectStrategy</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">DefaultRedirectStrategy</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">onAuthenticationSuccess</span><span class=\"mtk1\">(</span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">, </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Authentication</span><span class=\"mtk1\"> </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">setDefaultTargetUrl</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">SavedRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">savedRequest</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">requestCache</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRequest</span><span class=\"mtk1\">(request, response);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (savedRequest != </span><span class=\"mtk4\">null</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">targetUrl</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">savedRequest</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRedirectUrl</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">redirectStrategy</span><span class=\"mtk1\">.</span><span class=\"mtk11\">sendRedirect</span><span class=\"mtk1\">(request, response, targetUrl);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">redirectStrategy</span><span class=\"mtk1\">.</span><span class=\"mtk11\">sendRedirect</span><span class=\"mtk1\">(request, response, </span><span class=\"mtk11\">getDefaultTargetUrl</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ol start=\"4\">\n<li>인증 실패 handler 구현</li>\n</ol>\n<p>SimpleUrlAuthenticationFailureHandler 상속 받아 구현 - exception이 난 경우 에러 처리 구현</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"25940435011224916000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@Component\npublic class FormAuthenticationFailureHandler extends SimpleUrlAuthenticationFailureHandler {\n\n    private RedirectStrategy redirectStrategy = new DefaultRedirectStrategy();\n\n    @Override\n    public void onAuthenticationFailure(final HttpServletRequest request, final HttpServletResponse response, final AuthenticationException exception) throws IOException, ServletException {\n\n        String errorMessage = &quot;Invalid Username or Password&quot;;\n\n        if (exception instanceof BadCredentialsException) {\n            errorMessage = &quot;Invalid Username or Password&quot;;\n        } else if (exception instanceof DisabledException) {\n            errorMessage = &quot;Locked&quot;;\n        } else if (exception instanceof CredentialsExpiredException) {\n            errorMessage = &quot;Expired password&quot;;\n        }\n\n        setDefaultFailureUrl(&quot;/login?error=true&exception=&quot; + errorMessage);\n\n        super.onAuthenticationFailure(request, response, exception);\n\n    }\n}`, `25940435011224916000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"22\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Component</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FormAuthenticationFailureHandler</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SimpleUrlAuthenticationFailureHandler</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RedirectStrategy</span><span class=\"mtk1\"> </span><span class=\"mtk12\">redirectStrategy</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">DefaultRedirectStrategy</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">onAuthenticationFailure</span><span class=\"mtk1\">(</span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">, </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AuthenticationException</span><span class=\"mtk1\"> </span><span class=\"mtk12\">exception</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\">, </span><span class=\"mtk10\">ServletException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">errorMessage</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">&quot;Invalid Username or Password&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (exception </span><span class=\"mtk4\">instanceof</span><span class=\"mtk1\"> BadCredentialsException) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            errorMessage = </span><span class=\"mtk8\">&quot;Invalid Username or Password&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (exception </span><span class=\"mtk4\">instanceof</span><span class=\"mtk1\"> DisabledException) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            errorMessage = </span><span class=\"mtk8\">&quot;Locked&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (exception </span><span class=\"mtk4\">instanceof</span><span class=\"mtk1\"> CredentialsExpiredException) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            errorMessage = </span><span class=\"mtk8\">&quot;Expired password&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">setDefaultFailureUrl</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/login?error=true&amp;exception=&quot;</span><span class=\"mtk1\"> + errorMessage);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">super</span><span class=\"mtk1\">.</span><span class=\"mtk11\">onAuthenticationFailure</span><span class=\"mtk1\">(request, response, exception);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ol start=\"5\">\n<li>인증 거부 처리</li>\n</ol>\n<blockquote>\n<p>인증은 성공 했지만 권한이 없는 경우</p>\n</blockquote>\n<p>AccessDeniedHandler 을 상속받아 구현한다.</p>\n<ul>\n<li>인가 예외는 AbstractSecurityInterceptor에서 발생</li>\n<li>exception 처리는 ExceptionTranslationFilter의 AccessDeniedHandler에서 처리</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"50565636443739990000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@Component\npublic class FormAccessDeniedHandler implements AccessDeniedHandler {\n\n    private String errorPage;\n\n    private ObjectMapper mapper = new ObjectMapper();\n\n    private RedirectStrategy redirectStrategy = new DefaultRedirectStrategy();\n\n    @Override\n    public void handle(HttpServletRequest request, HttpServletResponse response, AccessDeniedException accessDeniedException) throws IOException, ServletException {\n\n        if (WebUtil.isAjax(request)) {\n            response.setContentType(MediaType.APPLICATION_JSON_VALUE);\n            response.getWriter().write(this.mapper.writeValueAsString(ResponseEntity.status(HttpStatus.FORBIDDEN)));\n\n        } else {\n            String deniedUrl = errorPage + &quot;?exception=&quot; + accessDeniedException.getMessage();\n            redirectStrategy.sendRedirect(request, response, deniedUrl);\n        }\n    }\n\n    public void setErrorPage(String errorPage) {\n        if ((errorPage != null) && !errorPage.startsWith(&quot;/&quot;)) {\n            throw new IllegalArgumentException(&quot;errorPage must begin with '/'&quot;);\n        }\n\n        this.errorPage = errorPage;\n    }\n\n}\n`, `50565636443739990000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"23\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Component</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FormAccessDeniedHandler</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AccessDeniedHandler</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">errorPage</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ObjectMapper</span><span class=\"mtk1\"> </span><span class=\"mtk12\">mapper</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">ObjectMapper</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RedirectStrategy</span><span class=\"mtk1\"> </span><span class=\"mtk12\">redirectStrategy</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">DefaultRedirectStrategy</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">handle</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">, </span><span class=\"mtk10\">AccessDeniedException</span><span class=\"mtk1\"> </span><span class=\"mtk12\">accessDeniedException</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\">, </span><span class=\"mtk10\">ServletException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">WebUtil</span><span class=\"mtk1\">.</span><span class=\"mtk11\">isAjax</span><span class=\"mtk1\">(request)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">response</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setContentType</span><span class=\"mtk1\">(</span><span class=\"mtk12\">MediaType</span><span class=\"mtk1\">.</span><span class=\"mtk12\">APPLICATION_JSON_VALUE</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">response</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getWriter</span><span class=\"mtk1\">().</span><span class=\"mtk11\">write</span><span class=\"mtk1\">(</span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">mapper</span><span class=\"mtk1\">.</span><span class=\"mtk11\">writeValueAsString</span><span class=\"mtk1\">(</span><span class=\"mtk12\">ResponseEntity</span><span class=\"mtk1\">.</span><span class=\"mtk11\">status</span><span class=\"mtk1\">(</span><span class=\"mtk12\">HttpStatus</span><span class=\"mtk1\">.</span><span class=\"mtk12\">FORBIDDEN</span><span class=\"mtk1\">)));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">deniedUrl</span><span class=\"mtk1\"> = errorPage + </span><span class=\"mtk8\">&quot;?exception=&quot;</span><span class=\"mtk1\"> + </span><span class=\"mtk12\">accessDeniedException</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getMessage</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">redirectStrategy</span><span class=\"mtk1\">.</span><span class=\"mtk11\">sendRedirect</span><span class=\"mtk1\">(request, response, deniedUrl);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setErrorPage</span><span class=\"mtk1\">(</span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">errorPage</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> ((errorPage != </span><span class=\"mtk4\">null</span><span class=\"mtk1\">) &amp;&amp; !</span><span class=\"mtk12\">errorPage</span><span class=\"mtk1\">.</span><span class=\"mtk11\">startsWith</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/&quot;</span><span class=\"mtk1\">)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">throw</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">IllegalArgumentException</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;errorPage must begin with &#39;/&#39;&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">errorPage</span><span class=\"mtk1\"> = errorPage;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<h2 id=\"ajax-인증\" style=\"position:relative;\"><a href=\"#ajax-%EC%9D%B8%EC%A6%9D\" aria-label=\"ajax 인증 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ajax 인증</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/582bf3e3366333e1b1c227c9feb7c3e7/fa34b/AjaxAuthentication.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.306748466257666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACP0lEQVR42jWRbVObQBSF/f+/of1ep+OMOkajpJoQ01byQjQvWtEEhIKJSYCwbAAhTydk+uHumZ3d88ycew6C1yci0yA1n8jsVzLPYv08IDEnZK7Ddgt5VpAkG9h+wrYoNU0SkgyyHNIckrQgjmMOEiGwnXfOa7+oKD+p1rtYlk2zfUnl5ohz9Zif93WmlktF6XBy0aJ63cecmpgPVR61U560E+xHdQ/cSMnUnnFxZ3DRGtLom1jujP70N7ejH7RG1wzMNo63oHb7h0pNp9YymEwmTDrf0a6+oNe+Mu2fI4TgIAgCPubvCOeJTRSwDlbIOGY8eORBH6B37+l1+jyOx8g4JE1j2GZIKXkYG2jdB7TeAGPyVvoOYinZyJjouc3MdXFcl8ViwZVyxdnZGYeH36icV1BVFdt2mM3mRJFAiAgZi9K7mzgW+8i7IwxDgkiwWq2YeV551zSNZlOlpiioaoNut4PneeWfnSdNU/I8pyiKUrMs2wN3uRdLH38tSIstSbHFD0N8f0UgJJvPohyZfbJer0vgzjMajWg0Gtzc3FCv19F1fQ+UmwQxc3C7Ko7ewtOb2M8jnL8ur3cNzLtrLK3OfKgxe3/HensrE+xKGQ6HZZLBYIBhGPtS4iQlejPwGsdY9VM89QRn3MdxPaxmhYlyxKR2xLJdI/R9Qj8gitYsl8tyBfP5vNSPj4//OxTIJGWTFyT5FvlZsPSDsphVGLHJckSSsZYJjmNjvbyUb71ej8vLSxRFoVqt0mq1SuA/XsHWVLTPu58AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/582bf3e3366333e1b1c227c9feb7c3e7/a81b5/AjaxAuthentication.webp 163w,\n/static/582bf3e3366333e1b1c227c9feb7c3e7/da3ef/AjaxAuthentication.webp 325w,\n/static/582bf3e3366333e1b1c227c9feb7c3e7/309d5/AjaxAuthentication.webp 650w,\n/static/582bf3e3366333e1b1c227c9feb7c3e7/78344/AjaxAuthentication.webp 975w,\n/static/582bf3e3366333e1b1c227c9feb7c3e7/bdb72/AjaxAuthentication.webp 1300w,\n/static/582bf3e3366333e1b1c227c9feb7c3e7/237f9/AjaxAuthentication.webp 2524w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/582bf3e3366333e1b1c227c9feb7c3e7/5e043/AjaxAuthentication.png 163w,\n/static/582bf3e3366333e1b1c227c9feb7c3e7/e5cc6/AjaxAuthentication.png 325w,\n/static/582bf3e3366333e1b1c227c9feb7c3e7/663f3/AjaxAuthentication.png 650w,\n/static/582bf3e3366333e1b1c227c9feb7c3e7/d880f/AjaxAuthentication.png 975w,\n/static/582bf3e3366333e1b1c227c9feb7c3e7/4c573/AjaxAuthentication.png 1300w,\n/static/582bf3e3366333e1b1c227c9feb7c3e7/fa34b/AjaxAuthentication.png 2524w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/582bf3e3366333e1b1c227c9feb7c3e7/663f3/AjaxAuthentication.png\"\n            alt=\"AjaxAuthentication\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>AjaxAuthenticationFilter -> AjaxAuthenticationToken -> AuthenticationManager -> AjaxAuthenticationProvider 순으로 인증처리 흐름</p>\n<h3 id=\"1-ajax-요청-처리-할-filter-추가\" style=\"position:relative;\"><a href=\"#1-ajax-%EC%9A%94%EC%B2%AD-%EC%B2%98%EB%A6%AC-%ED%95%A0-filter-%EC%B6%94%EA%B0%80\" aria-label=\"1 ajax 요청 처리 할 filter 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Ajax 요청 처리 할 Filter 추가</h3>\n<blockquote>\n<p><strong>AbstractAuthenticationProcessingFilter</strong>을 상속받아 <strong>AjaxAuthenticationFilter</strong> 구현</p>\n</blockquote>\n<ul>\n<li>AbstractAuthenticationProcessingFilter는 Form 로그인에서 UsernamePassowordAuthenticationFilter가 상속받던 부모 객체로, 맨 처음 인증 처리를 해주는 Filter 추상 클래스이다.</li>\n<li><strong>필터 적용 조건 1) url 요청 정보 매칭, 2) 헤더에 X-Requested-With으로 Ajax요청 확인</strong></li>\n<li>ObjectMapper을 이용해 request.getReader()로 요청 정보를 읽어서 AccountDto로 매핑</li>\n<li>AjaxAuthenticationToken에 담아 AuthenticationManager의 authenticate 인증 메서드로 전달하여 인증 처리</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"44011172079200420000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public class AjaxLoginProcessingFilter extends AbstractAuthenticationProcessingFilter {\n\n    private ObjectMapper objectMapper = new ObjectMapper();\n\n    public AjaxLoginProcessingFilter() {\n        super(new AntPathRequestMatcher(&quot;/ajaxLogin&quot;, &quot;POST&quot;));\n    }\n\n    @Override\n    public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response)\n            throws AuthenticationException, IOException {\n\n        if (!HttpMethod.POST.name().equals(request.getMethod()) || !WebUtil.isAjax(request)) {\n            throw new IllegalArgumentException(&quot;Authentication method not supported&quot;);\n        }\n\n        AccountDto accountDto = objectMapper.readValue(request.getReader(), AccountDto.class);\n\n        if (StringUtils.isEmpty(accountDto.getUsername()) || StringUtils.isEmpty(accountDto.getPassword())) {\n            throw new AuthenticationServiceException(&quot;Username or Password not provided&quot;);\n        }\n        AjaxAuthenticationToken token = new AjaxAuthenticationToken(accountDto.getUsername(), accountDto.getPassword());\n\n        return this.getAuthenticationManager().authenticate(token);\n    }\n}`, `44011172079200420000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"24\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AjaxLoginProcessingFilter</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AbstractAuthenticationProcessingFilter</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ObjectMapper</span><span class=\"mtk1\"> </span><span class=\"mtk12\">objectMapper</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">ObjectMapper</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AjaxLoginProcessingFilter</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">super</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AntPathRequestMatcher</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/ajaxLogin&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;POST&quot;</span><span class=\"mtk1\">));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Authentication</span><span class=\"mtk1\"> </span><span class=\"mtk11\">attemptAuthentication</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AuthenticationException</span><span class=\"mtk1\">, </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (!</span><span class=\"mtk12\">HttpMethod</span><span class=\"mtk1\">.</span><span class=\"mtk12\">POST</span><span class=\"mtk1\">.</span><span class=\"mtk11\">name</span><span class=\"mtk1\">().</span><span class=\"mtk11\">equals</span><span class=\"mtk1\">(</span><span class=\"mtk12\">request</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getMethod</span><span class=\"mtk1\">()) || !</span><span class=\"mtk12\">WebUtil</span><span class=\"mtk1\">.</span><span class=\"mtk11\">isAjax</span><span class=\"mtk1\">(request)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">throw</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">IllegalArgumentException</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Authentication method not supported&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">AccountDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">accountDto</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">objectMapper</span><span class=\"mtk1\">.</span><span class=\"mtk11\">readValue</span><span class=\"mtk1\">(</span><span class=\"mtk12\">request</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getReader</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">AccountDto</span><span class=\"mtk1\">.</span><span class=\"mtk12\">class</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">StringUtils</span><span class=\"mtk1\">.</span><span class=\"mtk11\">isEmpty</span><span class=\"mtk1\">(</span><span class=\"mtk12\">accountDto</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getUsername</span><span class=\"mtk1\">()) || </span><span class=\"mtk12\">StringUtils</span><span class=\"mtk1\">.</span><span class=\"mtk11\">isEmpty</span><span class=\"mtk1\">(</span><span class=\"mtk12\">accountDto</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getPassword</span><span class=\"mtk1\">())) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">throw</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AuthenticationServiceException</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Username or Password not provided&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">AjaxAuthenticationToken</span><span class=\"mtk1\"> </span><span class=\"mtk12\">token</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AjaxAuthenticationToken</span><span class=\"mtk1\">(</span><span class=\"mtk12\">accountDto</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getUsername</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">accountDto</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getPassword</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getAuthenticationManager</span><span class=\"mtk1\">().</span><span class=\"mtk11\">authenticate</span><span class=\"mtk1\">(token);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"2-ajaxauthenticationtoken객체-생성\" style=\"position:relative;\"><a href=\"#2-ajaxauthenticationtoken%EA%B0%9D%EC%B2%B4-%EC%83%9D%EC%84%B1\" aria-label=\"2 ajaxauthenticationtoken객체 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. AjaxAuthenticationToken객체 생성</h3>\n<blockquote>\n<p>인증 정보를 담는 Token 객체 생성, Token 객체를 공통으로 구현하는 AbstractAuthenticationToken 추상 클래스를 상속해 구현</p>\n</blockquote>\n<ul>\n<li>oken의 구성정보를 직접 손댈 필요는 없기 때문에, UsernamePasswordAuthenticationToken.class의 내용을 그대로 복사</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"83563842075368060000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public class AjaxAuthenticationToken extends AbstractAuthenticationToken {\n\n    private final Object principal;\n    private Object credentials;\n\n    public AjaxAuthenticationToken(Object principal, Object credentials) {\n        super(null);\n        this.principal = principal;\n        this.credentials = credentials;\n        setAuthenticated(false);\n    }\n\n    public AjaxAuthenticationToken(Object principal, Object credentials, Collection<? extends GrantedAuthority> authorities) {\n        super(authorities);\n        this.principal = principal;\n        this.credentials = credentials;\n        super.setAuthenticated(true);\n    }\n\n    @Override\n    public Object getCredentials() {\n        return this.credentials;\n    }\n\n    @Override\n    public Object getPrincipal() {\n        return this.principal;\n    }\n}\n`, `83563842075368060000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"25\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AjaxAuthenticationToken</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AbstractAuthenticationToken</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk12\">principal</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk12\">credentials</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AjaxAuthenticationToken</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk12\">principal</span><span class=\"mtk1\">, </span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk12\">credentials</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">super</span><span class=\"mtk1\">(</span><span class=\"mtk4\">null</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">principal</span><span class=\"mtk1\"> = principal;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">credentials</span><span class=\"mtk1\"> = credentials;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk11\">setAuthenticated</span><span class=\"mtk1\">(</span><span class=\"mtk4\">false</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AjaxAuthenticationToken</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk12\">principal</span><span class=\"mtk1\">, </span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk12\">credentials</span><span class=\"mtk1\">, </span><span class=\"mtk10\">Collection</span><span class=\"mtk1\">&lt;</span><span class=\"mtk4\">?</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">GrantedAuthority</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">authorities</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">super</span><span class=\"mtk1\">(authorities);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">principal</span><span class=\"mtk1\"> = principal;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">credentials</span><span class=\"mtk1\"> = credentials;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">super</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setAuthenticated</span><span class=\"mtk1\">(</span><span class=\"mtk4\">true</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getCredentials</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">credentials</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk11\">getPrincipal</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">principal</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<p>추가로 설정한 Filter를 사용하기 위해선 AuthenticationManager에 등록(set) 시켜야 한다.</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"75116841729970540000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// AuthenticationManager bean override\n@Override\npublic AuthenticationManager authenticationManagerBean() throws Exception {\n    return super.authenticationManagerBean();\n}\n\n@Bean\npublic AjaxLoginProcessingFilter ajaxLoginProcessingFilter() throws Exception {\n    AjaxLoginProcessingFilter ajaxLoginProcessingFilter = new AjaxLoginProcessingFilter();\n    ajaxLoginProcessingFilter.setAuthenticationManager(authenticationManagerBean()); // 등록\n    return ajaxLoginProcessingFilter;\n}`, `75116841729970540000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"26\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// AuthenticationManager bean override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AuthenticationManager</span><span class=\"mtk1\"> </span><span class=\"mtk11\">authenticationManagerBean</span><span class=\"mtk1\">() throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">super</span><span class=\"mtk1\">.</span><span class=\"mtk11\">authenticationManagerBean</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AjaxLoginProcessingFilter</span><span class=\"mtk1\"> </span><span class=\"mtk11\">ajaxLoginProcessingFilter</span><span class=\"mtk1\">() throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">AjaxLoginProcessingFilter</span><span class=\"mtk1\"> </span><span class=\"mtk12\">ajaxLoginProcessingFilter</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AjaxLoginProcessingFilter</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">ajaxLoginProcessingFilter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setAuthenticationManager</span><span class=\"mtk1\">(</span><span class=\"mtk11\">authenticationManagerBean</span><span class=\"mtk1\">()); </span><span class=\"mtk3\">// 등록</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> ajaxLoginProcessingFilter;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"3-인증-처리-할-ajaxauthenticationprovider-구현\" style=\"position:relative;\"><a href=\"#3-%EC%9D%B8%EC%A6%9D-%EC%B2%98%EB%A6%AC-%ED%95%A0-ajaxauthenticationprovider-%EA%B5%AC%ED%98%84\" aria-label=\"3 인증 처리 할 ajaxauthenticationprovider 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 인증 처리 할 AjaxAuthenticationProvider 구현</h3>\n<p>Provider는 Form 방법과 동일하게 작성 (반환 시 AjaxAuthenticationToken)</p>\n<h3 id=\"4-인증-성공-실패-처리-핸들러-구현\" style=\"position:relative;\"><a href=\"#4-%EC%9D%B8%EC%A6%9D-%EC%84%B1%EA%B3%B5-%EC%8B%A4%ED%8C%A8-%EC%B2%98%EB%A6%AC-%ED%95%B8%EB%93%A4%EB%9F%AC-%EA%B5%AC%ED%98%84\" aria-label=\"4 인증 성공 실패 처리 핸들러 구현 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 인증 성공, 실패 처리 핸들러 구현</h3>\n<p>성공, 실패 handler 처리는 Form과 동일하게 생성 내용은 같아 생략</p>\n<p>설정한 handler함수들은 위에서 사용한 ajaxLoginProcessingFilter를 사용해서 AuthenticationManager에 등록시킨다.</p>\n<p>(ProcessingFilter에서 set 메서드들을 이용하여 handler들을 추가)</p>\n<h3 id=\"5-인가-설정\" style=\"position:relative;\"><a href=\"#5-%EC%9D%B8%EA%B0%80-%EC%84%A4%EC%A0%95\" aria-label=\"5 인가 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 인가 설정</h3>\n<p>인가 처리는 FilterSecurityInterceptor가 수행</p>\n<ol>\n<li>인증을 받지 않는 익명 사용자의 접근처리</li>\n<li>인증을 받은 사용자의 권한 정보 처리</li>\n</ol>\n<p>에 대한 처리를 한다.</p>\n<h4 id=\"51-인증을-받지-않는-익명-사용자의-접근처리\" style=\"position:relative;\"><a href=\"#51-%EC%9D%B8%EC%A6%9D%EC%9D%84-%EB%B0%9B%EC%A7%80-%EC%95%8A%EB%8A%94-%EC%9D%B5%EB%AA%85-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%9D%98-%EC%A0%91%EA%B7%BC%EC%B2%98%EB%A6%AC\" aria-label=\"51 인증을 받지 않는 익명 사용자의 접근처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.1) 인증을 받지 않는 익명 사용자의 접근처리</h4>\n<blockquote>\n<p>AuthenticationEntryPoint를 상속받은 구현체 구현 / 익명 사용자가 인증이 필요한 자원에 접근한 경우, commence 메서드가 호출됨</p>\n</blockquote>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"10241306554098960000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public class AjaxLoginAuthenticationEntryPoint implements AuthenticationEntryPoint {\n\n    //익명 사용자가 인증이 필요한 자원에 접근한 경우, commence 메서드가 호출됨\n    @Override\n    public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException e) throws IOException, ServletException {\n        response.sendError(HttpServletResponse.SC_UNAUTHORIZED, &quot;UnAuthorized&quot;);\n    }\n}`, `10241306554098960000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"27\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AjaxLoginAuthenticationEntryPoint</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AuthenticationEntryPoint</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\">//익명 사용자가 인증이 필요한 자원에 접근한 경우, commence 메서드가 호출됨</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">commence</span><span class=\"mtk1\">(</span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\">, </span><span class=\"mtk10\">HttpServletResponse</span><span class=\"mtk1\"> </span><span class=\"mtk12\">response</span><span class=\"mtk1\">, </span><span class=\"mtk10\">AuthenticationException</span><span class=\"mtk1\"> </span><span class=\"mtk12\">e</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\">, </span><span class=\"mtk10\">ServletException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">response</span><span class=\"mtk1\">.</span><span class=\"mtk11\">sendError</span><span class=\"mtk1\">(</span><span class=\"mtk12\">HttpServletResponse</span><span class=\"mtk1\">.</span><span class=\"mtk12\">SC_UNAUTHORIZED</span><span class=\"mtk1\">, </span><span class=\"mtk8\">&quot;UnAuthorized&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h4 id=\"52-인증을-받은-사용자의-권한-정보-처리\" style=\"position:relative;\"><a href=\"#52-%EC%9D%B8%EC%A6%9D%EC%9D%84-%EB%B0%9B%EC%9D%80-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%9D%98-%EA%B6%8C%ED%95%9C-%EC%A0%95%EB%B3%B4-%EC%B2%98%EB%A6%AC\" aria-label=\"52 인증을 받은 사용자의 권한 정보 처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.2) 인증을 받은 사용자의 권한 정보 처리</h4>\n<blockquote>\n<p>AccessDeniedHandler를 상속받고, handler 메서드를 Override 해준다.</p>\n</blockquote>\n<p>구현체를 모두 작성하였으면 설정 파일에 authenticationEntryPoint, accessDeniedHandler 메서드를 추가<br>\n각 객체들을 그대로 사용할 것이기 때문에 따로 Bean으로 만들지 않고 new 키워드를 통해 바로 생성</p>\n<h3 id=\"6-bean-설정-및-ajax용-securityconfig-설정-추가\" style=\"position:relative;\"><a href=\"#6-bean-%EC%84%A4%EC%A0%95-%EB%B0%8F-ajax%EC%9A%A9-securityconfig-%EC%84%A4%EC%A0%95-%EC%B6%94%EA%B0%80\" aria-label=\"6 bean 설정 및 ajax용 securityconfig 설정 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Bean 설정 및 Ajax용 SecurityConfig 설정 추가</h3>\n<ol>\n<li>Ajax용 Config가 Form Config보다 먼저 로드되게 설정 -> @Order(0)</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"53700272133985490000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// config\nhttp\n    .addFilterBefore(ajaxLoginProcessingFilter(), UsernamePasswordAuthenticationFilter.class) //기존 필터 앞에 위치할때 사용하는 method\n    .authenticationEntryPoint(new AjaxLoginAuthenticationEntryPoint())\n    .accessDeniedHandler(new AjaxAccessDeniedHandler())\n\nhttp.csrf().disable() //기본적으로 csrf 토큰값을 들고 요청을 해야되는데, 임시적으로 off 한다.\n\n\n@Override\npublic AuthenticationManager authenticationManagerBean() throws Exception {\n    return super.authenticationManagerBean();\n}\n\n@Bean\npublic AjaxLoginProcessingFilter ajaxLoginProcessingFilter() throws Exception {\n    AjaxLoginProcessingFilter ajaxLoginProcessingFilter = new AjaxLoginProcessingFilter();\n    ajaxLoginProcessingFilter.setAuthenticationManager(authenticationManagerBean());\n        //인증 성공, 실패 시 handler 처리\n    ajaxLoginProcessingFilter.setAuthenticationSuccessHandler(ajaxAuthenticationSuccessHandler());\n    ajaxLoginProcessingFilter.setAuthenticationFailureHandler(ajaxAuthenticationFailureHandler());\n    return ajaxLoginProcessingFilter;\n}`, `53700272133985490000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"28\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// config</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">http</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    .</span><span class=\"mtk11\">addFilterBefore</span><span class=\"mtk1\">(</span><span class=\"mtk11\">ajaxLoginProcessingFilter</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">UsernamePasswordAuthenticationFilter</span><span class=\"mtk1\">.</span><span class=\"mtk12\">class</span><span class=\"mtk1\">) </span><span class=\"mtk3\">//기존 필터 앞에 위치할때 사용하는 method</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    .</span><span class=\"mtk11\">authenticationEntryPoint</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AjaxLoginAuthenticationEntryPoint</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    .</span><span class=\"mtk11\">accessDeniedHandler</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AjaxAccessDeniedHandler</span><span class=\"mtk1\">())</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">http</span><span class=\"mtk1\">.</span><span class=\"mtk11\">csrf</span><span class=\"mtk1\">().</span><span class=\"mtk11\">disable</span><span class=\"mtk1\">() </span><span class=\"mtk3\">//기본적으로 csrf 토큰값을 들고 요청을 해야되는데, 임시적으로 off 한다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AuthenticationManager</span><span class=\"mtk1\"> </span><span class=\"mtk11\">authenticationManagerBean</span><span class=\"mtk1\">() throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">super</span><span class=\"mtk1\">.</span><span class=\"mtk11\">authenticationManagerBean</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AjaxLoginProcessingFilter</span><span class=\"mtk1\"> </span><span class=\"mtk11\">ajaxLoginProcessingFilter</span><span class=\"mtk1\">() throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">AjaxLoginProcessingFilter</span><span class=\"mtk1\"> </span><span class=\"mtk12\">ajaxLoginProcessingFilter</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AjaxLoginProcessingFilter</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">ajaxLoginProcessingFilter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setAuthenticationManager</span><span class=\"mtk1\">(</span><span class=\"mtk11\">authenticationManagerBean</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">//인증 성공, 실패 시 handler 처리</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">ajaxLoginProcessingFilter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setAuthenticationSuccessHandler</span><span class=\"mtk1\">(</span><span class=\"mtk11\">ajaxAuthenticationSuccessHandler</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">ajaxLoginProcessingFilter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setAuthenticationFailureHandler</span><span class=\"mtk1\">(</span><span class=\"mtk11\">ajaxAuthenticationFailureHandler</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> ajaxLoginProcessingFilter;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"dsls\" style=\"position:relative;\"><a href=\"#dsls\" aria-label=\"dsls permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DSLs</h3>\n<p>강의에선 dsl을 사용해 Configurer 클래스를 생성해 Config 부분을 나눠<br>\nfilter, handler, 환경설정 메서드의 set을 만든다</p>\n<p>공식 문서에서는 AbstractHttpConfigurer를 상속받아 설명하는데<br>\n강의에서는 AbstractHttpConfigurer를 상속받은 AbstractAuthenticationFilterConfigurer를 상속받아 Configurer를 구현한다.</p>\n<p>사실 이해하기 힘들어서 해당 부분은 코드 읽고 넘어간다.</p>\n<p>추후에 config파일을 나눌 일이 있으면 해당 document를 참고해서 작성하자</p>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/configuration/java.html#jc-custom-dsls\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Security 6.0.1 document</a><br>\n<a href=\"https://godekdls.github.io/Spring%20Security/javaconfiguration/#164-custom-dsls\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Security 5.3.2 document - 토리맘의 한글라이즈 프로젝트</a></p>\n<h3 id=\"ajax-login-csrf-설정\" style=\"position:relative;\"><a href=\"#ajax-login-csrf-%EC%84%A4%EC%A0%95\" aria-label=\"ajax login csrf 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ajax Login, CSRF 설정</h3>\n<p>csrf token값은 header에 meta태그나 form태그의 hidden속성을 주고 ajax요청 시 csrfHeader에 csrfToken을 함께 보내준다.</p>\n<ul>\n<li>csrf Filter는 disable 처리를 하지 않는 한 자동 처리</li>\n<li>헤더에 토큰을 포함 시킬 경우 <strong>X-CSRF-TOKEN</strong>, <strong>X-XSRF-TOKEN</strong></li>\n<li>form에 담을 경우 파라미터 명 <strong>_csrf</strong></li>\n</ul>\n<p>추가로 CSRF토큰에 대해 잘 정리해둔 블로그 글이 있어 링크 남긴다.<br>\n<a href=\"https://binchoo.tistory.com/46\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">[스프링 Security] CSRF 토큰 이야기 - 그래서 개발자는 뭘 하면 되죠</a></p>\n<h1 id=\"인가-프로세스-db연동\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EA%B0%80-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-db%EC%97%B0%EB%8F%99\" aria-label=\"인가 프로세스 db연동 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인가 프로세스 DB연동</h1>\n<p>강의 진행을 위해 설정 클래스(config)에서 관련된 코드 모두 제거</p>\n<h2 id=\"url-방식-처리\" style=\"position:relative;\"><a href=\"#url-%EB%B0%A9%EC%8B%9D-%EC%B2%98%EB%A6%AC\" aria-label=\"url 방식 처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>URL 방식 처리</h2>\n<h3 id=\"url-방식-기본-동작-원리\" style=\"position:relative;\"><a href=\"#url-%EB%B0%A9%EC%8B%9D-%EA%B8%B0%EB%B3%B8-%EB%8F%99%EC%9E%91-%EC%9B%90%EB%A6%AC\" aria-label=\"url 방식 기본 동작 원리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>URL 방식 기본 동작 원리</h3>\n<blockquote>\n<p>FilterSecurityInterceptor가 AccessDecisionManager에게 <strong>인증, 요청, 권한정보</strong>를 담아서 전달해주어 인증 및 인가처리</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0d97f58074889f1036d312145e938847/88eef/AuthorizationProcess.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.39877300613497%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB+ElEQVR42nWSW08TURSF54+iPio8ybP8ARO1GDEa44sx+EBQJITEK0FEUykQeqNTmJa2lNLpdDrMuc0MlM90qJeY+LDO3slZWScn67OUUmitiYwhapVJtMQYg5KS0V065XiKEK1kqtGupLjy/CVrdAyCM7quR6u4hW1XcD1/bPgTqqMIDQTRBb5O0l3H8e+HhZSEQmIxPMdunzG/VuXlxzLPVnbJVrpcDi+QUiHTsISgadN7/5TaUobq4gN6q48YVHOYZJh6ziPNMNFYR/U6hWKJcqXKVm6bjc3vlMr7HBwcIIRAiBChNL2jfRorj6kszWEvP+Fw8R796jbCxEQqZOvQ40PBxcpkMkxMTDA1eYuZmTtMTU1y4/o1bk9P47ruONDg1Ut0VmapL81Se/uQ4zd36Vd+UGt1CHtt7r874uaLClYYhvi+z3G7Tb5YYGd3B6dcouE4BEFAMBggtaHfsBHZBdwv83TX5wk3XzFw9pBRQqQlh+0++XoXS2lFHCWEfkhxe49GvYXnepx2OjSbTRzHoe95SBMRJqSF9FXMWQJCR2lxUiliozmPNZZWGtc/5VvpE2vZZZ6/nmP18zL5fJFGs8HJyUn69au2BVqOsRkh8wstdVXeqGlLa4MXuOScr2TtdXK1DU6DY4YXlxijUyZHnP7L2//0E7csjnJ789y4AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0d97f58074889f1036d312145e938847/a81b5/AuthorizationProcess.webp 163w,\n/static/0d97f58074889f1036d312145e938847/da3ef/AuthorizationProcess.webp 325w,\n/static/0d97f58074889f1036d312145e938847/309d5/AuthorizationProcess.webp 650w,\n/static/0d97f58074889f1036d312145e938847/78344/AuthorizationProcess.webp 975w,\n/static/0d97f58074889f1036d312145e938847/bdb72/AuthorizationProcess.webp 1300w,\n/static/0d97f58074889f1036d312145e938847/27ba4/AuthorizationProcess.webp 2528w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0d97f58074889f1036d312145e938847/5e043/AuthorizationProcess.png 163w,\n/static/0d97f58074889f1036d312145e938847/e5cc6/AuthorizationProcess.png 325w,\n/static/0d97f58074889f1036d312145e938847/663f3/AuthorizationProcess.png 650w,\n/static/0d97f58074889f1036d312145e938847/d880f/AuthorizationProcess.png 975w,\n/static/0d97f58074889f1036d312145e938847/4c573/AuthorizationProcess.png 1300w,\n/static/0d97f58074889f1036d312145e938847/88eef/AuthorizationProcess.png 2528w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0d97f58074889f1036d312145e938847/663f3/AuthorizationProcess.png\"\n            alt=\"AuthorizationProcess\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ol>\n<li>\n<p>FilterChainProxy에 있는 <strong>FilterSecurityInterceptor</strong> 에서 사용자는 요청받은 url정보 처리</p>\n</li>\n<li>\n<p><strong>FilterInvocationSecurityMetadataSource</strong>의 <strong>RequestMap</strong>객체를 확인하여 url에 매핑되어 있는 권한 정보를 확인</p>\n</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>key</th>\n<th>value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/user</td>\n<td>ROLE_ADMIN, ROLE_USER</td>\n</tr>\n<tr>\n<td>/configs</td>\n<td>ROLE_ADMIN</td>\n</tr>\n</tbody>\n</table>\n<ol start=\"3\">\n<li>\n<p>권한 정보가 있다면 AccessDecisionManager로 **Authentication, FilterInovation, List<ConfigAttribute>**를 넘겨 인가처리</p>\n</li>\n<li>\n<p>매핑 정보가 없다면 어떤 권한으로 접근해도 허용</p>\n</li>\n</ol>\n<h3 id=\"filterinvocationsecuritymetadatasource\" style=\"position:relative;\"><a href=\"#filterinvocationsecuritymetadatasource\" aria-label=\"filterinvocationsecuritymetadatasource permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FilterInvocationSecurityMetadataSource</h3>\n<blockquote>\n<p>Url 방식으로 처리할 땐 FilterInvocationSecurityMetadataSource 구현</p>\n</blockquote>\n<ul>\n<li>Url 자원에 대한 권한 정보 추출</li>\n<li>AccessDecisionManager에게 전달 해 인가처리 수행</li>\n<li>DB로 부터 자원 및 권한정보 매핑해 Map으로 관리</li>\n<li>사용자의 요청마다 요청정보에 매핑된 권한 정보 확인</li>\n</ul>\n<p>UrlFilterInvocationMetadataSource 파일 생성<br>\n-> getAttributes() 메서드만 구현 / 나머지 DefaultFilterInvocationSecurityMetadataSource 복사해 사용</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"23592527917103022000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public class UrlFilterInvocationMetadataSource implements FilterInvocationSecurityMetadataSource {\n\n    private LinkedHashMap<RequestMatcher, List<ConfigAttribute>> requestMap = new LinkedHashMap<>();\n\n    @Override\n    public Collection<ConfigAttribute> getAttributes(Object o) throws IllegalArgumentException {\n\n        HttpServletRequest request = ((FilterInvocation) o).getRequest();\n\n        requestMap.put(new AntPathRequestMatcher(&quot;/mypage&quot;), Arrays.asList(new SecurityConfig(&quot;ROLE_USER&quot;))); // null로 넘어가서 test 용도로 사용\n\n        if(!Objects.isNull(requestMap)) {\n            return requestMap.entrySet().stream().map(entry -> {\n                   RequestMatcher matcher = entry.getKey();\n                   if(matcher.matches(request)){\n                       return entry.getValue(); //권한 정보\n                   } else {\n                       return null;\n                   }\n               })\n               .filter(Objects:nonNull)\n               .flatMap(Collection::stream)\n               .collect(Collectors.toList());\n        }\n        return null;\n    }\n\n    @Override\n    public Collection<ConfigAttribute> getAllConfigAttributes() {\n        Set<ConfigAttribute> allAttributes = new HashSet();\n        Iterator var2 = this.requestMap.entrySet().iterator();\n\n        while(var2.hasNext()) {\n            Map.Entry<RequestMatcher, Collection<ConfigAttribute>> entry = (Map.Entry)var2.next();\n            allAttributes.addAll((Collection)entry.getValue());\n        }\n\n        return allAttributes;\n    }\n\n    @Override\n    public boolean supports(Class<?> clazz) {\n        return FilterInvocation.class.isAssignableFrom(clazz);\n    }\n}`, `23592527917103022000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"29\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UrlFilterInvocationMetadataSource</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FilterInvocationSecurityMetadataSource</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk12\">requestMap</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;&gt;();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Collection</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt; </span><span class=\"mtk11\">getAttributes</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk12\">o</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IllegalArgumentException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\"> = ((FilterInvocation) o).</span><span class=\"mtk11\">getRequest</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">requestMap</span><span class=\"mtk1\">.</span><span class=\"mtk11\">put</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AntPathRequestMatcher</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/mypage&quot;</span><span class=\"mtk1\">), </span><span class=\"mtk12\">Arrays</span><span class=\"mtk1\">.</span><span class=\"mtk11\">asList</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">SecurityConfig</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;ROLE_USER&quot;</span><span class=\"mtk1\">))); </span><span class=\"mtk3\">// null로 넘어가서 test 용도로 사용</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\">(!</span><span class=\"mtk12\">Objects</span><span class=\"mtk1\">.</span><span class=\"mtk11\">isNull</span><span class=\"mtk1\">(requestMap)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">requestMap</span><span class=\"mtk1\">.</span><span class=\"mtk11\">entrySet</span><span class=\"mtk1\">().</span><span class=\"mtk11\">stream</span><span class=\"mtk1\">().</span><span class=\"mtk11\">map</span><span class=\"mtk1\">(entry </span><span class=\"mtk4\">-&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                   </span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\"> </span><span class=\"mtk12\">matcher</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">entry</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getKey</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                   </span><span class=\"mtk15\">if</span><span class=\"mtk1\">(</span><span class=\"mtk12\">matcher</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(request)){</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                       </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">entry</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getValue</span><span class=\"mtk1\">(); </span><span class=\"mtk3\">//권한 정보</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                   } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                       </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">null</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                   }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">               })</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">               .</span><span class=\"mtk11\">filter</span><span class=\"mtk1\">(Objects</span><span class=\"mtk15\">:</span><span class=\"mtk1\">nonNull)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">               .</span><span class=\"mtk11\">flatMap</span><span class=\"mtk1\">(Collection</span><span class=\"mtk15\">::</span><span class=\"mtk1\">stream)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">               .</span><span class=\"mtk11\">collect</span><span class=\"mtk1\">(</span><span class=\"mtk12\">Collectors</span><span class=\"mtk1\">.</span><span class=\"mtk11\">toList</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">null</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Collection</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt; </span><span class=\"mtk11\">getAllConfigAttributes</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">Set</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">allAttributes</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">HashSet</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">Iterator</span><span class=\"mtk1\"> </span><span class=\"mtk12\">var2</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">requestMap</span><span class=\"mtk1\">.</span><span class=\"mtk11\">entrySet</span><span class=\"mtk1\">().</span><span class=\"mtk11\">iterator</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">while</span><span class=\"mtk1\">(</span><span class=\"mtk12\">var2</span><span class=\"mtk1\">.</span><span class=\"mtk11\">hasNext</span><span class=\"mtk1\">()) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">Map</span><span class=\"mtk1\">.</span><span class=\"mtk10\">Entry</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">, </span><span class=\"mtk10\">Collection</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk12\">entry</span><span class=\"mtk1\"> = (</span><span class=\"mtk12\">Map</span><span class=\"mtk1\">.</span><span class=\"mtk12\">Entry</span><span class=\"mtk1\">)</span><span class=\"mtk12\">var2</span><span class=\"mtk1\">.</span><span class=\"mtk11\">next</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">allAttributes</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addAll</span><span class=\"mtk1\">((Collection)</span><span class=\"mtk12\">entry</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getValue</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> allAttributes;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">boolean</span><span class=\"mtk1\"> </span><span class=\"mtk11\">supports</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Class</span><span class=\"mtk1\">&lt;</span><span class=\"mtk4\">?</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">clazz</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">FilterInvocation</span><span class=\"mtk1\">.</span><span class=\"mtk12\">class</span><span class=\"mtk1\">.</span><span class=\"mtk11\">isAssignableFrom</span><span class=\"mtk1\">(clazz);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h4 id=\"getattributes\" style=\"position:relative;\"><a href=\"#getattributes\" aria-label=\"getattributes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>getAttributes()</h4>\n<p><strong>FilterInvocationSecurityMetadataSource</strong>가 나중에 <strong>FilterSecurityInterceptor</strong>에 의해 호출되는데 이 때 사용되는<br>\nurl Mapping 정보인 requestMap 객체를 정의</p>\n<h4 id=\"config-설정\" style=\"position:relative;\"><a href=\"#config-%EC%84%A4%EC%A0%95\" aria-label=\"config 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Config 설정</h4>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"17274112680026320000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// security config\nhttp.addFilterBefore(customFilterSecurityInterceptor(), FilterSecurityInterceptor.class)\n\n@Bean\npublic FilterSecurityInterceptor customFilterSecurityInterceptor() throws Exception {\n\nFilterSecurityInterceptor filterSecurityInterceptor = new FilterSecurityInterceptor();\n\nfilterSecurityInterceptor.setSecurityMetadataSource(urlFilterInvocationSecurityMetadataSource());\nfilterSecurityInterceptor.setAccessDecisionManager(affirmativeBased()); // 인가 방식 종류 중 affirmativeBased 사용 - 가장 많이 사용하는 방식\nfilterSecurityInterceptor.setAuthenticationManager(authenticationManagerBean());\n\n    return filterSecurityInterceptor;\n}\n\nprivate AccessDecisionManager affirmativeBased() {\n    return new AffirmativeBased(getAccessDecisionVoters());\n}\n\nprivate List<AccessDecisionVoter<?>> getAccessDecisionVoters() {\n    return Arrays.asList(new RoleVoter());\n}\n\n@Bean\npublic FilterInvocationSecurityMetadataSource urlFilterInvocationSecurityMetadataSource() {\n    return new UrlFilterInvocationMetadataSource();\n}`, `17274112680026320000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"30\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// security config</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">http</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addFilterBefore</span><span class=\"mtk1\">(</span><span class=\"mtk11\">customFilterSecurityInterceptor</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">FilterSecurityInterceptor</span><span class=\"mtk1\">.</span><span class=\"mtk12\">class</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FilterSecurityInterceptor</span><span class=\"mtk1\"> </span><span class=\"mtk11\">customFilterSecurityInterceptor</span><span class=\"mtk1\">() throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">FilterSecurityInterceptor</span><span class=\"mtk1\"> </span><span class=\"mtk12\">filterSecurityInterceptor</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">FilterSecurityInterceptor</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">filterSecurityInterceptor</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setSecurityMetadataSource</span><span class=\"mtk1\">(</span><span class=\"mtk11\">urlFilterInvocationSecurityMetadataSource</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">filterSecurityInterceptor</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setAccessDecisionManager</span><span class=\"mtk1\">(</span><span class=\"mtk11\">affirmativeBased</span><span class=\"mtk1\">()); </span><span class=\"mtk3\">// 인가 방식 종류 중 affirmativeBased 사용 - 가장 많이 사용하는 방식</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">filterSecurityInterceptor</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setAuthenticationManager</span><span class=\"mtk1\">(</span><span class=\"mtk11\">authenticationManagerBean</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> filterSecurityInterceptor;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AccessDecisionManager</span><span class=\"mtk1\"> </span><span class=\"mtk11\">affirmativeBased</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AffirmativeBased</span><span class=\"mtk1\">(</span><span class=\"mtk11\">getAccessDecisionVoters</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">AccessDecisionVoter</span><span class=\"mtk1\">&lt;</span><span class=\"mtk15\">?</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk11\">getAccessDecisionVoters</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">Arrays</span><span class=\"mtk1\">.</span><span class=\"mtk11\">asList</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">RoleVoter</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FilterInvocationSecurityMetadataSource</span><span class=\"mtk1\"> </span><span class=\"mtk11\">urlFilterInvocationSecurityMetadataSource</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">UrlFilterInvocationMetadataSource</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ol>\n<li>\n<p>custom Interceptor가 먼저 동작하게 config 파일 설정</p>\n</li>\n<li>\n<p>customFilterSecurityInterceptor를 Bean으로 등록시킨다.</p>\n</li>\n</ol>\n<p>추가로 Bean으로 등록시키는 경우는 custom해서 작성한 객체 사용 시 Bean, 기존에 등록된 객체 사용 시 해당 객체를 꺼내와 return</p>\n<p>AccessDecisionManager 전략 중 affirmativeBased를 사용하는데 해당 설정은<br>\n<strong>url에 매칭되는 권한 리스트 중 1개만 존재해도 인가 해주는 전략</strong></p>\n<h3 id=\"requestmap-db-연동\" style=\"position:relative;\"><a href=\"#requestmap-db-%EC%97%B0%EB%8F%99\" aria-label=\"requestmap db 연동 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>requestMap DB 연동</h3>\n<h4 id=\"urlresourcesmapfactorybean-권한자원-정보를-resurcemap-생성\" style=\"position:relative;\"><a href=\"#urlresourcesmapfactorybean-%EA%B6%8C%ED%95%9C%EC%9E%90%EC%9B%90-%EC%A0%95%EB%B3%B4%EB%A5%BC-resurcemap-%EC%83%9D%EC%84%B1\" aria-label=\"urlresourcesmapfactorybean 권한자원 정보를 resurcemap 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UrlResourcesMapFactoryBean (권한/자원 정보를 ResurceMap 생성)</h4>\n<blockquote>\n<p>User정보를 DB로부터 가져온 권한/자원 정보를 ResurceMap만드는 구현체 (Bean으로 등록)</p>\n</blockquote>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"14065494591457739000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public class UrlResourcesMapFactoryBean implements FactoryBean<LinkedHashMap<RequestMatcher, List<ConfigAttribute>>> {\n\n    private SecurityResourceService securityResourceService;\n    private LinkedHashMap<RequestMatcher, List<ConfigAttribute>> resourceMap;\n\n    public void setSecurityResourceService(SecurityResourceService securityResourceService) {\n        this.securityResourceService = securityResourceService;\n    }\n\n    @Override\n    public LinkedHashMap<RequestMatcher, List<ConfigAttribute>> getObject() throws Exception {\n\n        if (resourceMap == null) {\n            init();\n        }\n\n        return resourceMap;\n    }\n\n    private void init() {\n        resourceMap = securityResourceService.getResourceList();\n    }\n\n    @Override\n    public Class<?> getObjectType() {\n        return LinkedHashMap.class;\n    }\n\n    @Override\n    public boolean isSingleton() {\n        return true;\n    }\n}\n`, `14065494591457739000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"31\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UrlResourcesMapFactoryBean</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FactoryBean</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt;&gt; {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityResourceService</span><span class=\"mtk1\"> </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk12\">resourceMap</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setSecurityResourceService</span><span class=\"mtk1\">(</span><span class=\"mtk10\">SecurityResourceService</span><span class=\"mtk1\"> </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\"> = securityResourceService;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk11\">getObject</span><span class=\"mtk1\">() </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Exception</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (resourceMap == </span><span class=\"mtk4\">null</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk11\">init</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> resourceMap;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">init</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        resourceMap = </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getResourceList</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Class</span><span class=\"mtk1\">&lt;</span><span class=\"mtk4\">?</span><span class=\"mtk1\">&gt; </span><span class=\"mtk11\">getObjectType</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">LinkedHashMap</span><span class=\"mtk1\">.</span><span class=\"mtk12\">class</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">boolean</span><span class=\"mtk1\"> </span><span class=\"mtk11\">isSingleton</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<ul>\n<li>&#x3C;LinkedHashMap&#x3C;RequestMatcher, List<ConfigAttribute>> 부분은 role - resource 정보를 불러오기 위해 사용</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"6648601276546251000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`requestMap.put(new AntPathRequestMatcher(&quot;/mypage&quot;), Arrays.asList(new SecurityConfig(&quot;ROLE_USER&quot;)));`, `6648601276546251000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"32\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk12\">requestMap</span><span class=\"mtk1\">.</span><span class=\"mtk11\">put</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AntPathRequestMatcher</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;/mypage&quot;</span><span class=\"mtk1\">), </span><span class=\"mtk12\">Arrays</span><span class=\"mtk1\">.</span><span class=\"mtk11\">asList</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">SecurityConfig</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;ROLE_USER&quot;</span><span class=\"mtk1\">)));</span></span></span></code></pre>\n<p>위와 같은 느낌으로</p>\n<p>즉, 해당 클래스의 역할은 DB로 부터 가져오는 Service객체를 생성해주고 정보를 가져와 FilterInvocationMetadataSource로 전달해주는 역할</p>\n<h3 id=\"resource를-가져오는-service를-생성\" style=\"position:relative;\"><a href=\"#resource%EB%A5%BC-%EA%B0%80%EC%A0%B8%EC%98%A4%EB%8A%94-service%EB%A5%BC-%EC%83%9D%EC%84%B1\" aria-label=\"resource를 가져오는 service를 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Resource를 가져오는 Service를 생성</h3>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"79372656261966150000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@RequiredArgsConstructor\npublic class SecurityResourceService {\n\n    private final ResourcesRepository resourcesRepository;\n    private final RoleResourceRepository roleResourceRepository;\n\n    public LinkedHashMap<RequestMatcher, List<ConfigAttribute>> getResourceList() {\n\n        LinkedHashMap<RequestMatcher, List<ConfigAttribute>> result = new LinkedHashMap<>();\n        List<Resource> resources = resourcesRepository.findAll();\n        resources.forEach(resource -> {\n            List<ConfigAttribute> configAttributes = new ArrayList<>();\n            Long resourceId = resource.getId();\n            List<RoleResource> roleResources = roleResourceRepository.findAllByResourceId(resourceId);\n            roleResources.forEach(roleResource -> {\n                configAttributes.add(new SecurityConfig(roleResource.getRole().getRoleName())); //ConfigAttribute 타입의 구현체인 SecurityConfig를 넣어준다.\n                result.put(new AntPathRequestMatcher(resource.getResourceName()), configAttributes);\n            });\n        });\n        return result;\n    }\n}`, `79372656261966150000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"33\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">RequiredArgsConstructor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityResourceService</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ResourcesRepository</span><span class=\"mtk1\"> </span><span class=\"mtk12\">resourcesRepository</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RoleResourceRepository</span><span class=\"mtk1\"> </span><span class=\"mtk12\">roleResourceRepository</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk11\">getResourceList</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk12\">result</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;&gt;();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Resource</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">resources</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">resourcesRepository</span><span class=\"mtk1\">.</span><span class=\"mtk11\">findAll</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">resources</span><span class=\"mtk1\">.</span><span class=\"mtk11\">forEach</span><span class=\"mtk1\">(resource </span><span class=\"mtk4\">-&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">configAttributes</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ArrayList</span><span class=\"mtk1\">&lt;&gt;();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">Long</span><span class=\"mtk1\"> </span><span class=\"mtk12\">resourceId</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">resource</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getId</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RoleResource</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">roleResources</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">roleResourceRepository</span><span class=\"mtk1\">.</span><span class=\"mtk11\">findAllByResourceId</span><span class=\"mtk1\">(resourceId);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">roleResources</span><span class=\"mtk1\">.</span><span class=\"mtk11\">forEach</span><span class=\"mtk1\">(roleResource </span><span class=\"mtk4\">-&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">configAttributes</span><span class=\"mtk1\">.</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">SecurityConfig</span><span class=\"mtk1\">(</span><span class=\"mtk12\">roleResource</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRole</span><span class=\"mtk1\">().</span><span class=\"mtk11\">getRoleName</span><span class=\"mtk1\">())); </span><span class=\"mtk3\">//ConfigAttribute 타입의 구현체인 SecurityConfig를 넣어준다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">result</span><span class=\"mtk1\">.</span><span class=\"mtk11\">put</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AntPathRequestMatcher</span><span class=\"mtk1\">(</span><span class=\"mtk12\">resource</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getResourceName</span><span class=\"mtk1\">()), configAttributes);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> result;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h4 id=\"config-파일-설정\" style=\"position:relative;\"><a href=\"#config-%ED%8C%8C%EC%9D%BC-%EC%84%A4%EC%A0%95\" aria-label=\"config 파일 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Config 파일 설정</h4>\n<p>작성한 service와 service객체를 만들어주는 Factory Bean을 Security Config 파일에 등록</p>\n<p>이전엔 UrlFilterInvocationSecurityMetadataSource를 그대로 사용했는데 urlResourcesMapFactoryBean을 사용하게 변경</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"79816473572367940000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`    @Bean\n    public UrlFilterInvocationSecurityMetadataSource urlFilterInvocationSecurityMetadataSource() throws Exception {\n        return new UrlFilterInvocationSecurityMetadataSource(urlResourcesMapFactoryBean().getObject(), securityResourceService);\n    }\n\n    private UrlResourcesMapFactoryBean urlResourcesMapFactoryBean() {\n\n        UrlResourcesMapFactoryBean urlResourcesMapFactoryBean = new UrlResourcesMapFactoryBean();\n        urlResourcesMapFactoryBean.setSecurityResourceService(securityResourceService);\n\n        return urlResourcesMapFactoryBean;\n    }\n}`, `79816473572367940000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"34\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UrlFilterInvocationSecurityMetadataSource</span><span class=\"mtk1\"> </span><span class=\"mtk11\">urlFilterInvocationSecurityMetadataSource</span><span class=\"mtk1\">() throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">UrlFilterInvocationSecurityMetadataSource</span><span class=\"mtk1\">(</span><span class=\"mtk11\">urlResourcesMapFactoryBean</span><span class=\"mtk1\">().</span><span class=\"mtk11\">getObject</span><span class=\"mtk1\">(), securityResourceService);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">UrlResourcesMapFactoryBean</span><span class=\"mtk1\"> </span><span class=\"mtk11\">urlResourcesMapFactoryBean</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">UrlResourcesMapFactoryBean</span><span class=\"mtk1\"> </span><span class=\"mtk12\">urlResourcesMapFactoryBean</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">UrlResourcesMapFactoryBean</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">urlResourcesMapFactoryBean</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setSecurityResourceService</span><span class=\"mtk1\">(securityResourceService);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> urlResourcesMapFactoryBean;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"db-접근-권한-실시간-반영\" style=\"position:relative;\"><a href=\"#db-%EC%A0%91%EA%B7%BC-%EA%B6%8C%ED%95%9C-%EC%8B%A4%EC%8B%9C%EA%B0%84-%EB%B0%98%EC%98%81\" aria-label=\"db 접근 권한 실시간 반영 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DB 접근 권한 실시간 반영</h3>\n<blockquote>\n<p>DB에 자원/권한 정보를 업데이트 시, 실시간으로 ResourceMap에 업데이트</p>\n</blockquote>\n<h4 id=\"urlfilterinvocationmetadatasource에-reload-메서드-추가\" style=\"position:relative;\"><a href=\"#urlfilterinvocationmetadatasource%EC%97%90-reload-%EB%A9%94%EC%84%9C%EB%93%9C-%EC%B6%94%EA%B0%80\" aria-label=\"urlfilterinvocationmetadatasource에 reload 메서드 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>UrlFilterInvocationMetadataSource에 reload 메서드 추가</h4>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"61494727154788630000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public void reload() {\n    LinkedHashMap<RequestMatcher, List<ConfigAttribute>> reloadedMap = securityResourceService.getResourceList();\n    Iterator<Map.Entry<RequestMatcher, List<ConfigAttribute>>> iterator = reloadedMap.entrySet().iterator();\n\n    requestMap.clear(); //기존 정보를 지움\n\n    while (iterator.hasNext()) {\n        Map.Entry<RequestMatcher, List<ConfigAttribute>> entry = iterator.next();\n        requestMap.put(entry.getKey(), entry.getValue());\n    }\n}`, `61494727154788630000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"35\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">reload</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk12\">reloadedMap</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getResourceList</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">Iterator</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Map</span><span class=\"mtk1\">.</span><span class=\"mtk10\">Entry</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt;&gt; </span><span class=\"mtk12\">iterator</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">reloadedMap</span><span class=\"mtk1\">.</span><span class=\"mtk11\">entrySet</span><span class=\"mtk1\">().</span><span class=\"mtk11\">iterator</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk12\">requestMap</span><span class=\"mtk1\">.</span><span class=\"mtk11\">clear</span><span class=\"mtk1\">(); </span><span class=\"mtk3\">//기존 정보를 지움</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">while</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">iterator</span><span class=\"mtk1\">.</span><span class=\"mtk11\">hasNext</span><span class=\"mtk1\">()) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">Map</span><span class=\"mtk1\">.</span><span class=\"mtk10\">Entry</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk12\">entry</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">iterator</span><span class=\"mtk1\">.</span><span class=\"mtk11\">next</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">requestMap</span><span class=\"mtk1\">.</span><span class=\"mtk11\">put</span><span class=\"mtk1\">(</span><span class=\"mtk12\">entry</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getKey</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">entry</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getValue</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h4 id=\"controller-수정\" style=\"position:relative;\"><a href=\"#controller-%EC%88%98%EC%A0%95\" aria-label=\"controller 수정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Controller 수정</h4>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"80121941684995050000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`\n    @PostMapping(value=&quot;/admin/resource/register&quot;)\n    public String createResource(RoleResourcesPo roleResourcesPo) throws Exception {\n        ModelMapper modelMapper = new ModelMapper();\n        RoleResourcesDto roleResourcesDto = modelMapper.map(roleResourcesPo, RoleResourcesDto.class);\n\n        resourcesService.createRoleAndResources(roleResourcesDto);\n\n        urlFilterInvocationMetadataSource.reload(); // 자원 생성 시 reload 추가\n\n        return &quot;redirect:/admin/resources&quot;;\n\n    }\n`, `80121941684995050000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"36\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">PostMapping</span><span class=\"mtk1\">(value=</span><span class=\"mtk8\">&quot;/admin/resource/register&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk11\">createResource</span><span class=\"mtk1\">(</span><span class=\"mtk10\">RoleResourcesPo</span><span class=\"mtk1\"> roleResourcesPo) throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">ModelMapper</span><span class=\"mtk1\"> </span><span class=\"mtk12\">modelMapper</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">ModelMapper</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">RoleResourcesDto</span><span class=\"mtk1\"> </span><span class=\"mtk12\">roleResourcesDto</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">modelMapper</span><span class=\"mtk1\">.</span><span class=\"mtk11\">map</span><span class=\"mtk1\">(roleResourcesPo, </span><span class=\"mtk12\">RoleResourcesDto</span><span class=\"mtk1\">.</span><span class=\"mtk12\">class</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">resourcesService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">createRoleAndResources</span><span class=\"mtk1\">(roleResourcesDto);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">urlFilterInvocationMetadataSource</span><span class=\"mtk1\">.</span><span class=\"mtk11\">reload</span><span class=\"mtk1\">(); </span><span class=\"mtk3\">// 자원 생성 시 reload 추가</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&quot;redirect:/admin/resources&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<p>자원 추가 시 urlFilterInvocationMetadataSource를 reload하는 구문을 추가한다.</p>\n<h3 id=\"허용-필터\" style=\"position:relative;\"><a href=\"#%ED%97%88%EC%9A%A9-%ED%95%84%ED%84%B0\" aria-label=\"허용 필터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>허용 필터</h3>\n<blockquote>\n<p>인증 및 권한심사, 허용 IP -> ACCESS_ABSTAIN return / 허용 x IP -> 즉시 예외 처리 해 자원 접근 거부를 할 필요가 없는 자원 (/, /home, login …) 들을 미리 설정해서 바로 리소스 접근이 가능하게 하는 필터</p>\n</blockquote>\n<p>인가 처리 과정</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"37\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">FilterSecurityInterceptor -&gt; AbstractSecurityInterceptor -&gt; List&lt;ConfigAttribute&gt; (null이 아닐 경우) -&gt; AccessDecisionManager</span></span></code></pre>\n<p>FilterSecurityInterceptor를 상속받아 구현한다.</p>\n<p>permitAllFilter라는 이름을 가진 구현체를 구현하는데</p>\n<p>url list (List<RequestMatcher>)를 읽고 설정 한 경로가 있으면 권한 심사 없이 통과하도록 <strong>null값을 리턴</strong>한다</p>\n<ol>\n<li>\n<p>FilterSecurityInterceptor를 상속받아 invoke함수 사용</p>\n</li>\n<li>\n<p>PermitAllFilter에서 객체 생성 시 url list를 받을 수 있게 생성자에서 requestMatchers에 대한 list를 생성</p>\n</li>\n<li>\n<p>url list를 검사 할 beforeInvocation 함수 작성</p>\n</li>\n<li>\n<p>이전 config 설정에서 FilterSecurityInterceptor를 사용한 부분을 PermitAllFilter를 사용하게 수정한다.</p>\n</li>\n<li>\n<p>PermitAllFilter에서 사용하게 될 url을 Config 파일에서 String 배열로 만들어 넣어준다.</p>\n</li>\n</ol>\n<p>(추후에 적용시킬 경우 DB로 불러와 적용시켜도 좋을 것 같다.)</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"15483206129763195000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public class PermitAllFilter extends FilterSecurityInterceptor {\n\n    private static final String FILTER_APPLIED = &quot;__spring_security_filterSecurityInterceptor_filterApplied&quot;;\n    private boolean observeOncePerRequest = true;\n\n    private List<RequestMatcher> permitAllRequestMatchers = new ArrayList<>();\n\n    public PermitAllFilter(String... permitAllResources) {\n        for (String resource : permitAllResources) {\n            permitAllRequestMatchers.add(new AntPathRequestMatcher(resource));\n        }\n    }\n\n    @Override\n    protected InterceptorStatusToken beforeInvocation(Object object) {\n\n        boolean permitAll = false;\n        HttpServletRequest request = ((FilterInvocation) object).getRequest();\n        for (RequestMatcher requestMatcher : permitAllRequestMatchers) {\n            if (requestMatcher.matches(request)) {\n                permitAll = true;\n                break;\n            }\n        }\n\n        if (permitAll) {\n            return null;\n        }\n\n        return super.beforeInvocation(object);\n    }\n\n    public void invoke(FilterInvocation fi) throws IOException, ServletException {\n        if ((fi.getRequest() != null)\n                && (fi.getRequest().getAttribute(FILTER_APPLIED) != null)\n                && observeOncePerRequest) {\n            fi.getChain().doFilter(fi.getRequest(), fi.getResponse());\n        } else {\n            if (fi.getRequest() != null && observeOncePerRequest) {\n                fi.getRequest().setAttribute(FILTER_APPLIED, Boolean.TRUE);\n            }\n\n            InterceptorStatusToken token = beforeInvocation(fi);\n\n            try {\n                fi.getChain().doFilter(fi.getRequest(), fi.getResponse());\n            } finally {\n                super.finallyInvocation(token);\n            }\n\n            super.afterInvocation(token, null);\n        }\n    }\n}`, `15483206129763195000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"38\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">PermitAllFilter</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FilterSecurityInterceptor</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk4\">static</span><span class=\"mtk1\"> </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">FILTER_APPLIED</span><span class=\"mtk1\"> = </span><span class=\"mtk8\">&quot;__spring_security_filterSecurityInterceptor_filterApplied&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">boolean</span><span class=\"mtk1\"> </span><span class=\"mtk12\">observeOncePerRequest</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">true</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">permitAllRequestMatchers</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ArrayList</span><span class=\"mtk1\">&lt;&gt;();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk11\">PermitAllFilter</span><span class=\"mtk1\">(</span><span class=\"mtk10\">String</span><span class=\"mtk1\">... </span><span class=\"mtk12\">permitAllResources</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">resource</span><span class=\"mtk1\"> </span><span class=\"mtk15\">:</span><span class=\"mtk1\"> permitAllResources) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">permitAllRequestMatchers</span><span class=\"mtk1\">.</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AntPathRequestMatcher</span><span class=\"mtk1\">(resource));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">protected</span><span class=\"mtk1\"> </span><span class=\"mtk10\">InterceptorStatusToken</span><span class=\"mtk1\"> </span><span class=\"mtk11\">beforeInvocation</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk12\">object</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">boolean</span><span class=\"mtk1\"> </span><span class=\"mtk12\">permitAll</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">false</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">HttpServletRequest</span><span class=\"mtk1\"> </span><span class=\"mtk12\">request</span><span class=\"mtk1\"> = ((FilterInvocation) object).</span><span class=\"mtk11\">getRequest</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">RequestMatcher</span><span class=\"mtk1\"> </span><span class=\"mtk12\">requestMatcher</span><span class=\"mtk1\"> </span><span class=\"mtk15\">:</span><span class=\"mtk1\"> permitAllRequestMatchers) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">requestMatcher</span><span class=\"mtk1\">.</span><span class=\"mtk11\">matches</span><span class=\"mtk1\">(request)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                permitAll = </span><span class=\"mtk4\">true</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">break</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (permitAll) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">null</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">super</span><span class=\"mtk1\">.</span><span class=\"mtk11\">beforeInvocation</span><span class=\"mtk1\">(object);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">invoke</span><span class=\"mtk1\">(</span><span class=\"mtk10\">FilterInvocation</span><span class=\"mtk1\"> </span><span class=\"mtk12\">fi</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IOException</span><span class=\"mtk1\">, </span><span class=\"mtk10\">ServletException</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> ((</span><span class=\"mtk12\">fi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRequest</span><span class=\"mtk1\">() != </span><span class=\"mtk4\">null</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                &amp;&amp; (</span><span class=\"mtk12\">fi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRequest</span><span class=\"mtk1\">().</span><span class=\"mtk11\">getAttribute</span><span class=\"mtk1\">(FILTER_APPLIED) != </span><span class=\"mtk4\">null</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                &amp;&amp; observeOncePerRequest) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">fi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getChain</span><span class=\"mtk1\">().</span><span class=\"mtk11\">doFilter</span><span class=\"mtk1\">(</span><span class=\"mtk12\">fi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRequest</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">fi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getResponse</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">fi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRequest</span><span class=\"mtk1\">() != </span><span class=\"mtk4\">null</span><span class=\"mtk1\"> &amp;&amp; observeOncePerRequest) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">fi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRequest</span><span class=\"mtk1\">().</span><span class=\"mtk11\">setAttribute</span><span class=\"mtk1\">(FILTER_APPLIED, </span><span class=\"mtk12\">Boolean</span><span class=\"mtk1\">.</span><span class=\"mtk12\">TRUE</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk10\">InterceptorStatusToken</span><span class=\"mtk1\"> </span><span class=\"mtk12\">token</span><span class=\"mtk1\"> = </span><span class=\"mtk11\">beforeInvocation</span><span class=\"mtk1\">(fi);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">try</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk12\">fi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getChain</span><span class=\"mtk1\">().</span><span class=\"mtk11\">doFilter</span><span class=\"mtk1\">(</span><span class=\"mtk12\">fi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRequest</span><span class=\"mtk1\">(), </span><span class=\"mtk12\">fi</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getResponse</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            } </span><span class=\"mtk15\">finally</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk4\">super</span><span class=\"mtk1\">.</span><span class=\"mtk11\">finallyInvocation</span><span class=\"mtk1\">(token);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk4\">super</span><span class=\"mtk1\">.</span><span class=\"mtk11\">afterInvocation</span><span class=\"mtk1\">(token, </span><span class=\"mtk4\">null</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3 id=\"계층-권한-적용\" style=\"position:relative;\"><a href=\"#%EA%B3%84%EC%B8%B5-%EA%B6%8C%ED%95%9C-%EC%A0%81%EC%9A%A9\" aria-label=\"계층 권한 적용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>계층 권한 적용</h3>\n<blockquote>\n<p>RoleHierarchyService를 만들어 Config에 적용시킨다</p>\n</blockquote>\n<ol>\n<li>entity, repository, Service 구현 RoleHierarchyService 에서 Spring security에서 지정한 규칙대로 String으로 반환</li>\n</ol>\n<p><a href=\"https://docs.spring.io/spring-security/reference/servlet/authorization/architecture.html#authz-hierarchical-roles\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hierarchical Roles - Spring security document</a></p>\n<ol start=\"2\">\n<li>getAccessDecisionVoters에서 기본 RoleVoter를 사용하던 부분을 RoleHierarchyVoter가 설정되게 변경</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"50377314271570354000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// entity\n@Entity\n@Table(name = &quot;ROLE_HIERARCHY&quot;)\n@AllArgsConstructor\n@NoArgsConstructor\n@Getter\n@Setter\n@Builder\npublic class RoleHierarchy implements Serializable {\n\n    @Id\n    @GeneratedValue\n    private Long id;\n\n    @Column(name = &quot;child_name&quot;)\n    private String childName;\n\n    @ManyToOne(cascade = {CascadeType.ALL}, fetch = FetchType.LAZY)\n    @JoinColumn(name = &quot;parent_name&quot;, referencedColumnName = &quot;child_name&quot;)\n    private RoleHierarchy parentName;\n\n    @OneToMany(mappedBy = &quot;parentName&quot;, cascade = {CascadeType.ALL})\n    private Set<RoleHierarchy> roleHierarchy = new HashSet<RoleHierarchy>();\n}\n\n// repository\npublic interface ResourcesRepository extends JpaRepository<Resources, Long> {\n\n    Resources findByResourceNameAndHttpMethod(String resourceName, String httpMethod);\n\n    @Query(&quot;select r from Resources r join fetch r.roleSet where r.resourceType = 'url' order by r.orderNum desc&quot;)\n    List<Resources> findAllResources();\n\n    @Query(&quot;select r from Resources r join fetch r.roleSet where r.resourceType = 'method' order by r.orderNum desc&quot;)\n    List<Resources> findAllMethodResources();\n\n    @Query(&quot;select r from Resources r join fetch r.roleSet where r.resourceType = 'pointcut' order by r.orderNum desc&quot;)\n    List<Resources> findAllPointcutResources();\n}\n\n// Service\n\n    @Bean\n    public PermitAllFilter customFilterSecurityInterceptor() throws Exception {\n\n        PermitAllFilter permitAllFilter = new PermitAllFilter(permitAllResources);\n        permitAllFilter.setSecurityMetadataSource(urlFilterInvocationSecurityMetadataSource());\n        permitAllFilter.setAccessDecisionManager(affirmativeBased());\n        permitAllFilter.setAuthenticationManager(authenticationManagerBean());\n        return permitAllFilter;\n    }\n\n    private AccessDecisionManager affirmativeBased() {\n        AffirmativeBased affirmativeBased = new AffirmativeBased(getAccessDecisionVoters());\n        return affirmativeBased;\n    }\n\n    private List<AccessDecisionVoter<?>> getAccessDecisionVoters() {\n\n        List<AccessDecisionVoter<? extends Object>> accessDecisionVoters = new ArrayList<>();\n        accessDecisionVoters.add(roleVoter());\n\n        return accessDecisionVoters;\n    }\n\n    @Bean\n    public AccessDecisionVoter<? extends Object> roleVoter() {\n\n        RoleHierarchyVoter roleHierarchyVoter = new RoleHierarchyVoter(roleHierarchy());\n        return roleHierarchyVoter;\n    }\n\n    @Bean\n    public RoleHierarchyImpl roleHierarchy() {\n        RoleHierarchyImpl roleHierarchy = new RoleHierarchyImpl();\n        return roleHierarchy;\n    }`, `50377314271570354000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"39\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// entity</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Entity</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Table</span><span class=\"mtk1\">(name = </span><span class=\"mtk8\">&quot;ROLE_HIERARCHY&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">AllArgsConstructor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">NoArgsConstructor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Getter</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Setter</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Builder</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RoleHierarchy</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Serializable</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Id</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">GeneratedValue</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Long</span><span class=\"mtk1\"> </span><span class=\"mtk12\">id</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Column</span><span class=\"mtk1\">(name = </span><span class=\"mtk8\">&quot;child_name&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">childName</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">ManyToOne</span><span class=\"mtk1\">(cascade = {</span><span class=\"mtk12\">CascadeType</span><span class=\"mtk1\">.</span><span class=\"mtk12\">ALL</span><span class=\"mtk1\">}, fetch = </span><span class=\"mtk12\">FetchType</span><span class=\"mtk1\">.</span><span class=\"mtk12\">LAZY</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">JoinColumn</span><span class=\"mtk1\">(name = </span><span class=\"mtk8\">&quot;parent_name&quot;</span><span class=\"mtk1\">, referencedColumnName = </span><span class=\"mtk8\">&quot;child_name&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RoleHierarchy</span><span class=\"mtk1\"> </span><span class=\"mtk12\">parentName</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">OneToMany</span><span class=\"mtk1\">(mappedBy = </span><span class=\"mtk8\">&quot;parentName&quot;</span><span class=\"mtk1\">, cascade = {</span><span class=\"mtk12\">CascadeType</span><span class=\"mtk1\">.</span><span class=\"mtk12\">ALL</span><span class=\"mtk1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Set</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RoleHierarchy</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">roleHierarchy</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">HashSet</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">RoleHierarchy</span><span class=\"mtk1\">&gt;();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// repository</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">interface</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ResourcesRepository</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">JpaRepository</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Resources</span><span class=\"mtk1\">, </span><span class=\"mtk10\">Long</span><span class=\"mtk1\">&gt; {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">Resources</span><span class=\"mtk1\"> </span><span class=\"mtk11\">findByResourceNameAndHttpMethod</span><span class=\"mtk1\">(</span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">resourceName</span><span class=\"mtk1\">, </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">httpMethod</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Query</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;select r from Resources r join fetch r.roleSet where r.resourceType = &#39;url&#39; order by r.orderNum desc&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Resources</span><span class=\"mtk1\">&gt; </span><span class=\"mtk11\">findAllResources</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Query</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;select r from Resources r join fetch r.roleSet where r.resourceType = &#39;method&#39; order by r.orderNum desc&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Resources</span><span class=\"mtk1\">&gt; </span><span class=\"mtk11\">findAllMethodResources</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Query</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;select r from Resources r join fetch r.roleSet where r.resourceType = &#39;pointcut&#39; order by r.orderNum desc&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">Resources</span><span class=\"mtk1\">&gt; </span><span class=\"mtk11\">findAllPointcutResources</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// Service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">PermitAllFilter</span><span class=\"mtk1\"> </span><span class=\"mtk11\">customFilterSecurityInterceptor</span><span class=\"mtk1\">() throws Exception {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">PermitAllFilter</span><span class=\"mtk1\"> </span><span class=\"mtk12\">permitAllFilter</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">PermitAllFilter</span><span class=\"mtk1\">(permitAllResources);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">permitAllFilter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setSecurityMetadataSource</span><span class=\"mtk1\">(</span><span class=\"mtk11\">urlFilterInvocationSecurityMetadataSource</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">permitAllFilter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setAccessDecisionManager</span><span class=\"mtk1\">(</span><span class=\"mtk11\">affirmativeBased</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">permitAllFilter</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setAuthenticationManager</span><span class=\"mtk1\">(</span><span class=\"mtk11\">authenticationManagerBean</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> permitAllFilter;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AccessDecisionManager</span><span class=\"mtk1\"> </span><span class=\"mtk11\">affirmativeBased</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">AffirmativeBased</span><span class=\"mtk1\"> </span><span class=\"mtk12\">affirmativeBased</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AffirmativeBased</span><span class=\"mtk1\">(</span><span class=\"mtk11\">getAccessDecisionVoters</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> affirmativeBased;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">AccessDecisionVoter</span><span class=\"mtk1\">&lt;</span><span class=\"mtk15\">?</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk11\">getAccessDecisionVoters</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">AccessDecisionVoter</span><span class=\"mtk1\">&lt;</span><span class=\"mtk4\">?</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Object</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk12\">accessDecisionVoters</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ArrayList</span><span class=\"mtk1\">&lt;&gt;();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">accessDecisionVoters</span><span class=\"mtk1\">.</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk11\">roleVoter</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> accessDecisionVoters;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AccessDecisionVoter</span><span class=\"mtk1\">&lt;</span><span class=\"mtk15\">?</span><span class=\"mtk1\"> extends Object&gt; </span><span class=\"mtk11\">roleVoter</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">RoleHierarchyVoter</span><span class=\"mtk1\"> </span><span class=\"mtk12\">roleHierarchyVoter</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">RoleHierarchyVoter</span><span class=\"mtk1\">(</span><span class=\"mtk11\">roleHierarchy</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> roleHierarchyVoter;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RoleHierarchyImpl</span><span class=\"mtk1\"> </span><span class=\"mtk11\">roleHierarchy</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">RoleHierarchyImpl</span><span class=\"mtk1\"> </span><span class=\"mtk12\">roleHierarchy</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">RoleHierarchyImpl</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> roleHierarchy;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span></code></pre>\n<p>추가로 config에서 사용되는 RoleHierarchy를 전달받아야 하는데 강의에서는 ApplicationRunner의 run메소드를 이용해서 RoleHierarchy객체를 전달한다.</p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"42717692724443260000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@Component\npublic class SecurityInitializer implements ApplicationRunner {\n\n    @Autowired\n    private RoleHierarchyService roleHierarchyService;\n\n    @Autowired\n    private RoleHierarchyImpl roleHierarchy;\n\n    @Override\n    public void run(ApplicationArguments args) throws Exception {\n        String allHierarchy = roleHierarchyService.findAllHierarchy();\n        roleHierarchy.setHierarchy(allHierarchy);\n    }\n}`, `42717692724443260000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"40\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Component</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityInitializer</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ApplicationRunner</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Autowired</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RoleHierarchyService</span><span class=\"mtk1\"> </span><span class=\"mtk12\">roleHierarchyService</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Autowired</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">RoleHierarchyImpl</span><span class=\"mtk1\"> </span><span class=\"mtk12\">roleHierarchy</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">run</span><span class=\"mtk1\">(</span><span class=\"mtk10\">ApplicationArguments</span><span class=\"mtk1\"> </span><span class=\"mtk12\">args</span><span class=\"mtk1\">) </span><span class=\"mtk4\">throws</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Exception</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">allHierarchy</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">roleHierarchyService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">findAllHierarchy</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">roleHierarchy</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setHierarchy</span><span class=\"mtk1\">(allHierarchy);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<!-- TODO: 나중에 이거 해볼 때 Security server경로 admin -->\n<p>config에서도 Bean으로 주입받아도 사용 가능 (어느 타이밍에 하던 상관x)</p>\n<h3 id=\"ip-접속-제한\" style=\"position:relative;\"><a href=\"#ip-%EC%A0%91%EC%86%8D-%EC%A0%9C%ED%95%9C\" aria-label=\"ip 접속 제한 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IP 접속 제한</h3>\n<ul>\n<li>Voter에 의한 인가 처리는 AccessDecisionManager가 처리</li>\n<li>추가적인 Voter 구현체로 <strong>IpAddressVoter</strong> 구현</li>\n</ul>\n<h4 id=\"ipaddressvoter\" style=\"position:relative;\"><a href=\"#ipaddressvoter\" aria-label=\"ipaddressvoter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IPAddressVoter</h4>\n<ul>\n<li>특정 IP만 접근이 가능하도록 심의하는 Voter</li>\n<li>가장 먼저 심사, 허용 IP -> ACCESS_ABSTAIN return / 허용 x IP -> 즉시 예외 처리 해 자원 접근 거부</li>\n<li>ACCESS_ABSTAIN로 리턴 하면 일단 해당 Voter에서는 인가를 승인하되, 다음 Voter로 승인을 보류</li>\n<li>ACCESS_DENIED로 넘기면 다른 Voter가 판단할 수 있으므로 exception처리</li>\n</ul>\n<ol>\n<li>테이블 추가</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"83397176527691370000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@Entity\n@Table(name = &quot;ACCESS_IP&quot;)\n@Data\n@EqualsAndHashCode(of = &quot;id&quot;)\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\npublic class AccessIp implements Serializable {\n\n    @Id\n    @GeneratedValue\n    @Column(name = &quot;IP_ID&quot;, unique = true, nullable = false)\n    private Long id;\n\n    @Column(name = &quot;IP_ADDRESS&quot;, nullable = false)\n    private String ipAddress;\n\n}`, `83397176527691370000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"41\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Entity</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Table</span><span class=\"mtk1\">(name = </span><span class=\"mtk8\">&quot;ACCESS_IP&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">EqualsAndHashCode</span><span class=\"mtk1\">(of = </span><span class=\"mtk8\">&quot;id&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Builder</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">NoArgsConstructor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">AllArgsConstructor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AccessIp</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Serializable</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Id</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">GeneratedValue</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Column</span><span class=\"mtk1\">(name = </span><span class=\"mtk8\">&quot;IP_ID&quot;</span><span class=\"mtk1\">, unique = </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, nullable = </span><span class=\"mtk4\">false</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Long</span><span class=\"mtk1\"> </span><span class=\"mtk12\">id</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Column</span><span class=\"mtk1\">(name = </span><span class=\"mtk8\">&quot;IP_ADDRESS&quot;</span><span class=\"mtk1\">, nullable = </span><span class=\"mtk4\">false</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">ipAddress</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ol start=\"2\">\n<li>IpAddressVoter 작성</li>\n</ol>\n<ul>\n<li>AccessDecisionVoter를 상속받는 구현체 작성</li>\n<li>authentication 객체에서 IP에 대한 정보를 꺼내와 IP 조회 로직 구현</li>\n</ul>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"18132836665528562000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`@RequiredArgsConstructor\npublic class IpAddressVoter implements AccessDecisionVoter {\n\n    private final SecurityResourceService securityResourceService;\n\n    @Override\n    public boolean supports(ConfigAttribute configAttribute) {\n        return true;\n    }\n\n    @Override\n    public boolean supports(Class aClass) {\n        return true;\n    }\n\n    @Override\n    public int vote(Authentication authentication, Object o, Collection collection) {\n\n        //authentication.getDetails에서 사용자 정보를 얻을 수 있으며, WebAuthenticationDetails 객체로 캐스팅 해줘야 사용 가능\n        WebAuthenticationDetails details = (WebAuthenticationDetails) authentication.getDetails();\n        String remoteAddress = details.getRemoteAddress();\n\n        List<String> accessIpList = securityResourceService.getAccessIpList();\n\n        for (String accessIp : accessIpList) {\n            if (accessIp.equals(remoteAddress)) {\n                return ACCESS_ABSTAIN;\n            }\n        }\n\n        throw new AccessDeniedException(&quot;Invalid Ip Address&quot;);\n\n    }\n}​`, `18132836665528562000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"42\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">RequiredArgsConstructor</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">IpAddressVoter</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">AccessDecisionVoter</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk4\">final</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityResourceService</span><span class=\"mtk1\"> </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">boolean</span><span class=\"mtk1\"> </span><span class=\"mtk11\">supports</span><span class=\"mtk1\">(</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\"> </span><span class=\"mtk12\">configAttribute</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">boolean</span><span class=\"mtk1\"> </span><span class=\"mtk11\">supports</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Class</span><span class=\"mtk1\"> </span><span class=\"mtk12\">aClass</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">int</span><span class=\"mtk1\"> </span><span class=\"mtk11\">vote</span><span class=\"mtk1\">(</span><span class=\"mtk10\">Authentication</span><span class=\"mtk1\"> </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">, </span><span class=\"mtk10\">Object</span><span class=\"mtk1\"> </span><span class=\"mtk12\">o</span><span class=\"mtk1\">, </span><span class=\"mtk10\">Collection</span><span class=\"mtk1\"> </span><span class=\"mtk12\">collection</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\">//authentication.getDetails에서 사용자 정보를 얻을 수 있으며, WebAuthenticationDetails 객체로 캐스팅 해줘야 사용 가능</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">WebAuthenticationDetails</span><span class=\"mtk1\"> </span><span class=\"mtk12\">details</span><span class=\"mtk1\"> = (WebAuthenticationDetails) </span><span class=\"mtk12\">authentication</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getDetails</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">remoteAddress</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">details</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getRemoteAddress</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">String</span><span class=\"mtk1\">&gt; </span><span class=\"mtk12\">accessIpList</span><span class=\"mtk1\"> = </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getAccessIpList</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">for</span><span class=\"mtk1\"> (</span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">accessIp</span><span class=\"mtk1\"> </span><span class=\"mtk15\">:</span><span class=\"mtk1\"> accessIpList) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk12\">accessIp</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equals</span><span class=\"mtk1\">(remoteAddress)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">                </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> ACCESS_ABSTAIN;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">throw</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">AccessDeniedException</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;Invalid Ip Address&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}​</span></span></span></code></pre>\n<ol start=\"3\">\n<li>Security Config 추가</li>\n</ol>\n<p>인가 결정을 보류하는 로직이 있기 때문에 <strong>반드시 roleVoter 앞에 위치</strong></p>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"9085058250118295000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`private List<AccessDecisionVoter<?>> getAccessDecisionVoters() {\n        List<AccessDecisionVoter<? extends Object>> accessDecisionVoters = new ArrayList<>();\n        accessDecisionVoters.add(new IpAddressVoter(securityResourceService));\n        accessDecisionVoters.add(roleVoter());\n\n    return accessDecisionVoters;\n}`, `9085058250118295000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"43\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">AccessDecisionVoter</span><span class=\"mtk1\">&lt;</span><span class=\"mtk15\">?</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk11\">getAccessDecisionVoters</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">AccessDecisionVoter</span><span class=\"mtk1\">&lt;</span><span class=\"mtk4\">?</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Object</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk12\">accessDecisionVoters</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">ArrayList</span><span class=\"mtk1\">&lt;&gt;();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">accessDecisionVoters</span><span class=\"mtk1\">.</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">IpAddressVoter</span><span class=\"mtk1\">(securityResourceService));</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">accessDecisionVoters</span><span class=\"mtk1\">.</span><span class=\"mtk11\">add</span><span class=\"mtk1\">(</span><span class=\"mtk11\">roleVoter</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> accessDecisionVoters;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h2 id=\"method-방식-인가-처리\" style=\"position:relative;\"><a href=\"#method-%EB%B0%A9%EC%8B%9D-%EC%9D%B8%EA%B0%80-%EC%B2%98%EB%A6%AC\" aria-label=\"method 방식 인가 처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Method 방식 인가 처리</h2>\n<blockquote>\n<p>URL별 인가처리가 아닌 <strong>메소드 단위로 인가처리 적용</strong> 가능</p>\n</blockquote>\n<ul>\n<li>AOP기반으로 동작 (프록시와 어드바이스)</li>\n<li>설정 방식 2가지 - 어노테이션 기반, 맵 기반(DB와 연동)</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dc730ce4461827476d9a106b44f336ff/3b90c/Method1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.96932515337423%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABZUlEQVR42m2P3U7iUBSF+zxc8AJc8LjGMZnRaNLK34R4YaSCYWipyQzQ06KAVkT7S1v4zDnRyYwzO1k5a6+91s7ZWhzHfEaapgRBgG3bOI7DaDTCsizF5StnSZLwv6z2WQjDEFm6rlOpVKhWq9RqNer1uuJSa7fbyiO9/yyMoog/EYYRSZKyWCw4P29gGIZa0Ol8R9cNGo0mq9VK/VB6w7/yMVqRp5R5xq7YUkrkGXkmz074qLIs2e/3v3s5y7OEMn/PvEPq2vDnPf3bOddjj57t0rOF6v2HFwYfujXDHLuYtmBw66uZac24+jHhejSlPxaYlssyeEFr9QVfuw5HrSGHjYHiJxcO1uwRw5xxdjnhsHnDl/aQs8tf6L0pjremdTXhpDPk4LjLt+aA0+4YsdygvW7WCHfK3Bfcz308d6qwXgfsypxtluB7guXijmKbUuSZOm1XFjw/P+F5grnvEUchWZbyBgSI9ekrefzJAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/dc730ce4461827476d9a106b44f336ff/a81b5/Method1.webp 163w,\n/static/dc730ce4461827476d9a106b44f336ff/da3ef/Method1.webp 325w,\n/static/dc730ce4461827476d9a106b44f336ff/309d5/Method1.webp 650w,\n/static/dc730ce4461827476d9a106b44f336ff/78344/Method1.webp 975w,\n/static/dc730ce4461827476d9a106b44f336ff/bdb72/Method1.webp 1300w,\n/static/dc730ce4461827476d9a106b44f336ff/fd888/Method1.webp 2482w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/dc730ce4461827476d9a106b44f336ff/5e043/Method1.png 163w,\n/static/dc730ce4461827476d9a106b44f336ff/e5cc6/Method1.png 325w,\n/static/dc730ce4461827476d9a106b44f336ff/663f3/Method1.png 650w,\n/static/dc730ce4461827476d9a106b44f336ff/d880f/Method1.png 975w,\n/static/dc730ce4461827476d9a106b44f336ff/4c573/Method1.png 1300w,\n/static/dc730ce4461827476d9a106b44f336ff/3b90c/Method1.png 2482w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/dc730ce4461827476d9a106b44f336ff/663f3/Method1.png\"\n            alt=\"Method1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span><br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/69c0d44a4e0df0a5f3ff9a62d2355863/1bc59/Method2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.558282208588956%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACFElEQVR42j2SX08TQRTF9+v5QfwCPpiggK8kRB9MNMoThIaURKBEwIpGC4LVQMQEaqHgtrtbupTtdru7M7O7/cPPdEq8ycnczD13TubkGJ7nYZomruvSaDRwHIf2rYdM+0gpkFJqKCmJZILtOLitFrZt670xfwwhJlwjimO63S5hGNLr9Wi2XKzLKlH9lFgqpBCaHAtJXD+lUatqwTHX932CIND74l7c6GcJg0GmkaUJKs0QfpusdcG4lBSkaar74U0NFfpk/QFZmjHsjxhkQ32mKtWPGjsHFVbWPpHbKHFW9yhsrPPk6TRz88+ZnX2G6waUy8dMTU0xN/+C6ZkZFt4scGmfs3mQZ3VnmfXSCmfmL9Ikw/hda/Hu/Rc+7B1z3RH8KH9ndTXP1tY2+XwO09zn6GibxaUlNjcL5HLL7H7cxfWa/Kx8Y62YZ//kM5ZroqTCCHwPs1ah2bhCRCHJ/ffGNei7NK3HtN2XwOj//XA4RMSCsBtRv7TptLtIobTXRi+MOTy/5Y/T1X6FUYSUMVeWR2HPoVgOKJZ9CiULu+WjZEykOZJOcMuJdci1ZyOlmnjodno8XKry9qsNA0UYC7JUUWt0eLVWZblYY3G7xuv1c6xWoGdxHDPIRlScYx4VHlC6KDDKIBYRxljpphPQ7YUoNcmcEJI0VUDK3SiBu1T3SaL0bJJLRRSHWDd/CUIfpZSOzT/XIIvr1099rgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/69c0d44a4e0df0a5f3ff9a62d2355863/a81b5/Method2.webp 163w,\n/static/69c0d44a4e0df0a5f3ff9a62d2355863/da3ef/Method2.webp 325w,\n/static/69c0d44a4e0df0a5f3ff9a62d2355863/309d5/Method2.webp 650w,\n/static/69c0d44a4e0df0a5f3ff9a62d2355863/78344/Method2.webp 975w,\n/static/69c0d44a4e0df0a5f3ff9a62d2355863/bdb72/Method2.webp 1300w,\n/static/69c0d44a4e0df0a5f3ff9a62d2355863/38072/Method2.webp 2476w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/69c0d44a4e0df0a5f3ff9a62d2355863/5e043/Method2.png 163w,\n/static/69c0d44a4e0df0a5f3ff9a62d2355863/e5cc6/Method2.png 325w,\n/static/69c0d44a4e0df0a5f3ff9a62d2355863/663f3/Method2.png 650w,\n/static/69c0d44a4e0df0a5f3ff9a62d2355863/d880f/Method2.png 975w,\n/static/69c0d44a4e0df0a5f3ff9a62d2355863/4c573/Method2.png 1300w,\n/static/69c0d44a4e0df0a5f3ff9a62d2355863/1bc59/Method2.png 2476w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/69c0d44a4e0df0a5f3ff9a62d2355863/663f3/Method2.png\"\n            alt=\"Method2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"동작-방식\" style=\"position:relative;\"><a href=\"#%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D\" aria-label=\"동작 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>동작 방식</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/11d73dede4a096a1ea8bd851e9ad9cfb/617a2/MethodAuthenticationArchitecture.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.44171779141104%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABDElEQVR42qVSB4rEQAzL//+YkN5771pk8DIXcnBwBjHNtix7rPu+MU0TxnGUlVA7zxPXdf2AaTwz3jSLQVEUwXEcBEGANE3Fcd93dF2HsixRVRXquhZSJVnXVe75Ps/zN7m1LAuKokCWZcjzHE3T4DgObNuGtm2FhIRJksiZChjDved5CMNQ9oxhUqmQDgRZCZWm1ZCZIAn9uJqSFZKQ0vq+h+/7iONYAnj3dB6GQfzYBlbJMwnNZJKQTHqhDm/GN8oitHLTNLFIZnWu68K2bemnWZnizZ5ypUJOjpNigymZQ6HsZzIdBGUTnOwbsaUB2jdlfhrfVLJO9M0sdeafYqN/k/dX+ybU7/DfhB+0Jl3rzuAp0wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/11d73dede4a096a1ea8bd851e9ad9cfb/a81b5/MethodAuthenticationArchitecture.webp 163w,\n/static/11d73dede4a096a1ea8bd851e9ad9cfb/da3ef/MethodAuthenticationArchitecture.webp 325w,\n/static/11d73dede4a096a1ea8bd851e9ad9cfb/309d5/MethodAuthenticationArchitecture.webp 650w,\n/static/11d73dede4a096a1ea8bd851e9ad9cfb/78344/MethodAuthenticationArchitecture.webp 975w,\n/static/11d73dede4a096a1ea8bd851e9ad9cfb/bdb72/MethodAuthenticationArchitecture.webp 1300w,\n/static/11d73dede4a096a1ea8bd851e9ad9cfb/90d1c/MethodAuthenticationArchitecture.webp 1728w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/11d73dede4a096a1ea8bd851e9ad9cfb/5e043/MethodAuthenticationArchitecture.png 163w,\n/static/11d73dede4a096a1ea8bd851e9ad9cfb/e5cc6/MethodAuthenticationArchitecture.png 325w,\n/static/11d73dede4a096a1ea8bd851e9ad9cfb/663f3/MethodAuthenticationArchitecture.png 650w,\n/static/11d73dede4a096a1ea8bd851e9ad9cfb/d880f/MethodAuthenticationArchitecture.png 975w,\n/static/11d73dede4a096a1ea8bd851e9ad9cfb/4c573/MethodAuthenticationArchitecture.png 1300w,\n/static/11d73dede4a096a1ea8bd851e9ad9cfb/617a2/MethodAuthenticationArchitecture.png 1728w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/11d73dede4a096a1ea8bd851e9ad9cfb/663f3/MethodAuthenticationArchitecture.png\"\n            alt=\"MethodAuthenticationArchitecture\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ul>\n<li>URL 방식은 Filter가 가로채서 요청 처리</li>\n<li>Proxy객체에 등록된 Advise가 동작해 요청 처리</li>\n</ul>\n<h3 id=\"관련-어노테이션\" style=\"position:relative;\"><a href=\"#%EA%B4%80%EB%A0%A8-%EC%96%B4%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98\" aria-label=\"관련 어노테이션 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>관련 어노테이션</h3>\n<h4 id=\"preauthorize-postauthorize\" style=\"position:relative;\"><a href=\"#preauthorize-postauthorize\" aria-label=\"preauthorize postauthorize permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@PreAuthorize, @PostAuthorize</h4>\n<ul>\n<li>SpEL(Spring Expression Language) 지원</li>\n<li>@PreAuthorize(“hasRole(‘ROLE_USER’)and(#account.username == principal.username)”) 같이 작성 가능</li>\n<li>PrePostAnnotationSecurityMetadataSource가 처리</li>\n</ul>\n<h4 id=\"secured-rolesallowed\" style=\"position:relative;\"><a href=\"#secured-rolesallowed\" aria-label=\"secured rolesallowed permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@Secured, @RolesAllowed</h4>\n<ul>\n<li>SpEL을 지원X</li>\n<li>@Secured(“ROLE_USER”), @RolesAllowed(“ROLE_USER”) 같이 작성 가능</li>\n<li>SecuredAnnotationSecurityMetadataSource, Jsr250MethodSecurityMetadataSource가 처리</li>\n</ul>\n<h4 id=\"enableglobalmethodsecurity\" style=\"position:relative;\"><a href=\"#enableglobalmethodsecurity\" aria-label=\"enableglobalmethodsecurity permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@EnableGlobalMethodSecurity</h4>\n<ul>\n<li>메서드 방식의 인가 처리가 가능하게 해준다.</li>\n<li>설정 클래스에 선언을 해야 함</li>\n<li>prePostEnabled = true, securedEnabled = true 등과 같이 속성값을 반드시 true로 변경 해야 해당 어노테이션 사용 가능</li>\n</ul>\n<p>PrePostAnnotationSecurityMetadataSource 등은 앞서 살펴본 MethodSecurityMetadataSource 객체를 상속하고 있다.</p>\n<h3 id=\"적용-방법\" style=\"position:relative;\"><a href=\"#%EC%A0%81%EC%9A%A9-%EB%B0%A9%EB%B2%95\" aria-label=\"적용 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>적용 방법</h3>\n<ol>\n<li>\n<p>config 설정</p>\n<ul>\n<li>Url 처리 방식에서 UrlResourceMap을 관리하는 것과 동일하게 <strong>MethodResourcesMapFactoryBean</strong>을 생성</li>\n<li>url 방식 config와 Method config와 분리해 관리하기 위해 <strong>MethodSecurity</strong>클래스를 만들어 구현</li>\n<li>GlobalMethodSecurityConfiguration을 상속받아 작성</li>\n</ul>\n</li>\n</ol>\n<div\n              class=\"gatsby-code-button-container copyButtonContainer\"\n              data-toaster-id=\"84967266054863180000\"\n              data-toaster-class=\"gatsby-code-button-toaster copyButtonToaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text copyButtonToasterText\"\n              data-toaster-text=\"customToasterText\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`// MethodResourcesMapFactoryBean\n@Slf4j\npublic class MethodResourcesMapFactoryBean implements FactoryBean<LinkedHashMap<String, List<ConfigAttribute>>> {\n\n    private SecurityResourceService securityResourceService;\n    private String resourceType;\n\n    public void setResourceType(String resourceType) {\n        this.resourceType = resourceType;\n    }\n\n    public void setSecurityResourceService(SecurityResourceService securityResourceService) {\n        this.securityResourceService = securityResourceService;\n    }\n\n    private LinkedHashMap<String, List<ConfigAttribute>> resourcesMap;\n\n    public void init() {\n        if (&quot;method&quot;.equals(resourceType)) {\n            resourcesMap = securityResourceService.getMethodResourceList();\n        } else if (&quot;pointcut&quot;.equals(resourceType)) {\n            resourcesMap = securityResourceService.getPointcutResourceList();\n        }\n    }\n\n    public LinkedHashMap<String, List<ConfigAttribute>> getObject() {\n        if (resourcesMap == null) {\n            init();\n        }\n        return resourcesMap;\n    }\n\n    @SuppressWarnings(&quot;rawtypes&quot;)\n    public Class<LinkedHashMap> getObjectType() {\n        return LinkedHashMap.class;\n    }\n\n    public boolean isSingleton() {\n        return true;\n    }\n}\n\n\n\n// MethodSecurityConfig\n@Configuration\n//@EnableGlobalMethodSecurity\n@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true)\npublic class MethodSecurityConfig extends GlobalMethodSecurityConfiguration {\n\n    @Autowired\n    private SecurityResourceService securityResourceService;\n\n    @Override\n    protected MethodSecurityMetadataSource customMethodSecurityMetadataSource() {\n        return mapBasedMethodSecurityMetadataSource();\n    }\n\n    @Bean\n    public MapBasedMethodSecurityMetadataSource mapBasedMethodSecurityMetadataSource() {\n        return new MapBasedMethodSecurityMetadataSource(methodResourcesMapFactoryBean().getObject());\n    }\n\n    @Bean\n    public MethodResourcesMapFactoryBean methodResourcesMapFactoryBean() {\n        MethodResourcesMapFactoryBean methodResourcesMapFactoryBean = new MethodResourcesMapFactoryBean();\n        methodResourcesMapFactoryBean.setSecurityResourceService(securityResourceService);\n        methodResourcesMapFactoryBean.setResourceType(&quot;method&quot;);\n        return methodResourcesMapFactoryBean;\n    }\n}`, `84967266054863180000`)\"\n            >\n              <div\n                class=\"gatsby-code-button copyButtonClass\"\n                data-tooltip=\"\"\n              >\n                copyButtonText<svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<pre class=\"grvsc-container default-dark\" data-language=\"java\" data-index=\"44\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// MethodResourcesMapFactoryBean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Slf4j</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">MethodResourcesMapFactoryBean</span><span class=\"mtk1\"> </span><span class=\"mtk4\">implements</span><span class=\"mtk1\"> </span><span class=\"mtk10\">FactoryBean</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">String</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt;&gt; {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityResourceService</span><span class=\"mtk1\"> </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">resourceType</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setResourceType</span><span class=\"mtk1\">(</span><span class=\"mtk10\">String</span><span class=\"mtk1\"> </span><span class=\"mtk12\">resourceType</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">resourceType</span><span class=\"mtk1\"> = resourceType;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">setSecurityResourceService</span><span class=\"mtk1\">(</span><span class=\"mtk10\">SecurityResourceService</span><span class=\"mtk1\"> </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">this</span><span class=\"mtk1\">.</span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\"> = securityResourceService;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">String</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk12\">resourcesMap</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">void</span><span class=\"mtk1\"> </span><span class=\"mtk11\">init</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk8\">&quot;method&quot;</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equals</span><span class=\"mtk1\">(resourceType)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            resourcesMap = </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getMethodResourceList</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        } </span><span class=\"mtk15\">else</span><span class=\"mtk1\"> </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk8\">&quot;pointcut&quot;</span><span class=\"mtk1\">.</span><span class=\"mtk11\">equals</span><span class=\"mtk1\">(resourceType)) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            resourcesMap = </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">.</span><span class=\"mtk11\">getPointcutResourceList</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">String</span><span class=\"mtk1\">, </span><span class=\"mtk10\">List</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">ConfigAttribute</span><span class=\"mtk1\">&gt;&gt; </span><span class=\"mtk11\">getObject</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> (resourcesMap == </span><span class=\"mtk4\">null</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk11\">init</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> resourcesMap;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">SuppressWarnings</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;rawtypes&quot;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">Class</span><span class=\"mtk1\">&lt;</span><span class=\"mtk10\">LinkedHashMap</span><span class=\"mtk1\">&gt; </span><span class=\"mtk11\">getObjectType</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk12\">LinkedHashMap</span><span class=\"mtk1\">.</span><span class=\"mtk12\">class</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">boolean</span><span class=\"mtk1\"> </span><span class=\"mtk11\">isSingleton</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// MethodSecurityConfig</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">Configuration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">//@EnableGlobalMethodSecurity</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">@</span><span class=\"mtk10\">EnableGlobalMethodSecurity</span><span class=\"mtk1\">(prePostEnabled = </span><span class=\"mtk4\">true</span><span class=\"mtk1\">, securedEnabled = </span><span class=\"mtk4\">true</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk4\">class</span><span class=\"mtk1\"> </span><span class=\"mtk10\">MethodSecurityConfig</span><span class=\"mtk1\"> </span><span class=\"mtk4\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk10\">GlobalMethodSecurityConfiguration</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Autowired</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">private</span><span class=\"mtk1\"> </span><span class=\"mtk10\">SecurityResourceService</span><span class=\"mtk1\"> </span><span class=\"mtk12\">securityResourceService</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Override</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">protected</span><span class=\"mtk1\"> </span><span class=\"mtk10\">MethodSecurityMetadataSource</span><span class=\"mtk1\"> </span><span class=\"mtk11\">customMethodSecurityMetadataSource</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk11\">mapBasedMethodSecurityMetadataSource</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">MapBasedMethodSecurityMetadataSource</span><span class=\"mtk1\"> </span><span class=\"mtk11\">mapBasedMethodSecurityMetadataSource</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">MapBasedMethodSecurityMetadataSource</span><span class=\"mtk1\">(</span><span class=\"mtk11\">methodResourcesMapFactoryBean</span><span class=\"mtk1\">().</span><span class=\"mtk11\">getObject</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    @</span><span class=\"mtk10\">Bean</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">public</span><span class=\"mtk1\"> </span><span class=\"mtk10\">MethodResourcesMapFactoryBean</span><span class=\"mtk1\"> </span><span class=\"mtk11\">methodResourcesMapFactoryBean</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10\">MethodResourcesMapFactoryBean</span><span class=\"mtk1\"> </span><span class=\"mtk12\">methodResourcesMapFactoryBean</span><span class=\"mtk1\"> = </span><span class=\"mtk15\">new</span><span class=\"mtk1\"> </span><span class=\"mtk11\">MethodResourcesMapFactoryBean</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">methodResourcesMapFactoryBean</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setSecurityResourceService</span><span class=\"mtk1\">(securityResourceService);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">methodResourcesMapFactoryBean</span><span class=\"mtk1\">.</span><span class=\"mtk11\">setResourceType</span><span class=\"mtk1\">(</span><span class=\"mtk8\">&quot;method&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> methodResourcesMapFactoryBean;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<ol start=\"2\">\n<li>Config파일에서 resourcesMap으로 하용 할 service, repository 객체 구현</li>\n</ol>\n<p>DB 저장 시 저장 방법</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/61c3ba3262ad9b892a212d0f3a529830/973af/saveDb.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.950920245398773%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAzUlEQVR42i3OQUuDUADAcb9/hz7BTkmZI4tNsotjBINq9UyG6JNtJ7Ewnw7Tp/PyD6TD7/4ztNach4FxHHlerbgzr1jO5/iuy/rJY+09svF9UimJ4xgpJWVZoruWrDjhih+8oKCsf+l1h1EUBWmacjgeubdtrNkMz3FYWBaOafJwc83StnnfbgnDkCAIyPMv+q5BZjUXTsTlIiEvW859h9E0DUopVFWRRBGfb6/shGAnPv6JyWG/J0mSaVjVNePQ861abjcZzkuOOrXT8A9RY9EozhzdeAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/61c3ba3262ad9b892a212d0f3a529830/a81b5/saveDb.webp 163w,\n/static/61c3ba3262ad9b892a212d0f3a529830/da3ef/saveDb.webp 325w,\n/static/61c3ba3262ad9b892a212d0f3a529830/309d5/saveDb.webp 650w,\n/static/61c3ba3262ad9b892a212d0f3a529830/78344/saveDb.webp 975w,\n/static/61c3ba3262ad9b892a212d0f3a529830/bdb72/saveDb.webp 1300w,\n/static/61c3ba3262ad9b892a212d0f3a529830/9668a/saveDb.webp 1956w\"\n              sizes=\"(max-width: 650px) 100vw, 650px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/61c3ba3262ad9b892a212d0f3a529830/5e043/saveDb.png 163w,\n/static/61c3ba3262ad9b892a212d0f3a529830/e5cc6/saveDb.png 325w,\n/static/61c3ba3262ad9b892a212d0f3a529830/663f3/saveDb.png 650w,\n/static/61c3ba3262ad9b892a212d0f3a529830/d880f/saveDb.png 975w,\n/static/61c3ba3262ad9b892a212d0f3a529830/4c573/saveDb.png 1300w,\n/static/61c3ba3262ad9b892a212d0f3a529830/973af/saveDb.png 1956w\"\n            sizes=\"(max-width: 650px) 100vw, 650px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/61c3ba3262ad9b892a212d0f3a529830/663f3/saveDb.png\"\n            alt=\"saveDb\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<ol start=\"3\">\n<li>Method에 어노테이션 적용</li>\n</ol>\n<h2 id=\"aop-방식\" style=\"position:relative;\"><a href=\"#aop-%EB%B0%A9%EC%8B%9D\" aria-label=\"aop 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AOP 방식</h2>\n<blockquote>\n<p>ProtectPointcutPostProcessor가 DB정보를 읽어 Bean에 해당하는 TargetClass 정보, Method 정보, ConfigAttribute정보를 읽어 MethodSecurityMetadata에 전달</p>\n</blockquote>\n<p>구현하려면 ProtectPointcutPostProcessor을 상속받아 사용해야 하는데 final로 선언되어 있어 확장이 불가능 -> 강의에선 동일한 기능을 하는 클래스 생성해 기능 구현</p>\n<p>Method방식과 동일하게 config 설정, service, repository 구현해 사용</p>\n<p>Aop방식은 잘 사용할 것 같지 않아서 추후에 실무에서 사용 시 다시 공부해서 적용해야겠다…</p>\n<h1 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h1>\n<ul>\n<li><a href=\"https://dextto.tistory.com/234\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">인증(Authentication) vs. 인가(Authorization)</a></li>\n<li><a href=\"https://docs.spring.io/spring-security/reference/servlet/authentication/passwords/form.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Security Document</a></li>\n<li><a href=\"https://www.inflearn.com/course/%EC%BD%94%EC%96%B4-%EC%8A%A4%ED%94%84%EB%A7%81-%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0/dashboard\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">스프링 시큐리티 - Spring Boot 기반으로 개발하는 Spring Security</a></li>\n<li><a href=\"https://programmer93.tistory.com/68\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Security UserDetails, UserDetailsService 란? - 삽질중인 개발자</a></li>\n<li><a href=\"https://stackoverflow.com/questions/53140629/spring-security-loginpage-vs-loginprocessingurl\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Security loginPage Vs loginProcessingURL - stackoverflow</a></li>\n<li><a href=\"https://binchoo.tistory.com/46\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">[스프링 Security] CSRF 토큰 이야기 - 그래서 개발자는 뭘 하면 되죠</a></li>\n<li><a href=\"https://whitepro.tistory.com/m/521\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">[스프링 시큐리티]23. Method 방식 : 동작방식 및 구조 알아보기 - 컴퓨터 탐험가 찰리</a></li>\n</ul>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk10 { color: #4EC9B0; }\n  .default-dark .mtk3 { color: #6A9955; }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .mtk15 { color: #C586C0; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk7 { color: #B5CEA8; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EC%9A%A9%EC%96%B4-%EC%A0%95%EB%A6%AC\">용어 정리</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B8%B0%EB%B3%B8-api-%EB%B0%8F-filter\">기본 API 및 Filter</a></p>\n<ul>\n<li>\n<p><a href=\"#%EC%9E%90%EB%8F%99-%EA%B5%AC%EC%84%B1-%ED%95%AD%EB%AA%A9\">자동 구성 항목</a></p>\n</li>\n<li>\n<p><a href=\"#login-form-%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95\">Login Form 인증 과정</a></p>\n</li>\n<li>\n<p><a href=\"#logout%EA%B3%BC%EC%A0%95\">Logout과정</a></p>\n</li>\n<li>\n<p><a href=\"#rememberme-%EC%9D%B8%EC%A6%9D-%EC%98%81%EA%B5%AC-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%9D%B8%EC%A6%9D\">RememberMe 인증 (영구 로그인 인증)</a></p>\n<ul>\n<li><a href=\"#%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95\">인증 과정</a></li>\n<li><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B5%EB%AA%85%EC%82%AC%EC%9A%A9%EC%9E%90-%ED%95%84%ED%84%B0\">익명사용자 필터</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%8F%99%EC%8B%9C-%EC%84%B8%EC%85%98-%EC%A0%9C%EC%96%B4\">동시 세션 제어</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%84%B8%EC%85%98-%EA%B3%A0%EC%A0%95-%EB%B3%B4%ED%98%B8\">세션 고정 보호</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%84%B8%EC%85%98-%EC%A0%95%EC%B1%85\">세션 정책</a></p>\n</li>\n<li>\n<p><a href=\"#sessionmanagementfilter-concurrentsessionfilter\">SessionManagementFilter, ConcurrentSessionFilter</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B6%8C%ED%95%9C-%EC%84%A4%EC%A0%95%EA%B3%BC-%ED%91%9C%ED%98%84%EC%8B%9D\">권한 설정과 표현식</a></p>\n<ul>\n<li><a href=\"#%EC%84%A0%EC%96%B8%EC%A0%81-%EB%B0%A9%EC%8B%9D\">선언적 방식</a></li>\n<li><a href=\"#2-%EB%8F%99%EC%A0%81-%EB%B0%A9%EC%8B%9D-db%EC%97%B0%EB%8F%99\">2. 동적 방식 (DB연동)</a></li>\n<li><a href=\"#%EC%A3%BC%EC%9D%98-%EC%82%AC%ED%95%AD\">주의 사항</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC-%EB%B0%8F-%EC%9A%94%EC%B2%AD-%EC%BA%90%EC%8B%9C-%ED%95%84%ED%84%B0\">예외 처리 및 요청 캐시 필터</a></p>\n<ul>\n<li><a href=\"#authenticationexception\">AuthenticationException</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#csrf%EC%B2%98%EB%A6%AC\">CSRF처리</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A3%BC%EC%9A%94-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98\">주요 아키텍처</a></p>\n<ul>\n<li>\n<p><a href=\"#delegatingfilterproxy\">DelegatingFilterProxy</a></p>\n</li>\n<li>\n<p><a href=\"#filterchainproxy\">FilterChainProxy</a></p>\n</li>\n<li>\n<p><a href=\"#filter-%EC%B4%88%EA%B8%B0%ED%99%94-%EB%8B%A4%EC%A4%91-%EB%B3%B4%EC%95%88-%EC%84%A4%EC%A0%95\">Filter 초기화 다중 보안 설정</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B8%EC%A6%9Dauthentication\">인증(Authentication)</a></p>\n<ul>\n<li><a href=\"#securitycontext\">SecurityContext</a></li>\n<li><a href=\"#securitycontextholder\">SecurityContextHolder</a></li>\n<li><a href=\"#securitypersistencefilter\">SecurityPersistenceFilter</a></li>\n<li><a href=\"#%EC%9D%B8%EC%A6%9D-%ED%9D%90%EB%A6%84-authentication-flow\">인증 흐름 (Authentication Flow)</a></li>\n<li><a href=\"#authenticationmanager\">AuthenticationManager</a></li>\n<li><a href=\"#authenticationprovider\">AuthenticationProvider</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B8%EA%B0%80authorization\">인가(Authorization)</a></p>\n<ul>\n<li><a href=\"#%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0%EA%B0%80-%EC%A7%80%EC%9B%90%ED%95%98%EB%8A%94-%EA%B6%8C%ED%95%9C-%EA%B3%84%EC%B8%B5\">시큐리티가 지원하는 권한 계층</a></li>\n<li><a href=\"#authorizationfilter\">AuthorizationFilter</a></li>\n<li><a href=\"#accessdecisionmanager\">AccessDecisionManager</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%95%EB%A6%AC-1\">정리</a></p>\n<ul>\n<li><a href=\"#%EC%B4%88%EA%B8%B0%ED%99%94\">초기화</a></li>\n<li><a href=\"#%EC%9D%B8%EC%A6%9D\">인증</a></li>\n<li><a href=\"#%EC%9D%B8%EA%B0%80\">인가</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B8%EC%A6%9D-%EA%B5%AC%ED%98%84\">인증 구현</a></p>\n<ul>\n<li>\n<p><a href=\"#%EC%A0%95%EC%A0%81%EC%9E%90%EC%9B%90-%EA%B4%80%EB%A6%AC\">정적자원 관리</a></p>\n</li>\n<li>\n<p><a href=\"#passwordencoder\">PasswordEncoder</a></p>\n</li>\n<li>\n<p><a href=\"#userdetails\">UserDetails</a></p>\n</li>\n<li>\n<p><a href=\"#customuserdetailsservicedb-%EC%97%B0%EB%8F%99-%EA%B5%AC%ED%98%84\">CustomUserDetailsService(DB 연동 구현)</a></p>\n</li>\n<li>\n<p><a href=\"#form%EC%9D%B8%EC%A6%9D-%EA%B5%AC%ED%98%84\">Form인증 구현</a></p>\n<ul>\n<li><a href=\"#customauthenticationprovider\">CustomAuthenticationProvider</a></li>\n<li><a href=\"#login-logout-%EC%B2%98%EB%A6%AC-%EB%B0%8F-%ED%95%B8%EB%93%A4%EB%9F%AC-%EA%B5%AC%ED%98%84\">Login, Logout 처리 및 핸들러 구현</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#ajax-%EC%9D%B8%EC%A6%9D\">Ajax 인증</a></p>\n<ul>\n<li><a href=\"#1-ajax-%EC%9A%94%EC%B2%AD-%EC%B2%98%EB%A6%AC-%ED%95%A0-filter-%EC%B6%94%EA%B0%80\">1. Ajax 요청 처리 할 Filter 추가</a></li>\n<li><a href=\"#2-ajaxauthenticationtoken%EA%B0%9D%EC%B2%B4-%EC%83%9D%EC%84%B1\">2. AjaxAuthenticationToken객체 생성</a></li>\n<li><a href=\"#3-%EC%9D%B8%EC%A6%9D-%EC%B2%98%EB%A6%AC-%ED%95%A0-ajaxauthenticationprovider-%EA%B5%AC%ED%98%84\">3. 인증 처리 할 AjaxAuthenticationProvider 구현</a></li>\n<li><a href=\"#4-%EC%9D%B8%EC%A6%9D-%EC%84%B1%EA%B3%B5-%EC%8B%A4%ED%8C%A8-%EC%B2%98%EB%A6%AC-%ED%95%B8%EB%93%A4%EB%9F%AC-%EA%B5%AC%ED%98%84\">4. 인증 성공, 실패 처리 핸들러 구현</a></li>\n<li><a href=\"#5-%EC%9D%B8%EA%B0%80-%EC%84%A4%EC%A0%95\">5. 인가 설정</a></li>\n<li><a href=\"#6-bean-%EC%84%A4%EC%A0%95-%EB%B0%8F-ajax%EC%9A%A9-securityconfig-%EC%84%A4%EC%A0%95-%EC%B6%94%EA%B0%80\">6. Bean 설정 및 Ajax용 SecurityConfig 설정 추가</a></li>\n<li><a href=\"#dsls\">DSLs</a></li>\n<li><a href=\"#ajax-login-csrf-%EC%84%A4%EC%A0%95\">Ajax Login, CSRF 설정</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B8%EA%B0%80-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-db%EC%97%B0%EB%8F%99\">인가 프로세스 DB연동</a></p>\n<ul>\n<li>\n<p><a href=\"#url-%EB%B0%A9%EC%8B%9D-%EC%B2%98%EB%A6%AC\">URL 방식 처리</a></p>\n<ul>\n<li><a href=\"#url-%EB%B0%A9%EC%8B%9D-%EA%B8%B0%EB%B3%B8-%EB%8F%99%EC%9E%91-%EC%9B%90%EB%A6%AC\">URL 방식 기본 동작 원리</a></li>\n<li><a href=\"#filterinvocationsecuritymetadatasource\">FilterInvocationSecurityMetadataSource</a></li>\n<li><a href=\"#requestmap-db-%EC%97%B0%EB%8F%99\">requestMap DB 연동</a></li>\n<li><a href=\"#resource%EB%A5%BC-%EA%B0%80%EC%A0%B8%EC%98%A4%EB%8A%94-service%EB%A5%BC-%EC%83%9D%EC%84%B1\">Resource를 가져오는 Service를 생성</a></li>\n<li><a href=\"#db-%EC%A0%91%EA%B7%BC-%EA%B6%8C%ED%95%9C-%EC%8B%A4%EC%8B%9C%EA%B0%84-%EB%B0%98%EC%98%81\">DB 접근 권한 실시간 반영</a></li>\n<li><a href=\"#%ED%97%88%EC%9A%A9-%ED%95%84%ED%84%B0\">허용 필터</a></li>\n<li><a href=\"#%EA%B3%84%EC%B8%B5-%EA%B6%8C%ED%95%9C-%EC%A0%81%EC%9A%A9\">계층 권한 적용</a></li>\n<li><a href=\"#ip-%EC%A0%91%EC%86%8D-%EC%A0%9C%ED%95%9C\">IP 접속 제한</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#method-%EB%B0%A9%EC%8B%9D-%EC%9D%B8%EA%B0%80-%EC%B2%98%EB%A6%AC\">Method 방식 인가 처리</a></p>\n<ul>\n<li><a href=\"#%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D\">동작 방식</a></li>\n<li><a href=\"#%EA%B4%80%EB%A0%A8-%EC%96%B4%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98\">관련 어노테이션</a></li>\n<li><a href=\"#%EC%A0%81%EC%9A%A9-%EB%B0%A9%EB%B2%95\">적용 방법</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#aop-%EB%B0%A9%EC%8B%9D\">AOP 방식</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#reference\">Reference</a></p>\n</li>\n</ul>","frontmatter":{"title":"Spring Security Session","summary":["Spring Security 라이브러리 뜯어보며 알아보자"],"date":"2023.01.14.","category":["Spring"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADlElEQVR42nVUTYgcRRTuza6JICoSQnR35r3qmVExEpCI6EFJ0JNHhQWDSMxFEREJY9frn9npRGO8KCKIoOLFg5DxoiIzu13V0z3jTMy6bn5MICiIt2AkQS+CujNbUt3TbWczFjy6qH7vq/e+974yjC1LKWNmsWXMFs8WW3u2+xf3bC+e+b6xzVfGtjTImDGmrcTJT51IVPaSgOM8AMEFXOIB/sgF9EjAu1an/NgkJLlcTQPMgOzV+Z1c4McU4oa/aqrGkCm3z5TbY6oxYEqfOREqK4C216uWXVlasAQ8W8T4D2y5VLO7ePHod6aiEMdc4AZJHHGJY23JXuCG3jdPmcru4mUrgBMUQsMa3HurUazfFvM73RjPNb81FRf4D0ncJIlq8t0kkRpPQGHkfcOUE+Nf1MEDFMLjboQPpNlNiLW78EGSWQqmeJrZSO/tEHU2SalLQ3MzvRTO2ivwoI614oW7nRifzvnjYfl+J2J/6kCusxA4bgxNpQM10CSrv7nEqyRQ8hAP+xHenMW/9QPc4fTxmRzQ66OryeYBbNhdHGvySWCfJLzsBPCE1YF9dlSt+adrt2UU6c76hXHyIjxIonJ7AuhE+MXSKVPzNXJjHFHIXsnGYtqc+tH+uSSuXdtlC/OehLIQnrMG5fmEQwpxLR0LU/N1TDu0WsasHxlzes60TzIJOjsNOOHdCvCg24G70qayQzyqlQwdYEtcSzOEK440dxebdcPgR0aSHQ/wMBfsUPbPjfB5PZNpyV388o0zFcUDFFMElKhBA2WKoKD8Kg/gk8xBV+P12Is5h16fNd88X9XdFKl2NcD+uVzTEyCnfecukniSBLTrK7tvyZs6KFepi/U8BVfCPidiY5LwhxcyLKpHZ2YL8yEu8H2SeI0kfqQ7qy/78HvjpoQ/iR6X+GTetUnZn564UFVeD2W9gwdsAS+QhM+4xJ+5gN9JQECi8mje6fwRwZdI4OfXjUHaJajYITtLAdZtCWeWholq1i3JmiRKe3WTFluLs1qiPMD7aAWfIgnLFMKV19rl6nWPQ8bREVla4O1ayeuz9VQ18EtiEn/T5fIQr1KI17Rqjp+rqsYAf61/ncrvhqnINb1cqlkCv7JjHL++XlFHV021NGSJNU+b6tiaqZw4UdJJKyjPZ0383wc213eEj5CEd0hCTAJ/IqkNYlvA23aXPZxVVoyZutRWJ2XMvNeu7dBWfOpz9WxZ/wJwOf3zP7mVigAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/daf23c051d1970bd74a5bdb9fe7de872/5f2c3/thumbnail.png","srcSet":"/static/daf23c051d1970bd74a5bdb9fe7de872/90cd3/thumbnail.png 100w,\n/static/daf23c051d1970bd74a5bdb9fe7de872/614dc/thumbnail.png 200w,\n/static/daf23c051d1970bd74a5bdb9fe7de872/5f2c3/thumbnail.png 400w","sizes":"(min-width: 400px) 400px, 100vw"},"sources":[{"srcSet":"/static/daf23c051d1970bd74a5bdb9fe7de872/e64f1/thumbnail.webp 100w,\n/static/daf23c051d1970bd74a5bdb9fe7de872/8b00d/thumbnail.webp 200w,\n/static/daf23c051d1970bd74a5bdb9fe7de872/9c0a1/thumbnail.webp 400w","type":"image/webp","sizes":"(min-width: 400px) 400px, 100vw"}]},"width":400,"height":400}},"publicURL":"/static/daf23c051d1970bd74a5bdb9fe7de872/thumbnail.png"}}}}]}},"pageContext":{"slug":"/SpringSecurity1/","series":[],"lastmod":"2023.02.06."}},"staticQueryHashes":["2383754777"],"slicesMap":{}}