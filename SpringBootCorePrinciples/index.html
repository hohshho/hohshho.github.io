<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.11.0"/><meta data-react-helmet="true" name="description" content="스프링 부트 핵심 원리와 활용 - 김영한 정리해보자"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1.0"/><meta data-react-helmet="true" http-equiv="Content-Type" content="text/html;charset=UTF-8"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="스프링 부트 핵심 원리와 활용 - 김영한 정리"/><meta data-react-helmet="true" property="og:description" content="스프링 부트 핵심 원리와 활용 - 김영한 정리해보자"/><meta data-react-helmet="true" property="og:image" content="/static/daf23c051d1970bd74a5bdb9fe7de872/thumbnail.png"/><meta data-react-helmet="true" property="og:url"/><meta data-react-helmet="true" property="og:site_name" content="스프링 부트 핵심 원리와 활용 - 김영한 정리"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="스프링 부트 핵심 원리와 활용 - 김영한 정리"/><meta data-react-helmet="true" name="twitter:description" content="스프링 부트 핵심 원리와 활용 - 김영한 정리해보자"/><meta data-react-helmet="true" name="twitter:image" content="/static/daf23c051d1970bd74a5bdb9fe7de872/thumbnail.png"/><meta data-react-helmet="true" name="twitter:site" content="@사용자이름"/><meta data-react-helmet="true" name="twitter:creator" content="@사용자이름"/><style data-href="/styles.a9a66fba0ee2dc3f2598.css" data-identity="gatsby-global-css">.gatsby-code-button-container{display:flex;justify-content:flex-end;pointer-events:none;position:relative;top:28px;touch-action:none;z-index:100}.gatsby-code-button{cursor:pointer;pointer-events:auto}.gatsby-code-button:after{background-color:#000;color:#fff;content:attr(data-tooltip);display:none;font-size:16px;padding:5px;position:absolute;visibility:hidden;white-space:nowrap}.gatsby-code-button[data-tooltip]:after{right:0;top:26px}.gatsby-code-button[data-tooltip]:focus:after,.gatsby-code-button[data-tooltip]:hover:after{display:block;visibility:visible;z-index:200}.gatsby-code-button-toaster{align-items:center;bottom:0;display:flex;height:100vh;justify-content:center;left:0;pointer-events:none;position:fixed;right:0;top:0;width:100vw;z-index:500}.gatsby-code-button-toaster-text{animation:animation 3s cubic-bezier(.98,.01,.53,.47);background-color:#000;border-radius:2px;color:#fff;font-family:monospace;font-size:24px;letter-spacing:-1px;margin:0 15px;max-width:850px;opacity:0;padding:20px;text-align:center;width:100%}.gatsby-code-button-buffer{opacity:0;position:fixed;top:-9999px}@keyframes animation{0%,50%{opacity:1}50%,to{opacity:0}}

/*
! tailwindcss v3.3.3 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-feature-settings:normal;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-feature-settings:inherit;color:inherit;font-family:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.mx-auto{margin-left:auto;margin-right:auto}.-mt-16{margin-top:-4rem}.mt-3{margin-top:.75rem}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-4{height:1rem}.h-48{height:12rem}.h-56{height:14rem}.min-h-screen{min-height:100vh}.w-48{width:12rem}.max-w-md{max-width:28rem}.flex-shrink{flex-shrink:1}.flex-grow{flex-grow:1}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.overflow-hidden{overflow:hidden}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.border{border-width:1px}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-indigo-700{--tw-bg-opacity:1;background-color:rgb(67 56 202/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-cover{background-size:cover}.bg-bottom{background-position:bottom}.bg-center{background-position:50%}.fill-current{fill:currentColor}.p-4{padding:1rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.pr-4{padding-right:1rem}.pt-2{padding-top:.5rem}.pt-4{padding-top:1rem}.text-base{font-size:1rem;line-height:1.5rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.uppercase{text-transform:uppercase}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99/var(--tw-text-opacity))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81/var(--tw-text-opacity))}.text-green-700{--tw-text-opacity:1;color:rgb(21 128 61/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.underline{text-decoration-line:underline}.line-through{text-decoration-line:line-through}.shadow-md{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.shadow-md,.shadow-xl{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 8px 10px -6px rgba(0,0,0,.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color),0 8px 10px -6px var(--tw-shadow-color)}.blur{--tw-blur:blur(8px)}.blur,.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-filter{-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.hover\:bg-indigo-600:hover{--tw-bg-opacity:1;background-color:rgb(79 70 229/var(--tw-bg-opacity))}@media (min-width:640px){.sm\:mt-0{margin-top:0}.sm\:flex{display:flex}.sm\:items-center{align-items:center}.sm\:justify-between{justify-content:space-between}}@media (min-width:768px){.md\:flex{display:flex}.md\:h-auto{height:auto}.md\:w-56{width:14rem}.md\:max-w-2xl{max-width:42rem}.md\:p-5{padding:1.25rem}.md\:px-6{padding-left:1.5rem;padding-right:1.5rem}.md\:py-3{padding-bottom:.75rem;padding-top:.75rem}.md\:text-2xl{font-size:1.5rem;line-height:2rem}.md\:text-lg{font-size:1.125rem;line-height:1.75rem}}@media (min-width:1024px){.lg\:hidden{display:none}.lg\:justify-start{justify-content:flex-start}.lg\:text-sm{font-size:.875rem;line-height:1.25rem}}.grvsc-container{margin-bottom:20px;margin-top:0}.react-rotating-text-cursor{animation:blinking-cursor .8s cubic-bezier(.68,.01,.01,.99) 0s infinite;color:#047857}@keyframes blinking-cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}.ham{-webkit-tap-highlight-color:transparent;cursor:pointer;transition:transform .4s;-moz-user-select:none;-webkit-user-select:none;user-select:none;width:60px}.line{fill:none;stroke:#000;stroke-width:5.5;stroke-linecap:round;transition:stroke-dasharray .4s,stroke-dashoffset .4s}.ham3 .top{stroke-dasharray:40 130}.ham3 .middle{stroke-dasharray:40 140}.ham3 .bottom{stroke-dasharray:40 205}.ham3.active .top{stroke-dasharray:75 130;stroke-dashoffset:-63px}.ham3.active .middle{stroke-dashoffset:-102px}.ham3.active .bottom{stroke-dasharray:110 205;stroke-dashoffset:-86px}.search-input-wrapper{box-sizing:border-box;display:block;margin:0;width:100%}.search-icon{color:var(--primary-text-color);margin-right:2px}.search-input{height:100%;width:100%;.MuiAutocomplete-inputRoot{padding-right:0!important}.MuiInputBase-input{color:var(--primary-text-color)!important;font-size:16px;font-weight:500;padding-bottom:2px!important}.MuiInput-underline:before{border-bottom-color:var(--primary-text-color);border-bottom-width:1px}.MuiInput-underline:after{border-bottom-color:var(--primary-text-color)}}.markdown .octicon{fill:currentColor;display:inline-block;vertical-align:text-bottom}.markdown .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown .anchor:focus{outline:none}.markdown h1 .octicon-link,.markdown h2 .octicon-link,.markdown h3 .octicon-link,.markdown h4 .octicon-link,.markdown h5 .octicon-link,.markdown h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown h1:hover .anchor,.markdown h2:hover .anchor,.markdown h3:hover .anchor,.markdown h4:hover .anchor,.markdown h5:hover .anchor,.markdown h6:hover .anchor{text-decoration:none}.markdown h1:hover .anchor .octicon-link,.markdown h2:hover .anchor .octicon-link,.markdown h3:hover .anchor .octicon-link,.markdown h4:hover .anchor .octicon-link,.markdown h5:hover .anchor .octicon-link,.markdown h6:hover .anchor .octicon-link{visibility:visible}.markdown h1:hover .anchor .octicon-link:before,.markdown h2:hover .anchor .octicon-link:before,.markdown h3:hover .anchor .octicon-link:before,.markdown h4:hover .anchor .octicon-link:before,.markdown h5:hover .anchor .octicon-link:before,.markdown h6:hover .anchor .octicon-link:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E");content:" ";display:inline-block;height:16px;width:16px}.markdown{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-wrap:break-word;color:var(--content-text-color);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:18px;font-weight:500;line-height:1.5}.markdown details{display:block}.markdown summary{display:list-item}.markdown a{background-color:initial}.markdown a:active,.markdown a:hover{outline-width:0}.markdown strong{font-weight:inherit;font-weight:bolder}.markdown h1{margin:.67em 0}.markdown img{border-style:none}.markdown hr{box-sizing:initial;overflow:visible}.markdown input{font:inherit;margin:0;overflow:visible}.markdown [type=checkbox]{box-sizing:border-box;padding:0}.markdown *{box-sizing:border-box}.markdown input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown a{color:#0074d9;position:relative;text-decoration:none}.markdown a:before{background-color:#0074d9;bottom:0;content:"";height:2px;position:absolute;right:0;transition:width .6s cubic-bezier(.25,1,.5,1);width:0}@media(hover:hover)and (pointer:fine){.markdown :hover:before{left:0;right:auto;width:100%}}.markdown strong{font-weight:700}.markdown hr{background:transparent;border-bottom:1px solid var(--markdown-blockquote-border-color);height:0;margin:15px 0;overflow:hidden}.markdown hr:after,.markdown hr:before{content:"";display:table}.markdown hr:after{clear:both}.markdown table{border-collapse:collapse;border-spacing:0}.markdown td,.markdown th{padding:0}.markdown details summary{cursor:pointer}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{margin-bottom:0;margin-top:0}.markdown h1{font-size:34px}.markdown h1,.markdown h2{font-weight:600}.markdown h2{font-size:26px}.markdown h3{font-size:22px}.markdown h3,.markdown h4{font-weight:600}.markdown h4{font-size:18px}.markdown h5{font-size:16px}.markdown h5,.markdown h6{font-weight:600}.markdown h6{font-size:14px}.markdown p{margin-bottom:10px;margin-top:0}.markdown blockquote{margin:0}.markdown ol,.markdown ul{margin-bottom:0;margin-top:0;padding-left:0}.markdown ol ol,.markdown ul ol{list-style-type:lower-roman}.markdown ol ol ol,.markdown ol ul ol,.markdown ul ol ol,.markdown ul ul ol{list-style-type:lower-alpha}.markdown dd{margin-left:0}.markdown input::-webkit-inner-spin-button,.markdown input::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}.markdown :checked+.radio-label{border-color:#0366d6;position:relative;z-index:1}.markdown .border{border:1px solid var(--markdown-border-color)!important}.markdown .border-0{border:0!important}.markdown .border-bottom{border-bottom:1px solid var(--markdown-border-color)!important}.markdown .rounded-1{border-radius:3px!important}.markdown .bg-white{background-color:transparent!important}.markdown .bg-gray-light{background-color:#fafbfc!important}.markdown .text-gray-light{color:#6a737d!important}.markdown .pl-3,.markdown .px-3{padding-left:16px!important}.markdown .px-3{padding-right:16px!important}.markdown .f6{font-size:14px!important}.markdown .lh-condensed{line-height:1.25!important}.markdown .text-bold{font-weight:600!important}.markdown .pl-c{color:#6a737d}.markdown .pl-c1,.markdown .pl-s .pl-v{color:#005cc5}.markdown .pl-e,.markdown .pl-en{color:#6f42c1}.markdown .pl-s .pl-s1,.markdown .pl-smi{color:#24292e}.markdown .pl-ent{color:#22863a}.markdown .pl-k{color:#d73a49}.markdown .pl-pds,.markdown .pl-s,.markdown .pl-s .pl-pse .pl-s1,.markdown .pl-sr,.markdown .pl-sr .pl-cce,.markdown .pl-sr .pl-sra,.markdown .pl-sr .pl-sre{color:#032f62}.markdown .pl-smw,.markdown .pl-v{color:#e36209}.markdown .pl-bu{color:#b31d28}.markdown .pl-ii{background-color:#b31d28;color:#fafbfc}.markdown .pl-c2{background-color:#d73a49;color:#fafbfc}.markdown .pl-c2:before{content:"^M"}.markdown .pl-sr .pl-cce{color:#22863a;font-weight:700}.markdown .pl-ml{color:#735c0f}.markdown .pl-mh,.markdown .pl-mh .pl-en,.markdown .pl-ms{color:#005cc5;font-weight:700}.markdown .pl-mi{color:#24292e;font-style:italic}.markdown .pl-mb{color:#24292e;font-weight:700}.markdown .pl-md{background-color:#ffeef0;color:#b31d28}.markdown .pl-mi1{background-color:#f0fff4;color:#22863a}.markdown .pl-mc{background-color:#ffebda;color:#e36209}.markdown .pl-mi2{background-color:#005cc5;color:#f6f8fa}.markdown .pl-mdr{color:#6f42c1;font-weight:700}.markdown .pl-ba{color:#586069}.markdown .pl-sg{color:#959da5}.markdown .pl-corl{color:#032f62;text-decoration:underline}.markdown .mb-0{margin-bottom:0!important}.markdown .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown .pl-0{padding-left:0!important}.markdown .py-0{padding-bottom:0!important;padding-top:0!important}.markdown .pl-1{padding-left:4px!important}.markdown .pl-2{padding-left:8px!important}.markdown .py-2{padding-bottom:8px!important;padding-top:8px!important}.markdown .pl-3{padding-left:16px!important}.markdown .pl-4{padding-left:24px!important}.markdown .pl-5{padding-left:32px!important}.markdown .pl-6{padding-left:40px!important}.markdown .pl-7{padding-left:48px!important}.markdown .pl-8{padding-left:64px!important}.markdown .pl-9{padding-left:80px!important}.markdown .pl-10{padding-left:96px!important}.markdown .pl-11{padding-left:112px!important}.markdown .pl-12{padding-left:128px!important}.markdown hr{border-bottom-color:#eee}.markdown kbd{background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da;color:#444d56;display:inline-block;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown:after,.markdown:before{content:"";display:table}.markdown:after{clear:both}.markdown>:first-child{margin-top:0!important}.markdown>:last-child{margin-bottom:0!important}.markdown a:not([href]){color:inherit;text-decoration:none}.markdown blockquote,.markdown details,.markdown dl,.markdown ol,.markdown p,.markdown table,.markdown ul{margin-bottom:16px;margin-top:0}.markdown hr{background-color:var(--markdown-border-color);border:0;height:.25em;margin:24px 0;padding:0}.markdown blockquote{border-left:.25em solid var(--markdown-blockquote-border-color);color:#6a737d;padding:0 1em}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown h1{font-size:2.125em}.markdown h2{font-size:1.625em}.markdown h3{font-size:1.375em}.markdown h4{font-size:1.125em}.markdown h5{font-size:1em}.markdown h6{color:#6a737d;font-size:.975em}.markdown ol,.markdown ul{padding-left:2em}.markdown ol ol,.markdown ol ul,.markdown ul ol,.markdown ul ul{margin-bottom:0;margin-top:0}.markdown ol{list-style-type:decimal}.markdown ul{list-style-type:disc}.markdown li{word-wrap:break-all;display:list-item;text-align:-webkit-match-parent}.markdown li>p{margin-top:16px}.markdown li+li{margin-top:.25em}.markdown dl{padding:0}.markdown dl dt{font-size:1.125em;font-style:italic;font-weight:600;margin-top:16px;padding:0}.markdown dl dd{margin-bottom:16px;padding:0 16px}.markdown table{display:block;overflow:auto;width:100%}.markdown table th{font-weight:600}.markdown table td,.markdown table th{border:1px solid var(--markdown-table-border-color);padding:6px 13px}.markdown table tr{border-top:1px solid var(--markdown-table-border-color)}.markdown table tr:nth-child(2n){background-color:var(--markdown-table-even-cell-background-color)}.markdown img{background-color:transparent;box-sizing:initial;display:block;margin:0 auto;max-width:100%;padding-bottom:20px}.markdown img[align=right]{padding-left:20px}.markdown img[align=left]{padding-right:20px}.markdown .commit-tease-sha{color:#444d56;display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%}.markdown .full-commit .btn-outline:not(:disabled):hover{border-color:#005cc5;color:#005cc5}.markdown .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown .blob-num{color:rgba(27,31,35,.3);cursor:pointer;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:14px;line-height:20px;min-width:50px;padding-left:10px;padding-right:10px;text-align:right;-webkit-user-select:none;user-select:none;vertical-align:top;white-space:nowrap;width:1%}.markdown .blob-num:hover{color:rgba(27,31,35,.6)}.markdown .blob-num:before{content:attr(data-line-number)}.markdown .blob-code{line-height:20px;padding-left:10px;padding-right:10px;position:relative;vertical-align:top}.markdown .blob-code-inner{word-wrap:normal;color:#24292e;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:14px;overflow:visible;white-space:pre}.markdown .pl-token.active,.markdown .pl-token:hover{background:#ffea7f;cursor:pointer}.markdown .tab-size[data-tab-size="1"]{tab-size:1}.markdown .tab-size[data-tab-size="2"]{tab-size:2}.markdown .tab-size[data-tab-size="3"]{tab-size:3}.markdown .tab-size[data-tab-size="4"]{tab-size:4}.markdown .tab-size[data-tab-size="5"]{tab-size:5}.markdown .tab-size[data-tab-size="6"]{tab-size:6}.markdown .tab-size[data-tab-size="7"]{tab-size:7}.markdown .tab-size[data-tab-size="8"]{tab-size:8}.markdown .tab-size[data-tab-size="9"]{tab-size:9}.markdown .tab-size[data-tab-size="10"]{tab-size:10}.markdown .tab-size[data-tab-size="11"]{tab-size:11}.markdown .tab-size[data-tab-size="12"]{tab-size:12}.markdown .task-list-item{list-style-type:none}.markdown .task-list-item+.task-list-item{margin-top:3px}.markdown .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.post-content{display:flex;flex-direction:column;justify-content:center;margin-bottom:20px;width:100%}</style><link rel="sitemap" type="application/xml" href="/sitemap.xml/sitemap-index.xml"/><title data-react-helmet="true">스프링 부트 핵심 원리와 활용 - 김영한 정리</title><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=6bc9d81d0802ac3a1c031dfb462bab8f" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=6bc9d81d0802ac3a1c031dfb462bab8f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=6bc9d81d0802ac3a1c031dfb462bab8f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=6bc9d81d0802ac3a1c031dfb462bab8f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=6bc9d81d0802ac3a1c031dfb462bab8f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=6bc9d81d0802ac3a1c031dfb462bab8f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=6bc9d81d0802ac3a1c031dfb462bab8f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=6bc9d81d0802ac3a1c031dfb462bab8f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=6bc9d81d0802ac3a1c031dfb462bab8f"/><link rel="preload" href="/fonts/NotoSansKR-Light.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/NotoSansKR-Regular.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/NotoSansKR-Medium.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Montserrat-Light.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Montserrat-Regular.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="/fonts/Montserrat-Medium.woff" as="font" type="font/woff" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main class="css-0 ehqw8my2"><style data-emotion="css-global xxrc21">*{padding:0;margin:0;box-sizing:border-box;font-family:'Montserrat','NotoSansKR',sans-serif;}html,body,#___gatsby{height:100%;}a,a:hover{color:inherit;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;}</style><style data-emotion="css 1nbf1vk">.css-1nbf1vk{display:block;box-sizing:border-box;margin-left:auto;margin-right:auto;}@media (min-width: 1280px){.css-1nbf1vk{max-width:1280px;}}@media (min-width: 600px){.css-1nbf1vk{padding-left:24px;padding-right:24px;}}</style><div class="css-1nbf1vk ehqw8my0"><style data-emotion="css 18t9t75">.css-18t9t75{display:block;box-sizing:border-box;margin-left:auto;margin-right:auto;width:100%;height:60px;left:50%;z-index:300;position:fixed;-webkit-transform:translateX(-50%);-moz-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);background-color:rgba(255, 255, 255, 0.85);}@media (min-width: 1280px){.css-18t9t75{width:1280px;}}@media (min-width: 600px){.css-18t9t75{padding-left:24px;padding-right:24px;}}</style><header class="css-18t9t75 e13pdw5r2"><style data-emotion="css bjn8wh">.css-bjn8wh{position:relative;}</style><div class="css-bjn8wh e13pdw5r1"><style data-emotion="css 15d8atp">.css-15d8atp{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;box-sizing:border-box;}</style><div class="css-15d8atp e13pdw5r0"><button class="css-0 e1t79fam0"><style data-emotion="css k3xseg">.css-k3xseg{margin:0;box-sizing:border-box;}@media (min-width: 1280px){.css-k3xseg{-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:16.666667%;-webkit-flex-basis:16.666667%;-ms-flex-preferred-size:16.666667%;flex-basis:16.666667%;}}</style><div class="css-k3xseg e1t79fam1"><svg class="ham ham3 " viewBox="0 0 100 100"><path class="line top" d="m 70,33 h -40 c -11.092231,0 11.883874,13.496726 -3.420361,12.956839 -0.962502,-2.089471 -2.222071,-3.282996 -4.545687,-3.282996 -2.323616,0 -5.113897,2.622752 -5.113897,7.071068 0,4.448316 2.080609,7.007933 5.555839,7.007933 2.401943,0 2.96769,-1.283974 4.166879,-3.282995 2.209342,0.273823 4.031294,1.642466 5.857227,-0.252538 v -13.005715 16.288404 h 7.653568"></path><path class="line middle" d="m 70,50 h -40 c -5.6862,0 -8.534259,5.373483 -8.534259,11.551069 0,7.187738 3.499166,10.922274 13.131984,10.922274 11.021777,0 7.022787,-15.773343 15.531095,-15.773343 3.268142,0 5.177031,-2.159429 5.177031,-6.7 0,-4.540571 -1.766442,-7.33533 -5.087851,-7.326157 -3.321409,0.0092 -5.771288,2.789632 -5.771288,7.326157 0,4.536525 2.478983,6.805271 5.771288,6.7"></path><path class="line bottom" d="m 70,67 h -40 c 0,0 -3.680675,0.737051 -3.660714,-3.517857 0.02541,-5.415597 3.391687,-10.357143 10.982142,-10.357143 4.048418,0 17.88928,0.178572 23.482143,0.178572 0,2.563604 2.451177,3.403635 4.642857,3.392857 2.19168,-0.01078 4.373905,-1.369814 4.375,-3.392857 0.0011,-2.023043 -1.924401,-2.589191 -4.553571,-4.107143 -2.62917,-1.517952 -4.196429,-1.799562 -4.196429,-3.660714 0,-1.861153 2.442181,-3.118811 4.196429,-3.035715 1.754248,0.0831 4.375,0.890841 4.375,3.125 2.628634,0 6.160714,0.267857 6.160714,0.267857 l -0.178571,-2.946428 10.178571,0 -10.178571,0 v 6.696428 l 8.928571,0 -8.928571,0 v 7.142858 l 10.178571,0 -10.178571,0"></path></svg></div></button><style data-emotion="css 1nszip5">.css-1nszip5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:5px;width:400px;height:60px;margin:auto;}@media (min-width: 1080px){.css-1nszip5{padding-left:10%;}}@media (max-width: 800px){.css-1nszip5{width:200px;}}</style><a class="css-1nszip5 e1fwesb65" href="/"><style data-emotion="css 1u78em1">.css-1u78em1{color:rgb(15, 90, 79, 1);cursor:pointer;position:relative;}.css-1u78em1:hover>div:nth-of-type(2){-webkit-clip-path:polygon(0% 100%, 0% 0%, 100% 0%, 100% 100%);clip-path:polygon(0% 100%, 0% 0%, 100% 0%, 100% 100%);}.css-1u78em1:hover>div:nth-of-type(1){-webkit-transform:translateY(-9em);-moz-transform:translateY(-9em);-ms-transform:translateY(-9em);transform:translateY(-9em);}@media (max-width: 800px){.css-1u78em1:hover>div:nth-of-type(1){-webkit-transform:translateY(-7em);-moz-transform:translateY(-7em);-ms-transform:translateY(-7em);transform:translateY(-7em);}}.css-1u78em1:hover>h1:nth-of-type(1)>div:nth-of-type(1){-webkit-transform:translateY(-4em);-moz-transform:translateY(-4em);-ms-transform:translateY(-4em);transform:translateY(-4em);}</style><div class="css-1u78em1 e1fwesb64"><style data-emotion="css 5cb1gm">.css-5cb1gm{position:relative;margin:0;padding:0;overflow:hidden;text-transform:uppercase;font-size:6em;-webkit-text-stroke:1px rgb(15, 90, 79, 1);}@media (max-width: 800px){.css-5cb1gm{font-size:5em;}}</style><h1 class="css-5cb1gm e1fwesb63">Ian&#x27;s Archive 🏃🏻<style data-emotion="css 14ciwg4">.css-14ciwg4{position:absolute;width:100%;bottom:-50;left:0;height:50px;background-color:rgb(15, 90, 79, 0.5);z-index:-1;-webkit-transition:-webkit-transform 400ms ease;transition:transform 400ms ease;}</style><div class="css-14ciwg4 e1fwesb62"></div></h1><style data-emotion="css 1pd7djw">.css-1pd7djw{position:absolute;width:100%;left:0;bottom:0.3em;height:3px;background-color:rgb(15, 90, 79, 1);z-index:5;-webkit-transition:-webkit-transform 580ms cubic-bezier(0.2, 0.1, 0.15, 1.32);transition:transform 580ms cubic-bezier(0.2, 0.1, 0.15, 1.32);}</style><div class="css-1pd7djw e1fwesb61"></div><style data-emotion="css rlaz8p">.css-rlaz8p{position:absolute;margin:0;padding:0;text-transform:uppercase;font-size:6em;top:0;background-color:rgb(15, 90, 79, 0.5);-webkit-clip-path:polygon(0% 100%, 0% 99%, 100% 99%, 100% 100%);clip-path:polygon(0% 100%, 0% 99%, 100% 99%, 100% 100%);-webkit-transition:clip-path 600ms cubic-bezier(0.2, 0.1, 0.15, 1.32);transition:clip-path 600ms cubic-bezier(0.2, 0.1, 0.15, 1.32);}</style><div class="css-rlaz8p e1fwesb60"></div></div></a><div class="css-k3xseg e1gwwbl92"><style data-emotion="css 1au76bc">@media (max-width: 1080px){.css-1au76bc{display:none;}}</style><div class="css-1au76bc e1gwwbl91"><style data-emotion="css 18nc3u2">.css-18nc3u2.Mui-focused .MuiAutocomplete-clearIndicator{visibility:visible;}@media (pointer: fine){.css-18nc3u2:hover .MuiAutocomplete-clearIndicator{visibility:visible;}}.css-18nc3u2 .MuiAutocomplete-tag{margin:3px;max-width:calc(100% - 6px);}.css-18nc3u2 .MuiAutocomplete-inputRoot{-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.MuiAutocomplete-hasPopupIcon.css-18nc3u2 .MuiAutocomplete-inputRoot,.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiAutocomplete-inputRoot{padding-right:30px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiAutocomplete-inputRoot{padding-right:56px;}.css-18nc3u2 .MuiAutocomplete-inputRoot .MuiAutocomplete-input{width:0;min-width:30px;}.css-18nc3u2 .MuiInput-root{padding-bottom:1px;}.css-18nc3u2 .MuiInput-root .MuiInput-input{padding:4px 4px 4px 0px;}.css-18nc3u2 .MuiInput-root.MuiInputBase-sizeSmall .MuiInput-input{padding:2px 4px 3px 0;}.css-18nc3u2 .MuiOutlinedInput-root{padding:9px;}.MuiAutocomplete-hasPopupIcon.css-18nc3u2 .MuiOutlinedInput-root,.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiOutlinedInput-root{padding-right:39px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiOutlinedInput-root{padding-right:65px;}.css-18nc3u2 .MuiOutlinedInput-root .MuiAutocomplete-input{padding:7.5px 4px 7.5px 5px;}.css-18nc3u2 .MuiOutlinedInput-root .MuiAutocomplete-endAdornment{right:9px;}.css-18nc3u2 .MuiOutlinedInput-root.MuiInputBase-sizeSmall{padding-top:6px;padding-bottom:6px;padding-left:6px;}.css-18nc3u2 .MuiOutlinedInput-root.MuiInputBase-sizeSmall .MuiAutocomplete-input{padding:2.5px 4px 2.5px 8px;}.css-18nc3u2 .MuiFilledInput-root{padding-top:19px;padding-left:8px;}.MuiAutocomplete-hasPopupIcon.css-18nc3u2 .MuiFilledInput-root,.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiFilledInput-root{padding-right:39px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-18nc3u2 .MuiFilledInput-root{padding-right:65px;}.css-18nc3u2 .MuiFilledInput-root .MuiFilledInput-input{padding:7px 4px;}.css-18nc3u2 .MuiFilledInput-root .MuiAutocomplete-endAdornment{right:9px;}.css-18nc3u2 .MuiFilledInput-root.MuiInputBase-sizeSmall{padding-bottom:1px;}.css-18nc3u2 .MuiFilledInput-root.MuiInputBase-sizeSmall .MuiFilledInput-input{padding:2.5px 4px;}.css-18nc3u2 .MuiInputBase-hiddenLabel{padding-top:8px;}.css-18nc3u2 .MuiFilledInput-root.MuiInputBase-hiddenLabel{padding-top:0;padding-bottom:0;}.css-18nc3u2 .MuiFilledInput-root.MuiInputBase-hiddenLabel .MuiAutocomplete-input{padding-top:16px;padding-bottom:17px;}.css-18nc3u2 .MuiFilledInput-root.MuiInputBase-hiddenLabel.MuiInputBase-sizeSmall .MuiAutocomplete-input{padding-top:8px;padding-bottom:9px;}.css-18nc3u2 .MuiAutocomplete-input{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;opacity:1;}</style><div class="MuiAutocomplete-root MuiAutocomplete-hasPopupIcon css-18nc3u2"><div class="search-input-wrapper"><style data-emotion="css feqhe6">.css-feqhe6{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;min-width:0;padding:0;margin:0;border:0;vertical-align:top;width:100%;}</style><div class="MuiFormControl-root MuiFormControl-fullWidth MuiTextField-root search-input css-feqhe6"><style data-emotion="css-global 1prfaxn">@-webkit-keyframes mui-auto-fill{from{display:block;}}@keyframes mui-auto-fill{from{display:block;}}@-webkit-keyframes mui-auto-fill-cancel{from{display:block;}}@keyframes mui-auto-fill-cancel{from{display:block;}}</style><style data-emotion="css 12rx5qu">.css-12rx5qu{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.4375em;letter-spacing:0.00938em;color:rgba(0, 0, 0, 0.87);box-sizing:border-box;position:relative;cursor:text;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;position:relative;}.css-12rx5qu.Mui-disabled{color:rgba(0, 0, 0, 0.38);cursor:default;}label+.css-12rx5qu{margin-top:16px;}.css-12rx5qu:after{border-bottom:2px solid #1976d2;left:0;bottom:0;content:"";position:absolute;right:0;-webkit-transform:scaleX(0);-moz-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);-webkit-transition:-webkit-transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;transition:transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;pointer-events:none;}.css-12rx5qu.Mui-focused:after{-webkit-transform:scaleX(1) translateX(0);-moz-transform:scaleX(1) translateX(0);-ms-transform:scaleX(1) translateX(0);transform:scaleX(1) translateX(0);}.css-12rx5qu.Mui-error:before,.css-12rx5qu.Mui-error:after{border-bottom-color:#d32f2f;}.css-12rx5qu:before{border-bottom:1px solid rgba(0, 0, 0, 0.42);left:0;bottom:0;content:"\00a0";position:absolute;right:0;-webkit-transition:border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;pointer-events:none;}.css-12rx5qu:hover:not(.Mui-disabled, .Mui-error):before{border-bottom:2px solid rgba(0, 0, 0, 0.87);}@media (hover: none){.css-12rx5qu:hover:not(.Mui-disabled, .Mui-error):before{border-bottom:1px solid rgba(0, 0, 0, 0.42);}}.css-12rx5qu.Mui-disabled:before{border-bottom-style:dotted;}</style><div class="MuiInputBase-root MuiInput-root MuiInput-underline MuiInputBase-colorPrimary MuiInputBase-fullWidth MuiInputBase-formControl MuiInputBase-adornedEnd MuiAutocomplete-inputRoot css-12rx5qu"><style data-emotion="css mnn31">.css-mnn31{font:inherit;letter-spacing:inherit;color:currentColor;padding:4px 0 5px;border:0;box-sizing:content-box;background:none;height:1.4375em;margin:0;-webkit-tap-highlight-color:transparent;display:block;min-width:0;width:100%;-webkit-animation-name:mui-auto-fill-cancel;animation-name:mui-auto-fill-cancel;-webkit-animation-duration:10ms;animation-duration:10ms;}.css-mnn31::-webkit-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31::-moz-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31:-ms-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31::-ms-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31:focus{outline:0;}.css-mnn31:invalid{box-shadow:none;}.css-mnn31::-webkit-search-decoration{-webkit-appearance:none;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-webkit-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-moz-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:-ms-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-ms-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-webkit-input-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-moz-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus:-ms-input-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-ms-input-placeholder{opacity:0.42;}.css-mnn31.Mui-disabled{opacity:1;-webkit-text-fill-color:rgba(0, 0, 0, 0.38);}.css-mnn31:-webkit-autofill{-webkit-animation-duration:5000s;animation-duration:5000s;-webkit-animation-name:mui-auto-fill;animation-name:mui-auto-fill;}</style><input aria-invalid="false" autoComplete="off" id=":R9nadp:" type="text" class="MuiInputBase-input MuiInput-input MuiInputBase-inputAdornedEnd MuiAutocomplete-input MuiAutocomplete-inputFocused css-mnn31" aria-autocomplete="list" aria-expanded="false" autoCapitalize="none" spellcheck="false" role="combobox" value=""/><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium search-icon css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="SearchOutlinedIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></div></div></div></div></div><style data-emotion="css ea3a7p">.css-ea3a7p{display:none;}@media (max-width: 1080px){.css-ea3a7p{display:block;margin-right:10px;}}</style><style data-emotion="css 12mi4wr">.css-12mi4wr{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;display:none;}@media (max-width: 1080px){.css-12mi4wr{display:block;margin-right:10px;}}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium search-icon-view e1gwwbl90 css-12mi4wr" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="SearchOutlinedIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></div></div></div></header><style data-emotion="css r7zow1">.css-r7zow1{padding-top:80px;}</style><div class="css-r7zow1 ehqw8my1"><style data-emotion="css 1814s1h">.css-1814s1h{position:relative;width:100%;height:500px;}@media (max-width: 768px){.css-1814s1h{height:450px;}}</style><div class="css-1814s1h e1ko9e221"><style data-emotion="css 1pddym1">.css-1pddym1{display:block;position:relative;z-index:-1;width:100%;height:400px;margin-bottom:16px;}@media (max-width: 768px){.css-1pddym1{height:300px;}}</style><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained css-1pddym1 e1ko9e220"><div style="max-width:400px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;400&#x27;%20width=&#x27;400&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADlElEQVR42nVUTYgcRRTuza6JICoSQnR35r3qmVExEpCI6EFJ0JNHhQWDSMxFEREJY9frn9npRGO8KCKIoOLFg5DxoiIzu13V0z3jTMy6bn5MICiIt2AkQS+CujNbUt3TbWczFjy6qH7vq/e+974yjC1LKWNmsWXMFs8WW3u2+xf3bC+e+b6xzVfGtjTImDGmrcTJT51IVPaSgOM8AMEFXOIB/sgF9EjAu1an/NgkJLlcTQPMgOzV+Z1c4McU4oa/aqrGkCm3z5TbY6oxYEqfOREqK4C216uWXVlasAQ8W8T4D2y5VLO7ePHod6aiEMdc4AZJHHGJY23JXuCG3jdPmcru4mUrgBMUQsMa3HurUazfFvM73RjPNb81FRf4D0ncJIlq8t0kkRpPQGHkfcOUE+Nf1MEDFMLjboQPpNlNiLW78EGSWQqmeJrZSO/tEHU2SalLQ3MzvRTO2ivwoI614oW7nRifzvnjYfl+J2J/6kCusxA4bgxNpQM10CSrv7nEqyRQ8hAP+xHenMW/9QPc4fTxmRzQ66OryeYBbNhdHGvySWCfJLzsBPCE1YF9dlSt+adrt2UU6c76hXHyIjxIonJ7AuhE+MXSKVPzNXJjHFHIXsnGYtqc+tH+uSSuXdtlC/OehLIQnrMG5fmEQwpxLR0LU/N1TDu0WsasHxlzes60TzIJOjsNOOHdCvCg24G70qayQzyqlQwdYEtcSzOEK440dxebdcPgR0aSHQ/wMBfsUPbPjfB5PZNpyV388o0zFcUDFFMElKhBA2WKoKD8Kg/gk8xBV+P12Is5h16fNd88X9XdFKl2NcD+uVzTEyCnfecukniSBLTrK7tvyZs6KFepi/U8BVfCPidiY5LwhxcyLKpHZ2YL8yEu8H2SeI0kfqQ7qy/78HvjpoQ/iR6X+GTetUnZn564UFVeD2W9gwdsAS+QhM+4xJ+5gN9JQECi8mje6fwRwZdI4OfXjUHaJajYITtLAdZtCWeWholq1i3JmiRKe3WTFluLs1qiPMD7aAWfIgnLFMKV19rl6nWPQ8bREVla4O1ayeuz9VQ18EtiEn/T5fIQr1KI17Rqjp+rqsYAf61/ncrvhqnINb1cqlkCv7JjHL++XlFHV021NGSJNU+b6tiaqZw4UdJJKyjPZ0383wc213eEj5CEd0hCTAJ/IqkNYlvA23aXPZxVVoyZutRWJ2XMvNeu7dBWfOpz9WxZ/wJwOf3zP7mVigAAAABJRU5ErkJggg==" alt=""/><picture><source type="image/webp" data-srcset="/static/daf23c051d1970bd74a5bdb9fe7de872/e64f1/thumbnail.webp 100w,/static/daf23c051d1970bd74a5bdb9fe7de872/8b00d/thumbnail.webp 200w,/static/daf23c051d1970bd74a5bdb9fe7de872/9c0a1/thumbnail.webp 400w" sizes="(min-width: 400px) 400px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 400px) 400px, 100vw" decoding="async" loading="lazy" data-src="/static/daf23c051d1970bd74a5bdb9fe7de872/5f2c3/thumbnail.png" data-srcset="/static/daf23c051d1970bd74a5bdb9fe7de872/90cd3/thumbnail.png 100w,/static/daf23c051d1970bd74a5bdb9fe7de872/614dc/thumbnail.png 200w,/static/daf23c051d1970bd74a5bdb9fe7de872/5f2c3/thumbnail.png 400w" alt="thumbnail"/></picture><noscript><picture><source type="image/webp" srcSet="/static/daf23c051d1970bd74a5bdb9fe7de872/e64f1/thumbnail.webp 100w,/static/daf23c051d1970bd74a5bdb9fe7de872/8b00d/thumbnail.webp 200w,/static/daf23c051d1970bd74a5bdb9fe7de872/9c0a1/thumbnail.webp 400w" sizes="(min-width: 400px) 400px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 400px) 400px, 100vw" decoding="async" loading="lazy" src="/static/daf23c051d1970bd74a5bdb9fe7de872/5f2c3/thumbnail.png" srcSet="/static/daf23c051d1970bd74a5bdb9fe7de872/90cd3/thumbnail.png 100w,/static/daf23c051d1970bd74a5bdb9fe7de872/614dc/thumbnail.png 200w,/static/daf23c051d1970bd74a5bdb9fe7de872/5f2c3/thumbnail.png 400w" alt="thumbnail"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><div class="css-0 e14q160m2"><div class="css-0 e14q160m1">스프링 부트 핵심 원리와 활용 - 김영한 정리</div><div class="css-0 e14q160m0"><div>Spring</div><div>2025.02.18.</div></div></div></div><div class="css-0 e1iookw10"><style data-emotion="css 3xu06b">.css-3xu06b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;box-sizing:border-box;padding-top:40px;}</style><div class="css-3xu06b e1iookw14"><style data-emotion="css 1bpnp70">.css-1bpnp70{width:75%;padding:8px;}@media (max-width: 1080px){.css-1bpnp70{width:100%;}}</style><div class="markdown css-1bpnp70 e1iookw13"><h1 id="스프링-부트-소개" style="position:relative;"><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8-%EC%86%8C%EA%B0%9C" aria-label="스프링 부트 소개 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스프링 부트 소개</h1>
<p>스프링 프레임워크</p>
<p>핵심 기술 - 스프링 DI컨테이너, AOP, 이벤트<br>
웹 기술 - 스프링 MVC, 스프링 WebFlux<br>
데이터 접근 기술 - 트랜잭션, JDBC, ORM, XML<br>
기술 통합 - 캐시, 이메일, 원격접근, 스케줄링<br>
테스트 - 스프링 기반 테스트 지원</p>
<p>스프링 생태계</p>
<ul>
<li>스프링 데이터, 스프링 세션, 스프링 시큐리티, 스프링 Rest Docs, 스프링 배치, 스프링 클라우드</li>
</ul>
<p>설정이 점점 늘어나고, 어려워짐</p>
<p>스프링 부트</p>
<ul>
<li>스프링을 편리하게 사용할 수 있도록 지원, 최근에는 기본으로 사용</li>
<li>단독으로 실행할 수 있는 스프링 애플리케이션을 쉽게 생성</li>
<li>관례에 의한 간결한 설정</li>
</ul>
<p>스프링 부트 - 5가지 핵심 기능</p>
<ul>
<li>내장 서버 (WAS)
<ul>
<li>Tomcat같은 웹서버를 내장해서 별도의 웹 서버를 설치하지 않아도 된다.</li>
</ul>
</li>
<li>자동 라이브러리 관리
<ul>
<li>손쉬운 빌드 구성을 위한 스타터 종속성 제공</li>
<li>스프링과 외부 라이브러리의 버전을 자동으로 관리</li>
</ul>
</li>
<li>자동 구성
<ul>
<li>프로젝트 시작에 필요한 스프링과 외부 라이브러리의 빈을 자동 등록</li>
</ul>
</li>
<li>외부 설정
<ul>
<li>환경에 따라 달라져야 하는 외부 설정 공통화</li>
</ul>
</li>
<li>모니터링과 관리 기능 (프로덕션 준비)
<ul>
<li>모니터링을 위한 메트릭, 상태확인 기능 제공</li>
</ul>
</li>
</ul>
<h1 id="웹-서버와-서블릿-컨테이너" style="position:relative;"><a href="#%EC%9B%B9-%EC%84%9C%EB%B2%84%EC%99%80-%EC%84%9C%EB%B8%94%EB%A6%BF-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88" aria-label="웹 서버와 서블릿 컨테이너 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>웹 서버와 서블릿 컨테이너</h1>
<p>전통적인 방식</p>
<ul>
<li>WAS설치</li>
<li>WAS에서 동작하도록 서블릿 스펙에 맞춰 코드 작성</li>
<li>WAR형식으로 빌드해서 WAR파일 생성</li>
</ul>
<p>최근 방식</p>
<ul>
<li>스프링 부트가 내장 톰캣을 포함</li>
<li>코드 작성, JAR로 빌드 -> JAR을 원하는 위치에서 실행</li>
<li>WAS도 함께 실행된다.</li>
</ul>
<h4 id="jar-vs-war" style="position:relative;"><a href="#jar-vs-war" aria-label="jar vs war permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JAR vs WAR</h4>
<p>JAR</p>
<ul>
<li>자바는 여러 클래스와 리소스를 묶어서 JAR라고 하는 압축 파일을 만들 수 있다.</li>
<li>이 파일은 JVM위에서 직접 실행되거나 또는 다른 곳에서 사용하는 라이브러리로 제공된다.</li>
<li>직접 실행하는 경우 main() 메서드가 필요하고, <code>MANIFEST.MF</code>파일에 실행할 메인 메서드가 있는 클래스에 지정해두어야 한다.</li>
<li>쉽게 이야기 해서 <strong>클래스와 관련 리소스를 압축한 단순한 파일</strong></li>
</ul>
<p>WAR(Web Application Archive)</p>
<ul>
<li>웹 어플리케이션 서버(WAS)에 배포할 때 사용하는 파일</li>
<li>JAR파일이 JVM위에서 실행된다면, WAR는 웹 애플리케이션 서버 위에서 실행</li>
<li>WAR구조를 지켜야 한다.
<ul>
<li>WEB-INF
<ul>
<li>classes : 실행 클래스 모음</li>
<li>lib : 라이브러리 모음</li>
<li>web.xml : 웹 서버 배치 설정 파일(생략 가능)</li>
</ul>
</li>
<li>index.html : 정적 리소스</li>
<li>WEB-INF 폴더 하위는 자바 클래스와 라이브러리, 그리고 설정 정보가 들어가는 곳이다.</li>
<li>WEB-INF 를 제외한 나머지 영역은 HTML, CSS 같은 정적 리소스가 사용되는 영역이다.</li>
</ul>
</li>
</ul>
<p>WAR파일 배포 순서</p>
<ol>
<li>톰캣 서버를 종료한다. ./shutdown.sh</li>
<li>톰캣폴더/webapps 하위를 모두 삭제한다.</li>
<li>빌드된 server-0.0.1-SNAPSHOT.war 를 복사한다.</li>
<li>톰캣폴더/webapps 하위에 붙여넣는다.</li>
</ol>
<ul>
<li>톰캣폴더/webapps/server-0.0.1-SNAPSHOT.war</li>
</ul>
<ol start="5">
<li>이름을 변경한다.</li>
</ol>
<ul>
<li>톰캣폴더/webapps/ROOT.war</li>
</ul>
<ol start="6">
<li>톰캣 서버를 실행한다. ./startup.sh</li>
</ol>
<h4 id="서블릿-컨테이너-초기화" style="position:relative;"><a href="#%EC%84%9C%EB%B8%94%EB%A6%BF-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EC%B4%88%EA%B8%B0%ED%99%94" aria-label="서블릿 컨테이너 초기화 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>서블릿 컨테이너 초기화</h4>
<ul>
<li>WAS를 실행하는 시점에 필요한 초기화 작업들이 있다S.
<ul>
<li>서비스에 필요한 필터와 서블릿 등록</li>
<li>스프링 컨테이너 생성</li>
<li>서블릿과 스프링을 연결하는 디스패처 서블릿 등록</li>
</ul>
</li>
<li>WAS가 제공하는 초기화 기능을 사용하면, WAS실행 시점에 이러한 초기화 과정을 진행할 수 있다.</li>
<li>과거에는 <code>web.xml</code>을 사용해 초기화했지만, 지금은 서블릿 스펙에서 자바 코드를 사용한 초기화도 지원한다.</li>
</ul>
<p>서블릿을 등록하는 2가지 방법 존재</p>
<ul>
<li>@WebServlet 애노테이션</li>
<li>프로그래밍 방식</li>
</ul>
<p>초기화는 다음 순서로 진행된다.</p>
<ol>
<li>서블릿 컨테이너 초기화 실행</li>
</ol>
<ul>
<li>resources/META-INF/services/</li>
<li>jakarta.servlet.ServletContainerInitializer</li>
</ul>
<ol start="2">
<li>애플리케이션 초기화 실행</li>
</ol>
<ul>
<li>@HandlesTypes(AppInit.class)</li>
</ul>
<p>서블릿 컨테이너 초기화만 있어도 될 것 같은데, 왜 이렇게 복잡하게 애플리케이션 초기화라는 개념을 만들었을까?</p>
<p>편리함</p>
<ul>
<li>애플리케이션 초기화는 특정 인터페이스만 구현하면 된다.</li>
</ul>
<p>의존성</p>
<ul>
<li>애플리케이션 초기화는 서블릿 컨테이너에 상관없이 원하는 모양으로 인터페이스를 만들 수 있다.</li>
<li>이를 통해 애플리케이션 초기화 코드가 서블릿 컨테이너에 대한 의존을 줄일 수 있다.</li>
</ul>
<p>필요한 과정은 애플리케이션 초기화에 모두 넣어주면 된다.</p>
<h4 id="스프링-컨테이너-등록" style="position:relative;"><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EB%93%B1%EB%A1%9D" aria-label="스프링 컨테이너 등록 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스프링 컨테이너 등록</h4>
<p>앞서 배운 서블릿 컨테이너 초기화와 애플리케이션 초기화를 활용하면 된다.</p>
<p>다음과 같은 과정이 필요할 것이다.</p>
<ul>
<li>스프링 컨테이너 만들기</li>
<li>스프링MVC 컨트롤러를 스프링 컨테이너에 빈으로 등록하기</li>
<li>스프링MVC를 사용하는데 필요한 디스패처 서블릿을 서블릿 컨테이너 등록하기</li>
</ul>
<p>스프링 컨테이너 생성</p>
<ul>
<li>AnnotationConfigWebApplicationContext 가 바로 스프링 컨테이너이다.
<ul>
<li>AnnotationConfigWebApplicationContext 부모를 따라가 보면</li>
<li>ApplicationContext 인터페이스를 확인할 수 있다.
<ul>
<li>이 구현체는 이름 그대로 애노테이션 기반 설정과 웹 기능을 지원하는 스프링 컨테이너로 이해하면 된다.</li>
</ul>
</li>
<li>appContext.register(HelloConfig.class)
<ul>
<li>컨테이너에 스프링 설정을 추가한다.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>스프링 MVC 디스패처 서블릿 생성, 스프링 컨테이너 연결</p>
<ul>
<li>new DispatcherServlet(appContext)</li>
<li>코드를 보면 스프링 MVC가 제공하는 디스패처 서블릿을 생성하고, 생성자에 앞서 만든 스프링 컨테이너를 전달하는 것을 확인할 수 있다. 이렇게 하면 디스패처 서블릿에 스프링 컨테이너가 연결된다.</li>
<li>이 디스패처 서블릿에 HTTP 요청이 오면 디스패처 서블릿은 해당 스프링 컨테이너에 들어있는 컨트롤러 빈들을 호출한다.</li>
</ul>
<p>디스패처 서블릿을 서블릿 컨테이너에 등록</p>
<ul>
<li>servletContext.addServlet(“dispatcherV2”, dispatcher)
<ul>
<li>디스패처 서블릿을 서블릿 컨테이너에 등록한다.</li>
</ul>
</li>
<li>/spring/_ 요청이 디스패처 서블릿을 통하도록 설정
<ul>
<li>/spring/_ 이렇게 경로를 지정하면 /spring 과 그 하위 요청은 모두 해당 서블릿을 통하게 된다.
<ul>
<li>/spring/hello-spring</li>
<li>/spring/hello/go</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/9ecab770ced1a928462e3cb22a9d5338/d853e/1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 59.50920245398773%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABu0lEQVR42mWTWW/CMBCE8/9f+ntAlVBfeChCDQn3fYSE+74TmOrbKhS1kQav1+vx7Ng4evkej4fu97vFs6irz/c3hcFArltSs9lUq9XScDhUGIZWm+55/Rx+4jjWcrnUarWyMQjGqvhfqnkfisJAo9FI4/HYABmg7hXsPZ/PP4TX69WKDoeDZrOZttut4jhRnDx0u910uVysGBAjIM0xUjOZTLTZbH4JoyhSt9tVp9PRfD63OSczsp5+u91O7Xbb8ovFwojW67Xln4QooigIAvV6PfOqVquZX4D11Bo6qVarajQaBvZhBcTUOchFCT55nqdKpaJcLqdsNqtCoaByuWxrmM8m1CdJonw+r0wmYyS0DfF+v5dDAi84hTaY4yMxBcSMEEJEfDwenzXEgINMIb1zGbTIKXzpBZCnfWygdZRACjkx4Jkx55aNkARm4gut1et1axO4rmvK8Rby6XRqMWvYUSwWzSaU8k6tZRThI2ZzCj4RUwQ4bDAYWI4ueAnEEAHf962G18Gt/3uHabvgdDoZ+v2+KUA9CjmgVCpZV4xYwjqX+/ynYDLA3L9AOW8NJWmOeZpHGXv5p3wDO32CjwF8KbMAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/9ecab770ced1a928462e3cb22a9d5338/a81b5/1.webp 163w,
/static/9ecab770ced1a928462e3cb22a9d5338/da3ef/1.webp 325w,
/static/9ecab770ced1a928462e3cb22a9d5338/309d5/1.webp 650w,
/static/9ecab770ced1a928462e3cb22a9d5338/78344/1.webp 975w,
/static/9ecab770ced1a928462e3cb22a9d5338/bdb72/1.webp 1300w,
/static/9ecab770ced1a928462e3cb22a9d5338/9a639/1.webp 1436w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/9ecab770ced1a928462e3cb22a9d5338/5e043/1.png 163w,
/static/9ecab770ced1a928462e3cb22a9d5338/e5cc6/1.png 325w,
/static/9ecab770ced1a928462e3cb22a9d5338/663f3/1.png 650w,
/static/9ecab770ced1a928462e3cb22a9d5338/d880f/1.png 975w,
/static/9ecab770ced1a928462e3cb22a9d5338/4c573/1.png 1300w,
/static/9ecab770ced1a928462e3cb22a9d5338/d853e/1.png 1436w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/9ecab770ced1a928462e3cb22a9d5338/663f3/1.png"
            alt="1"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>/spring/hello-spring 실행을 /spring/* 패턴으로 호출했기 때문에 다음과 같이 동작한다.</p>
<ul>
<li>dispatcherV2 디스패처 서블릿이 실행된다. ( /spring )</li>
<li>dispatcherV2 디스패처 서블릿은 스프링 컨트롤러를 찾아서 실행한다. ( /hello-spring )
<ul>
<li>이때 서블릿을 찾아서 호출하는데 사용된 /spring 을 제외한 /hello-spring 가 매핑된 컨트롤러 HelloController )의 메서드를 찾아서 실행한다. (쉽게 이야기해서 뒤에 * 부분으로 스프링 컨트롤러를 찾는다.)</li>
</ul>
</li>
</ul>
<h4 id="스프링-mvc-서블릿-컨테이너-초기화-지원" style="position:relative;"><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-mvc-%EC%84%9C%EB%B8%94%EB%A6%BF-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EC%B4%88%EA%B8%B0%ED%99%94-%EC%A7%80%EC%9B%90" aria-label="스프링 mvc 서블릿 컨테이너 초기화 지원 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스프링 MVC 서블릿 컨테이너 초기화 지원</h4>
<p>서블릿 컨테이너 초기화 과정은 상당히 번거롭고 반복되는 작업이다.</p>
<p>스프링 MVC는 이러한 서블릿 컨테이너 초기화 작업을 이미 만들어두었다. 덕분에 개발자는 서블릿 컨테이너 초기화 과정은 생략하고, 애플리케이션 초기화 코드만 작성하면 된다.</p>
<p>스프링이 지원하는 애플리케이션 초기화를 사용하려면 다음 인터페이스를 구현하면 된다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="78260146739367900000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`package org.springframework.web;
public interface WebApplicationInitializer {
void onStartup(ServletContext servletContext) throws ServletException;
}`, `78260146739367900000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="0"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">package</span><span class="mtk1"> org.springframework.web;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">interface</span><span class="mtk1"> </span><span class="mtk10">WebApplicationInitializer</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">onStartup</span><span class="mtk1">(</span><span class="mtk10">ServletContext</span><span class="mtk1"> </span><span class="mtk12">servletContext</span><span class="mtk1">) </span><span class="mtk4">throws</span><span class="mtk1"> </span><span class="mtk10">ServletException</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="41826497673765495000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`package hello.container;

import hello.spring.HelloConfig;
import jakarta.servlet.ServletContext;
import jakarta.servlet.ServletException;
import jakarta.servlet.ServletRegistration;
import org.springframework.web.WebApplicationInitializer;
import org.springframework.web.context.support.AnnotationConfigWebApplicationContext;
import org.springframework.web.servlet.DispatcherServlet;

public class AppInitV3SpringMvc implements WebApplicationInitializer {
    @Override
    public void onStartup(ServletContext servletContext) throws ServletException
    {
        System.out.println(&quot;AppInitV3SpringMvc.onStartup&quot;);
        //스프링 컨테이너 생성
        AnnotationConfigWebApplicationContext appContext = new AnnotationConfigWebApplicationContext();
        appContext.register(HelloConfig.class);

        //스프링 MVC 디스패처 서블릿 생성, 스프링 컨테이너 연결
        DispatcherServlet dispatcher = new DispatcherServlet(appContext);

        //디스패처 서블릿을 서블릿 컨테이너에 등록 (이름 주의! dispatcherV3)
        ServletRegistration.Dynamic servlet = servletContext.addServlet(&quot;dispatcherV3&quot;, dispatcher);

        //모든 요청이 디스패처 서블릿을 통하도록 설정
        servlet.addMapping(&quot;/&quot;);
    }
}`, `41826497673765495000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="1"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">package</span><span class="mtk1"> hello.container;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> hello.spring.HelloConfig;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> jakarta.servlet.ServletContext;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> jakarta.servlet.ServletException;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> jakarta.servlet.ServletRegistration;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.springframework.web.WebApplicationInitializer;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.springframework.web.context.support.AnnotationConfigWebApplicationContext;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.springframework.web.servlet.DispatcherServlet;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">AppInitV3SpringMvc</span><span class="mtk1"> </span><span class="mtk4">implements</span><span class="mtk1"> </span><span class="mtk10">WebApplicationInitializer</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">onStartup</span><span class="mtk1">(</span><span class="mtk10">ServletContext</span><span class="mtk1"> </span><span class="mtk12">servletContext</span><span class="mtk1">) </span><span class="mtk4">throws</span><span class="mtk1"> </span><span class="mtk10">ServletException</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">    {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">System</span><span class="mtk1">.</span><span class="mtk12">out</span><span class="mtk1">.</span><span class="mtk11">println</span><span class="mtk1">(</span><span class="mtk8">&quot;AppInitV3SpringMvc.onStartup&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">//스프링 컨테이너 생성</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">AnnotationConfigWebApplicationContext</span><span class="mtk1"> </span><span class="mtk12">appContext</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">AnnotationConfigWebApplicationContext</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">appContext</span><span class="mtk1">.</span><span class="mtk11">register</span><span class="mtk1">(</span><span class="mtk12">HelloConfig</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="19"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="20"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">//스프링 MVC 디스패처 서블릿 생성, 스프링 컨테이너 연결</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="21"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">DispatcherServlet</span><span class="mtk1"> </span><span class="mtk12">dispatcher</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">DispatcherServlet</span><span class="mtk1">(appContext);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="22"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="23"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">//디스패처 서블릿을 서블릿 컨테이너에 등록 (이름 주의! dispatcherV3)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="24"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">ServletRegistration</span><span class="mtk1">.</span><span class="mtk10">Dynamic</span><span class="mtk1"> </span><span class="mtk12">servlet</span><span class="mtk1"> = </span><span class="mtk12">servletContext</span><span class="mtk1">.</span><span class="mtk11">addServlet</span><span class="mtk1">(</span><span class="mtk8">&quot;dispatcherV3&quot;</span><span class="mtk1">, dispatcher);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="25"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="26"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">//모든 요청이 디스패처 서블릿을 통하도록 설정</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="27"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">servlet</span><span class="mtk1">.</span><span class="mtk11">addMapping</span><span class="mtk1">(</span><span class="mtk8">&quot;/&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="28"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="29"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/eb392b351a0fac3e36a15c6b1796e9ff/ace50/2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 57.05521472392638%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACRUlEQVR42nWSyWsUQRTG56/Rg3fv3k1OgohHwZN6EASvXvSueBEFL+olAy5o3B2JBk3ESEJIJjPdk56leqmuXmfv6flJVTAQ0YLXFI/q771vqfDfMzffYT8ijXr0+0PSNCHPc4bDoal/ncrfjfF4bB5PJmOKYs7m2jO21qq09rvU67vsNfawWzbCFUwmE1Oj0YjBYMB0Oj0AnM/npmazGb1eD9/3aVgWDduiadvIUBEphVKKJE4YpCNE28NqWjSaDYQQBEGA53lHNyyKAikls6IgFC5JIFGuZwZpqpGKKMopqnSpB1t4gSDwA7Pdn38rmqKZnCSoKEJ0e0SjAVXR5E5zg0edXYJRn0hJhOPxuHmX0x+PsVA7zlPx4FBvTTcMQypZltFqtWi321i2zb5lse0LFj9XObn8kFPvn7Dud5HCxXV9/L7ga/CGL8FrwpEHJZRlaXQ0gNoAzT1NUybTKdL36eYJ13/VuPh9mSs/3tHMYiaDAVKF9Lo9Yi9BdhROy8GyLLOM4zhG+4pG1oJGUWQm7Fs2rUhy4fsyi7Ulzq0+Z0u6iHabnhCUs9JQ9FyfjtM1gHEcG7eNhnoz3dROaQ3bdou69Di/+oITL++zUFtiJ1MMshTH7vDWqXLt51murp9hJXx1aOihhvqiddTUtVui2yXIM+41NrixucLtnXXcYZ9+npFFOd+CD9zauczN7UusqU8m/+W8NPnVTI/ERourA6szN0kyiiRnmmbEoTKPZSjJwpxhMmYYj8lV/6AvpfFBA/4GIcspm4YGCLYAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/eb392b351a0fac3e36a15c6b1796e9ff/a81b5/2.webp 163w,
/static/eb392b351a0fac3e36a15c6b1796e9ff/da3ef/2.webp 325w,
/static/eb392b351a0fac3e36a15c6b1796e9ff/309d5/2.webp 650w,
/static/eb392b351a0fac3e36a15c6b1796e9ff/78344/2.webp 975w,
/static/eb392b351a0fac3e36a15c6b1796e9ff/bdb72/2.webp 1300w,
/static/eb392b351a0fac3e36a15c6b1796e9ff/68819/2.webp 1406w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/eb392b351a0fac3e36a15c6b1796e9ff/5e043/2.png 163w,
/static/eb392b351a0fac3e36a15c6b1796e9ff/e5cc6/2.png 325w,
/static/eb392b351a0fac3e36a15c6b1796e9ff/663f3/2.png 650w,
/static/eb392b351a0fac3e36a15c6b1796e9ff/d880f/2.png 975w,
/static/eb392b351a0fac3e36a15c6b1796e9ff/4c573/2.png 1300w,
/static/eb392b351a0fac3e36a15c6b1796e9ff/ace50/2.png 1406w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/eb392b351a0fac3e36a15c6b1796e9ff/663f3/2.png"
            alt="2"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>현재 등록된 서블릿 다음과 같다.</p>
<ul>
<li>/ = dispatcherV3</li>
<li>/spring/* = dispatcherV2</li>
<li>/hello-servlet = helloServlet</li>
<li>/test = TestServlet</li>
</ul>
<p>이런 경우 우선순위는 더 구체적인 것이 먼저 실행된다.</p>
<p>일반적으로는 스프링 컨테이너를 하나 만들고, 디스패처 서블릿도 하나만 만든다. 그리고 디스패처 서블릿의 경로 매핑도 / 로 해서 하나의 디스패처 서블릿을 통해서 모든 것을 처리하도록 한다.</p>
<p>spring-web 라이브러리를 열어보면 서블릿 컨테이너 초기화를 위한 등록 파일을 확인할 수 있다. 그리고 이곳에 서블릿 컨테이너 초기화 클래스가 등록되어 있다.</p>
<p>org.springframework.web.SpringServletContainerInitializer 코드를 확인해보자.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="92490950951008080000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@HandlesTypes(WebApplicationInitializer.class)
public class SpringServletContainerInitializer implements
ServletContainerInitializer {}`, `92490950951008080000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="2"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">HandlesTypes</span><span class="mtk1">(</span><span class="mtk12">WebApplicationInitializer</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">SpringServletContainerInitializer</span><span class="mtk1"> </span><span class="mtk4">implements</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk10">ServletContainerInitializer</span><span class="mtk1"> {}</span></span></span></code></pre>
<ul>
<li>코드를 보면 우리가 앞서 만든 서블릿 컨테이너 초기화 코드와 비슷한 것을 확인할 수 있다.</li>
<li>@HandlesTypes 의 대상이 WebApplicationInitializer 이다. 그리고 이 인터페이스의 구현체를 생성하고 실행하는 것을 확인할 수 있다. 우리는 앞서 이 인터페이스를 구현했다.</li>
</ul>
<h4 id="정리" style="position:relative;"><a href="#%EC%A0%95%EB%A6%AC" aria-label="정리 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정리</h4>
<p>스프링MVC도 우리가 지금까지 한 것 처럼 서블릿 컨테이너 초기화 파일에 초기화 클래스를 등록해두었다. 그리고 WebApplicationInitializer 인터페이스를 애플리케이션 초기화 인터페이스로 지정해두고, 이것을 생성해서
실행한다.</p>
<p>따라서 스프링 MVC를 사용한다면 WebApplicationInitializer 인터페이스만 구현하면 AppInitV3SpringMvc 에서 본 것 처럼 편리하게 애플리케이션 초기화를 사용할 수 있다.</p>
<hr>
<p>지금까지 알아본 내용은 모두 서블릿 컨테이너 위에서 동작하는 방법이다. 따라서 항상 톰캣 같은 서블릿 컨테이너에 배
포를 해야만 동작하는 방식이다.</p>
<p>과거에는 서블릿 컨테이너 위에서 모든 것이 동작했지만, 스프링 부트와 내장 톰캣을 사용하면서 이런 부분이 바뀌기 시
작했다.</p>
<h1 id="스프링-부트와-내장-톰캣" style="position:relative;"><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8%EC%99%80-%EB%82%B4%EC%9E%A5-%ED%86%B0%EC%BA%A3" aria-label="스프링 부트와 내장 톰캣 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스프링 부트와 내장 톰캣</h1>
<p>웹 애플리케이션을 개발하고 배포하려면 다음과 같은 과정을 거쳐야 한다.</p>
<ul>
<li>톰캣 같은 웹 애플리케이션 서버(WAS)를 별도로 설치해야 한다.</li>
<li>애플리케이션 코드를 WAR로 빌드해야 한다.</li>
<li>빌드한 WAR 파일을 WAS에 배포해야 한다.</li>
</ul>
<p>웹 애플리케이션을 구동하고 싶으면 웹 애플리케이션 서버를 별도로 설치해야 하는 구조이다.</p>
<p>단점</p>
<ul>
<li>톰캣 같은 WAS를 별도로 설치해야 한다.</li>
<li>개발 환경 설정이 복잡하다.
<ul>
<li>단순한 자바라면 별도의 설정을 고민하지 않고, main() 메서드만 실행하면 된다.</li>
<li>웹 애플리케이션은 WAS 실행하고 또 WAR와 연동하기 위한 복잡한 설정이 들어간다.</li>
</ul>
</li>
<li>배포 과정이 복잡하다. WAR를 만들고 이것을 또 WAS에 전달해서 배포해야 한다.</li>
<li>톰캣의 버전을 변경하려면 톰캣을 다시 설치해야 한다.</li>
</ul>
<p>=> 이런 문제를 해결하기 위해 톰캣을 라이브러리로 제공하는 내장 톰캣(embed tomcat) 기능을 제공한다</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3f04af53d295e1cae0a62d3a04107982/ced39/3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 37.423312883435585%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABaklEQVR42mVRPU/CUBR9JAwO4uDctQMDo8EPnPgBnfkV/AoZygaLgcTIzuDUpKQ0MjCV+AGKBWpCGEgMsZUWaiktx7wXi6g3ebnJueeee+67xLI+oL8849XQMRgMMZ/PEQQBfN9HGIbs7UZUW61WLK/Xa8ahOA3ieT7Umwv07yQ89YfodDR0u13ouo7xeAzLshhxs9mwbBgGq08mE0ynU8xmM5imyXAqTBzHhvn+hk/XAe0Jw4A108mu62KxWGzFlsslPM9jgxoNGc2mAlmWoWkawymXUBKN0ciAqqpotW6hKAp6vR7DqWi0tuM4LBeLIuLxODiOQyKRQDqd3nJJRMrn84jFYkilUiCEQBCErau/gte1Gniex+nJMZLJJHK53I9g5LDdbqNQKKBSqUAURUiS9M+hbdvfDovIHu0he8Zj/+AQ55nMb0G6e3Sl3WvSf6Gudh1S/PHhHlfVEqrVS5TKZdTrdXZxWv8CYa/h5pPVPQcAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/3f04af53d295e1cae0a62d3a04107982/a81b5/3.webp 163w,
/static/3f04af53d295e1cae0a62d3a04107982/da3ef/3.webp 325w,
/static/3f04af53d295e1cae0a62d3a04107982/309d5/3.webp 650w,
/static/3f04af53d295e1cae0a62d3a04107982/78344/3.webp 975w,
/static/3f04af53d295e1cae0a62d3a04107982/bdb72/3.webp 1300w,
/static/3f04af53d295e1cae0a62d3a04107982/8e4a1/3.webp 1408w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/3f04af53d295e1cae0a62d3a04107982/5e043/3.png 163w,
/static/3f04af53d295e1cae0a62d3a04107982/e5cc6/3.png 325w,
/static/3f04af53d295e1cae0a62d3a04107982/663f3/3.png 650w,
/static/3f04af53d295e1cae0a62d3a04107982/d880f/3.png 975w,
/static/3f04af53d295e1cae0a62d3a04107982/4c573/3.png 1300w,
/static/3f04af53d295e1cae0a62d3a04107982/ced39/3.png 1408w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/3f04af53d295e1cae0a62d3a04107982/663f3/3.png"
            alt="3"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<ul>
<li>왼쪽 그림은 웹 애플리케이션 서버에 WAR 파일을 배포하는 방식, WAS를 실행해서 동작한다.</li>
<li>오른쪽 그림은 애플리케이션 JAR 안에 다양한 라이브러리들과 WAS 라이브러리가 포함되는 방식, main() 메서드를 실행해서 동작한다.</li>
</ul>
<hr>
<h4 id="내장-톰캣-설정" style="position:relative;"><a href="#%EB%82%B4%EC%9E%A5-%ED%86%B0%EC%BA%A3-%EC%84%A4%EC%A0%95" aria-label="내장 톰캣 설정 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>내장 톰캣 설정</h4>
<blockquote>
<p>톰캣을 라이브러리로 포함하고 자바 코드로 직접 실행하는 것</p>
</blockquote>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="29141984009681486000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`package hello.embed;

import hello.servlet.HelloServlet;
import hello.spring.HelloConfig;
import org.apache.catalina.Context;
import org.apache.catalina.LifecycleException;
import org.apache.catalina.connector.Connector;
import org.apache.catalina.startup.Tomcat;
import org.springframework.web.context.support.AnnotationConfigWebApplicationContext;
import org.springframework.web.servlet.DispatcherServlet;

public class EmbedTomcatServletMain {

    public static void main(String[] args) throws LifecycleException {
        System.out.println(&quot;EmbedTomcatSpringMain.main&quot;);
        //톰캣 설정
        Tomcat tomcat = new Tomcat();
        Connector connector = new Connector();
        connector.setPort(8080);
        tomcat.setConnector(connector);

        //스프링 컨테이너 생성
        AnnotationConfigWebApplicationContext appContext = new
                AnnotationConfigWebApplicationContext();
        appContext.register(HelloConfig.class);

        //스프링 MVC 디스패처 서블릿 생성, 스프링 컨테이너 연결
        DispatcherServlet dispatcher = new DispatcherServlet(appContext);

        //디스패처 서블릿 등록
        Context context = tomcat.addContext(&quot;&quot;, &quot;/&quot;);
        tomcat.addServlet(&quot;&quot;, &quot;dispatcher&quot;, dispatcher);
        context.addServletMappingDecoded(&quot;/&quot;, &quot;dispatcher&quot;);

        tomcat.start();
    }
}`, `29141984009681486000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="3"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">package</span><span class="mtk1"> hello.embed;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> hello.servlet.HelloServlet;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> hello.spring.HelloConfig;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.apache.catalina.Context;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.apache.catalina.LifecycleException;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.apache.catalina.connector.Connector;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.apache.catalina.startup.Tomcat;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.springframework.web.context.support.AnnotationConfigWebApplicationContext;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.springframework.web.servlet.DispatcherServlet;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">EmbedTomcatServletMain</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">main</span><span class="mtk1">(</span><span class="mtk10">String</span><span class="mtk1">[] </span><span class="mtk12">args</span><span class="mtk1">) </span><span class="mtk4">throws</span><span class="mtk1"> </span><span class="mtk10">LifecycleException</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">System</span><span class="mtk1">.</span><span class="mtk12">out</span><span class="mtk1">.</span><span class="mtk11">println</span><span class="mtk1">(</span><span class="mtk8">&quot;EmbedTomcatSpringMain.main&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">//톰캣 설정</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">Tomcat</span><span class="mtk1"> </span><span class="mtk12">tomcat</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">Tomcat</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">Connector</span><span class="mtk1"> </span><span class="mtk12">connector</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">Connector</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="19"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">connector</span><span class="mtk1">.</span><span class="mtk11">setPort</span><span class="mtk1">(</span><span class="mtk7">8080</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="20"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">tomcat</span><span class="mtk1">.</span><span class="mtk11">setConnector</span><span class="mtk1">(connector);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="21"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="22"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">//스프링 컨테이너 생성</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="23"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">AnnotationConfigWebApplicationContext</span><span class="mtk1"> </span><span class="mtk12">appContext</span><span class="mtk1"> = </span><span class="mtk15">new</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="24"></span><span class="grvsc-source"><span class="mtk1">                </span><span class="mtk11">AnnotationConfigWebApplicationContext</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="25"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">appContext</span><span class="mtk1">.</span><span class="mtk11">register</span><span class="mtk1">(</span><span class="mtk12">HelloConfig</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="26"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="27"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">//스프링 MVC 디스패처 서블릿 생성, 스프링 컨테이너 연결</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="28"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">DispatcherServlet</span><span class="mtk1"> </span><span class="mtk12">dispatcher</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">DispatcherServlet</span><span class="mtk1">(appContext);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="29"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="30"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">//디스패처 서블릿 등록</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="31"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">Context</span><span class="mtk1"> </span><span class="mtk12">context</span><span class="mtk1"> = </span><span class="mtk12">tomcat</span><span class="mtk1">.</span><span class="mtk11">addContext</span><span class="mtk1">(</span><span class="mtk8">&quot;&quot;</span><span class="mtk1">, </span><span class="mtk8">&quot;/&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="32"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">tomcat</span><span class="mtk1">.</span><span class="mtk11">addServlet</span><span class="mtk1">(</span><span class="mtk8">&quot;&quot;</span><span class="mtk1">, </span><span class="mtk8">&quot;dispatcher&quot;</span><span class="mtk1">, dispatcher);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="33"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">context</span><span class="mtk1">.</span><span class="mtk11">addServletMappingDecoded</span><span class="mtk1">(</span><span class="mtk8">&quot;/&quot;</span><span class="mtk1">, </span><span class="mtk8">&quot;dispatcher&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="34"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="35"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">tomcat</span><span class="mtk1">.</span><span class="mtk11">start</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="36"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="37"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>스프링 컨테이너를 생성하고, 내장 톰캣에 디스패처 서블릿을 등록했다</p>
<p>main() 메서드를 실행하면 다음과 같이 동작한다.</p>
<ul>
<li>내장 톰캣을 생성해서 8080 포트로 연결하도록 설정한다.</li>
<li>스프링 컨테이너를 만들고 필요한 빈을 등록한다.</li>
<li>스프링 MVC 디스패처 서블릿을 만들고 앞서 만든 스프링 컨테이너에 연결한다.</li>
<li>디스패처 서블릿을 내장 톰캣에 등록한다.</li>
<li>내장 톰캣을 실행한다.</li>
</ul>
<h4 id="내장-톰캣---빌드와-배포" style="position:relative;"><a href="#%EB%82%B4%EC%9E%A5-%ED%86%B0%EC%BA%A3---%EB%B9%8C%EB%93%9C%EC%99%80-%EB%B0%B0%ED%8F%AC" aria-label="내장 톰캣   빌드와 배포 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>내장 톰캣 - 빌드와 배포</h4>
<p>자바의 main() 메서드를 실행하기 위해선 <code>jar</code>형식으로 빌드해야 한다.</p>
<p>그리고 <code>jar</code>안에 <code>META-INF/MANIFEST.MF</code>파일에 실행 할 <code>main()</code>메서드의 클래스를 지정해주어야 한다.</p>
<p>Gradle의 도움을 받으면 이 과정을 쉽게 진행할 수 있다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="36019611098390516000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`task buildJar(type: Jar) {
  manifest {
    attributes 'Main-Class': 'hello.embed.EmbedTomcatSpringMain'
  }
  with jar
}`, `36019611098390516000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="groovy" data-index="4"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">task buildJar(type: </span><span class="mtk10">Jar</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">  manifest {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    attributes </span><span class="mtk8">&#39;Main-Class&#39;</span><span class="mtk1">: </span><span class="mtk8">&#39;hello.embed.EmbedTomcatSpringMain&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">  }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">  with jar</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>jar파일을 압축을 풀고 살펴보면 spring이나 tomcat관련 코드들이 없다.</p>
<p>jar 파일은 jar파일을 포함할 수 없다.</p>
<ul>
<li>WAR와 다르게 JAR 파일은 내부에 라이브러리 역할을 하는 JAR 파일을 포함할 수 없다.</li>
<li>포함한다고 해도 인식이 안된다. 이것이 JAR 파일 스펙의 한계이다.</li>
<li>그렇다고 WAR를 사용할 수 도 없다. WAR는 웹 애플리케이션 서버(WAS) 위에서만 실행할 수 있다.</li>
</ul>
<p>대안으로는 fat jar 또는 uber jar 라고 불리는 방법이다.</p>
<ul>
<li>Jar 안에는 Jar를 포함할 수 없다. 하지만 클래스는 얼마든지 포함할 수 있다.</li>
<li>라이브러리에 사용되는 jar 를 풀면 class 들이 나온다. 이 class 를 뽑아서 새로 만드는 jar 에 포함하는 것이다.</li>
<li>이렇게 하면 수 많은 라이브러리에서 나오는 class 때문에 뚱뚱한(fat) jar 가 탄생한다</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="81172547926420140000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`task buildFatJar(type: Jar) {
  manifest {
    attributes 'Main-Class': 'hello.embed.EmbedTomcatSpringMain'
  }
  duplicatesStrategy = DuplicatesStrategy.WARN
  from { configurations.runtimeClasspath.collect { it.isDirectory() ? it :
zipTree(it) } }
  with jar
}`, `81172547926420140000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="groovy" data-index="5"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">task buildFatJar(type: </span><span class="mtk10">Jar</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">  manifest {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    attributes </span><span class="mtk8">&#39;Main-Class&#39;</span><span class="mtk1">: </span><span class="mtk8">&#39;hello.embed.EmbedTomcatSpringMain&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">  }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">  duplicatesStrategy = </span><span class="mtk10">DuplicatesStrategy</span><span class="mtk1">.WARN</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">  from { configurations.runtimeClasspath.collect { it.isDirectory() ? it :</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">zipTree(it) } }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">  with jar</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>Fat Jar의 장점</p>
<ul>
<li>Fat Jar 덕분에 하나의 jar 파일에 필요한 라이브러리들을 내장할 수 있게 되었다.</li>
<li>내장 톰캣 라이브러리를 jar 내부에 내장할 수 있게 되었다.</li>
<li>덕분에 하나의 jar 파일로 배포부터, 웹 서버 설치+실행까지 모든 것을 단순화 할 수 있다.</li>
</ul>
<p>Fat Jar의 단점</p>
<p>Fat Jar는 완벽해 보이지만 몇가지 단점을 여전히 포함하고 있다.</p>
<ul>
<li>어떤 라이브러리가 포함되어 있는지 확인하기 어렵다.
<ul>
<li>모두 class 로 풀려있으니 어떤 라이브러리가 사용되고 있는지 추적하기 어렵다.</li>
</ul>
</li>
<li>파일명 중복을 해결할 수 없다.</li>
</ul>
<h4 id="편리한-부트-클래스-만들기" style="position:relative;"><a href="#%ED%8E%B8%EB%A6%AC%ED%95%9C-%EB%B6%80%ED%8A%B8-%ED%81%B4%EB%9E%98%EC%8A%A4-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-label="편리한 부트 클래스 만들기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>편리한 부트 클래스 만들기</h4>
<p>지금까지 만든 것을 라이브러리로 만들어서 배포한다면? 그것이 바로 스프링 부트이다</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="7763320214779789000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@SpringBootApplication
public class BootApplication {
  public static void main(String[] args) {
    SpringApplication.run(BootApplication.class, args);
  }
}`, `7763320214779789000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="6"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">SpringBootApplication</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">BootApplication</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">main</span><span class="mtk1">(</span><span class="mtk10">String</span><span class="mtk1">[] </span><span class="mtk12">args</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk12">SpringApplication</span><span class="mtk1">.</span><span class="mtk11">run</span><span class="mtk1">(</span><span class="mtk12">BootApplication</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">, args);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">  }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>스프링 부트는 보통 예제와 같이 SpringApplication.run() 한줄로 시작한다.</p>
<h4 id="스프링-부트와-웹서버" style="position:relative;"><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8%EC%99%80-%EC%9B%B9%EC%84%9C%EB%B2%84" aria-label="스프링 부트와 웹서버 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스프링 부트와 웹서버</h4>
<p>스프링 부트는 지금까지 고민한 문제를 깔끔하게 해결해준다.</p>
<ul>
<li>내장 톰캣을 사용해서 빌드와 배포를 편리하게 한다.</li>
<li>빌드시 하나의 Jar를 사용하면서, 동시에 Fat Jar 문제도 해결한다.</li>
<li>지금까지 진행한 내장 톰캣 서버를 실행하기 위한 복잡한 과정을 모두 자동으로 처리한다.</li>
</ul>
<p>실행과정</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="24880956282764165000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@SpringBootApplication
public class BootApplication {
    public static void main(String[] args) {
        SpringApplication.run(BootApplication.class, args);
    }
}`, `24880956282764165000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="7"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">SpringBootApplication</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">BootApplication</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">main</span><span class="mtk1">(</span><span class="mtk10">String</span><span class="mtk1">[] </span><span class="mtk12">args</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">SpringApplication</span><span class="mtk1">.</span><span class="mtk11">run</span><span class="mtk1">(</span><span class="mtk12">BootApplication</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">, args);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>스프링 부트를 실행할 때는 자바 <code>main()</code>메서드에서 <code>SpringApplication.run()</code>을 호출해주면 된다.</li>
<li>여기에 메인 설정 정보를 넘겨주는데, 보통 <code>@SpringBootApplication</code>애노테이션이 있는 현재 클래스를 지정해주면 된다.</li>
<li>참고로 현재 클래스에는 <code>@SpringBootApplication</code>애노테이션이 있는데, 이 애노테이션 안에는 컴포넌트 스캔을 포함한 여러 기능이 설정되어 있다. 기본 설정은 현재 패키지와 그 하위 패키지 모두를 컴포넌트 스캔한다.</li>
</ul>
<p>이 단순해 보이는 코드 한 줄안에서는 수 많은 일이 발생하지만 핵심은 2가지다.</p>
<ol>
<li>스프링 컨테이너를 생성한다.</li>
<li>WAS(내장 톰캣)을 생성한다.</li>
</ol>
<p>스프링 부트도 우리가 앞서 내장 톰캣에서 진행했던 것과 동일한 방식으로 스프링 컨테이너를 만들고, 내장 톰캣을 생성
하고 그 둘을 연결하는 과정을 진행한다.</p>
<hr>
<p>내장 톰캣이 포함된 스프링 부트를 빌드해보자</p>
<ul>
<li>JAR를 푼 결과를 보면 Fat Jar가 아니라 처음보는 새로운 구조로 만들어져 있다.</li>
<li>jar 내부에 jar를 담아서 인식하는 것이 불가능한데, jar가 포함되어 있고, 인식까지 되었다.</li>
</ul>
<h4 id="스프링-부트-실행-가능-jar" style="position:relative;"><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8-%EC%8B%A4%ED%96%89-%EA%B0%80%EB%8A%A5-jar" aria-label="스프링 부트 실행 가능 jar permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스프링 부트 실행 가능 Jar</h4>
<p>스프링 부트는 이런 문제를 해결하기 위해 jar 내부에 jar를 포함할 수 있는 특별한 구조의 jar를 만들고 동시에 만든 jar를 내부 jar를 포함해서 실행할 수 있게 했다. 이것을 **실행 가능 Jar(Executable Jar)**라 한다. 이 실행 가능 Jar를 사용하면 다음 문제들을 깔끔하게 해결할 수 있다.</p>
<p>문제: 어떤 라이브러리가 포함되어 있는지 확인하기 어렵다.</p>
<p>해결: jar 내부에 jar를 포함하기 때문에 어떤 라이브러리가 포함되어 있는지 쉽게 확인할 수 있다.</p>
<p>문제: 파일명 중복을 해결할 수 없다.</p>
<p>해결: jar 내부에 jar를 포함하기 때문에 a.jar , b.jar 내부에 같은 경로의 파일이 있어도 둘다 인식할 수 있다.</p>
<p>참고로 실행 가능 Jar는 자바 표준은 아니고, 스프링 부트에서 새롭게 정의한 것이다.</p>
<hr>
<p>jar 실행 정보</p>
<p>META-INF/MANIFEST.MF</p>
<pre class="grvsc-container default-dark" data-language="" data-index="8"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">Manifest-Version: 1.0</span></span>
<span class="grvsc-line"><span class="grvsc-source">Main-Class: org.springframework.boot.loader.JarLauncher</span></span>
<span class="grvsc-line"><span class="grvsc-source">Start-Class: hello.boot.BootApplication</span></span>
<span class="grvsc-line"><span class="grvsc-source">Spring-Boot-Version: 3.0.2</span></span>
<span class="grvsc-line"><span class="grvsc-source">Spring-Boot-Classes: BOOT-INF/classes/</span></span>
<span class="grvsc-line"><span class="grvsc-source">Spring-Boot-Lib: BOOT-INF/lib/</span></span>
<span class="grvsc-line"><span class="grvsc-source">Spring-Boot-Classpath-Index: BOOT-INF/classpath.idx</span></span>
<span class="grvsc-line"><span class="grvsc-source">Spring-Boot-Layers-Index: BOOT-INF/layers.idx</span></span>
<span class="grvsc-line"><span class="grvsc-source">Build-Jdk-Spec: 17</span></span></code></pre>
<ul>
<li>Main-Class
<ul>
<li>우리가 기대한 main() 이 있는 hello.boot.BootApplication 이 아니라 JarLauncher 라는 전혀 다른 클래스를 실행하고 있다.</li>
<li>JarLauncher 는 스프링 부트가 빌드시에 넣어준다. org/springframework/boot/loader/JarLauncher 에 실제로 포함되어 있다.</li>
<li>스프링 부트는 jar 내부에 jar를 읽어들이는 기능이 필요하다. 또 특별한 구조에 맞게 클래스 정보도 읽어들여야 한다. 바로 JarLauncher 가 이런 일을 처리해준다. 이런 작업을 먼저 처리한 다음 StartClass: 에 지정된 main() 을 호출한다.</li>
</ul>
</li>
<li>Start-Class : 우리가 기대한 main() 이 있는 hello.boot.BootApplication 가 적혀있다.</li>
<li>기타: 스프링 부트가 내부에서 사용하는 정보들이다.
<ul>
<li>Spring-Boot-Version : 스프링 부트 버전</li>
<li>Spring-Boot-Classes : 개발한 클래스 경로</li>
<li>Spring-Boot-Lib : 라이브러리 경로</li>
<li>Spring-Boot-Classpath-Index : 외부 라이브러리 모음</li>
<li>Spring-Boot-Layers-Index : 스프링 부트 구조 정보</li>
</ul>
</li>
<li>참고: Main-Class 를 제외한 나머지는 자바 표준이 아니다. 스프링 부트가 임의로 사용하는 정보이다.</li>
</ul>
<hr>
<p>BOOT-INF</p>
<ul>
<li>classes : 우리가 개발한 class 파일과 리소스 파일</li>
<li>lib : 외부 라이브러리</li>
<li>classpath.idx : 외부 라이브러리 모음</li>
<li>layers.idx : 스프링 부트 구조 정보</li>
</ul>
<p>WAR구조는 WEB-INF 라는 내부 폴더에 사용자 클래스와 라이브러리를 포함하고 있는데, 실행 가능 Jar도
그 구조를 본따서 만들었다. 이름도 유사하게 BOOT-INF 이다.</p>
<p>JarLauncher 를 통해서 여기에 있는 classes 와 lib 에 있는 jar 파일들을 읽어들인다</p>
<hr>
<p>스프링 부트 어플리케이션 실행 과정 정리</p>
<ol>
<li>java -jar xxx.jar</li>
<li>MANIFEST.MF 인식</li>
<li>JarLauncher.main() 실행</li>
</ol>
<ul>
<li>BOOT-INF/classes/ 인식</li>
<li>BOOT-INF/lib/ 인식</li>
</ul>
<ol start="4">
<li>BootApplication.main() 실행</li>
</ol>
<p>참고</p>
<ul>
<li>실행 가능 Jar가 아니라, IDE에서 직접 실행할 때는 BootApplication.main() 을 바로 실행한다.</li>
<li>IDE가 필요한 라이브러리를 모두 인식할 수 있게 도와주기 때문에 JarLauncher 가 필요하지 않다.</li>
</ul>
<h1 id="스프링-부트-스타터와-라이브러리-관리" style="position:relative;"><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8-%EC%8A%A4%ED%83%80%ED%84%B0%EC%99%80-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EA%B4%80%EB%A6%AC" aria-label="스프링 부트 스타터와 라이브러리 관리 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스프링 부트 스타터와 라이브러리 관리</h1>
<ul>
<li>웹 프로젝트를 하나 설정하기 위해서는 수 많은 라이브러리를 알아야 한다. 여기에 추가로 각각의 라이브러리의 버전까지 골라서 선택해야 한다.</li>
<li>가장 어려운 문제는 각 라이브러리들 간에 서로 호환이 잘 되는 버전도 있지만 호환이 잘 안되는 버전도 있다는 점이다.</li>
</ul>
<p>스프링 부트는 개발자 대신에 수 많은 라이브러리의 버전을 직접 관리해준다.</p>
<p>버전 관리 기능을 사용하려면 io.spring.dependency-management 플러그인을 사용해야 한다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="91073581822970660000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`plugins {
  id 'org.springframework.boot' version '3.0.2'
  id 'io.spring.dependency-management' version '1.1.0' //추가
  id 'java'
}`, `91073581822970660000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="groovy" data-index="9"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">plugins {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">  id </span><span class="mtk8">&#39;org.springframework.boot&#39;</span><span class="mtk1"> version </span><span class="mtk8">&#39;3.0.2&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">  id </span><span class="mtk8">&#39;io.spring.dependency-management&#39;</span><span class="mtk1"> version </span><span class="mtk8">&#39;1.1.0&#39;</span><span class="mtk1"> </span><span class="mtk3">//추가</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">  id </span><span class="mtk8">&#39;java&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>버전 정보 bom</p>
<ul>
<li>해당 build.gradle 문서안에 보면 bom 이라는 항목이 있다.</li>
<li>각각의 라이브러리에 대한 버전이 명시되어 있는 것을 확인할 수 있다</li>
</ul>
<p>참고 - 스프링 부트가 관리하지 않는 라이브러리</p>
<p>스프링 부트가 관리하지 않는 외부 라이브러리도 있다. 특히 아직 잘 알려지지 않거나 대중적이지 않은 경우가 그러한데, 이때는 다음과 같이 라이브러리의 버전을 직접 적어주어야 한다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="26494438446944500000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`dependencies {
  //3. 스프링 부트 스타터
  implementation 'org.springframework.boot:spring-boot-starter-web'
}`, `26494438446944500000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="groovy" data-index="10"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">dependencies {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3">//3. 스프링 부트 스타터</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">  implementation </span><span class="mtk8">&#39;org.springframework.boot:spring-boot-starter-web&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>spring-boot-starter-web 이 라이브러리 하나로 지금까지 우리가 직접 넣어주었던 모든 라이브러리가 포함된다.</li>
<li>이것은 사용하기 편리하게 의존성을 모아둔 세트이다.</li>
</ul>
<h1 id="자동-구성" style="position:relative;"><a href="#%EC%9E%90%EB%8F%99-%EA%B5%AC%EC%84%B1" aria-label="자동 구성 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자동 구성</h1>
<p>스프링 부트는 자동 구성(Auto Configuration)이라는 기능을 제공하는데, 일반적으로 자주 사용하는 수 많은 빈들을 자동으로 등록해주는 기능이다.</p>
<p>JdbcTemplate , DataSource , TransactionManager 모두 빈으로 등록을 안해도 스프링 부트가 자동 구성을 제공해서 자동으로 스프링 빈으로 등록된다.<br>
(있으면 자동 등록을 안해준다.)</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="86585288837934470000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@AutoConfiguration(after = DataSourceAutoConfiguration.class)
@ConditionalOnClass({ DataSource.class, JdbcTemplate.class })
@ConditionalOnSingleCandidate(DataSource.class)
@EnableConfigurationProperties(JdbcProperties.class)
@Import({ DatabaseInitializationDependencyConfigurer.class,
JdbcTemplateConfiguration.class,
NamedParameterJdbcTemplateConfiguration.class })
public class JdbcTemplateAutoConfiguration {
}`, `86585288837934470000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="11"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">AutoConfiguration</span><span class="mtk1">(after = </span><span class="mtk12">DataSourceAutoConfiguration</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">ConditionalOnClass</span><span class="mtk1">({ </span><span class="mtk12">DataSource</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">, </span><span class="mtk12">JdbcTemplate</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1"> })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">ConditionalOnSingleCandidate</span><span class="mtk1">(</span><span class="mtk12">DataSource</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">EnableConfigurationProperties</span><span class="mtk1">(</span><span class="mtk12">JdbcProperties</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Import</span><span class="mtk1">({ </span><span class="mtk12">DatabaseInitializationDependencyConfigurer</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk12">JdbcTemplateConfiguration</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk12">NamedParameterJdbcTemplateConfiguration</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1"> })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">JdbcTemplateAutoConfiguration</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>@AutoConfiguration : 자동 구성을 사용하려면 이 애노테이션을 등록해야 한다.</p>
<ul>
<li>자동 구성도 내부에 @Configuration 이 있어서 빈을 등록하는 자바 설정 파일로 사용할 수 있다.</li>
</ul>
<p>@ConditionalOnClass({ DataSource.class, JdbcTemplate.class })</p>
<ul>
<li>IF문과 유사한 기능을 제공한다. 이런 클래스가 있는 경우에만 설정이 동작한다. 만약 없으면 여기 있는 설정들이 모두 무효화 되고, 빈도 등록되지 않는다</li>
</ul>
<h4 id="자동-등록-설정" style="position:relative;"><a href="#%EC%9E%90%EB%8F%99-%EB%93%B1%EB%A1%9D-%EC%84%A4%EC%A0%95" aria-label="자동 등록 설정 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자동 등록 설정</h4>
<p>다음과 같은 자동 구성 기능들이 다음 빈들을 등록해준다.</p>
<ul>
<li>JdbcTemplateAutoConfiguration : JdbcTemplate</li>
<li>DataSourceAutoConfiguration : DataSource</li>
<li>DataSourceTransactionManagerAutoConfiguration : TransactionManager</li>
</ul>
<h4 id="auto-configuration" style="position:relative;"><a href="#auto-configuration" aria-label="auto configuration permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Auto Configuration</h4>
<p>자동 설정
Configuration 이라는 단어가 컴퓨터 용어에서는 환경 설정, 설정이라는 뜻으로 자주 사용된다. Auto Configuration은 크게 보면 빈들을 자동으로 등록해서 스프링이 동작하는 환경을 자동으로 설정해주기 때문에 자동 설정이라는 용어도 맞다.</p>
<p>자동 구성
Configuration 이라는 단어는 구성, 배치라는 뜻도 있다. 예를 들어서 컴퓨터라고 하면 CPU, 메모리등을 배치해야 컴퓨터가 동작한다. 이렇게 배치하는 것을 구성이라 한다.<br>
스프링도 스프링 실행에 필요한 빈들을 적절하게 배치해야 한다. 자동 구성은 스프링 실행에 필요한 빈들을 자동으로 배치해주는 것이다</p>
<p>자동 설정, 자동 구성 두 용어 모두 맞는 말이다. 자동 설정은 넓게 사용되는 의미이고, 자동 구성은 실행에 필요한 컴포넌트 조각을 자동으로 배치한다는 더 좁은 의미에 가깝다.</p>
<h4 id="정리-1" style="position:relative;"><a href="#%EC%A0%95%EB%A6%AC-1" aria-label="정리 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정리</h4>
<p>스프링 부트가 제공하는 자동 구성 기능을 이해하려면 다음 두 가지 개념을 이해해야 한다.</p>
<p>@Conditional : 특정 조건에 맞을 때 설정이 동작하도록 한다.</p>
<p>@AutoConfiguration : 자동 구성이 어떻게 동작하는지 내부 원리 이해</p>
<hr>
<p>@Condition 인터페이스</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="24958117381754286000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`package org.springframework.context.annotation;
public interface Condition {
    boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata);
}`, `24958117381754286000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="12"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">package</span><span class="mtk1"> org.springframework.context.annotation;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">interface</span><span class="mtk1"> </span><span class="mtk10">Condition</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10">boolean</span><span class="mtk1"> </span><span class="mtk11">matches</span><span class="mtk1">(</span><span class="mtk10">ConditionContext</span><span class="mtk1"> </span><span class="mtk12">context</span><span class="mtk1">, </span><span class="mtk10">AnnotatedTypeMetadata</span><span class="mtk1"> </span><span class="mtk12">metadata</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>matches() 메서드가 true 를 반환하면 조건에 만족해서 동작하고, false 를 반환하면 동작하지 않는다.</li>
<li>ConditionContext : 스프링 컨테이너, 환경 정보등을 담고 있다.</li>
<li>AnnotatedTypeMetadata : 애노테이션 메타 정보를 담고 있다.</li>
</ul>
<h4 id="conditionalonxxx" style="position:relative;"><a href="#conditionalonxxx" aria-label="conditionalonxxx permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>@ConditionalOnXxx</h4>
<p>스프링은 @Conditional 과 관련해서 개발자가 편리하게 사용할 수 있도록 수 많은 @ConditionalOnXxx 를 제공한다.</p>
<p>@ConditionalOnClass , @ConditionalOnMissingClass</p>
<ul>
<li>클래스가 있는 경우 동작한다. 나머지는 그 반대</li>
</ul>
<p>@ConditionalOnBean , @ConditionalOnMissingBean</p>
<ul>
<li>빈이 등록되어 있는 경우 동작한다. 나머지는 그 반대</li>
</ul>
<p>@ConditionalOnProperty</p>
<ul>
<li>환경 정보가 있는 경우 동작한다.</li>
</ul>
<p>@ConditionalOnResource</p>
<ul>
<li>리소스가 있는 경우 동작한다.</li>
</ul>
<p>@ConditionalOnWebApplication , @ConditionalOnNotWebApplication</p>
<ul>
<li>웹 애플리케이션인 경우 동작한다.</li>
</ul>
<p>@ConditionalOnExpression</p>
<ul>
<li>SpEL 표현식에 만족하는 경우 동작한다.</li>
</ul>
<p>Tip!!</p>
<p><code>@Conditional</code> 자체는 스프링 부트가 아니라 스프링 프레임워크의 기능이다. 스프링 부트는 이 기능을 확장해서 <code>@ConditionalOnXxx</code> 를 제공한다.</p>
<hr>
<p>순수 라이브러리 정리</p>
<p>순수 라이브러리를 사용하면 스프링 부트 자동 구성을 사용하는 것이 아니기 때문에 빈을 직접 하나하나 등록해주어야 한다.</p>
<ul>
<li>외부 라이브러리를 직접 만들고 또 그것을 프로젝트에 라이브러리로 불러서 적용해보았다</li>
<li>그런데 라이브러리를 사용하는 클라이언트 개발자 입장을 생각해보면, 라이브러리 내부에 있는 어떤 빈을 등록해야하는지 알아야 하고, 그것을 또 하나하나 빈으로 등록해야 한다. 지금처럼 간단한 라이브러리가 아니라 초기 설정이 복잡하다면 사용자 입장에서는 상당히 귀찮은 작업이 될 수 있다.</li>
<li>이런 부분을 자동으로 처리해주는 것이 바로 스프링 부트 자동 구성(Auto Configuration)이다.</li>
</ul>
<h4 id="자동-구성-라이브러리-만들기" style="position:relative;"><a href="#%EC%9E%90%EB%8F%99-%EA%B5%AC%EC%84%B1-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EB%A7%8C%EB%93%A4%EA%B8%B0" aria-label="자동 구성 라이브러리 만들기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자동 구성 라이브러리 만들기</h4>
<p>프로젝트에 라이브러리를 추가만 하면 모든 구성이 자동으로 처리되도록 해보자</p>
<p>쉽게 이야기해서 스프링 빈들이 자동으로 등록되는 것이다</p>
<p>자동 구성 추가</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="65688565857610160000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@AutoConfiguration
@ConditionalOnProperty(name = &quot;memory&quot;, havingValue = &quot;on&quot;)
public class MemoryAutoConfig {
    @Bean
    public MemoryController memoryController() {
        return new MemoryController(memoryFinder());
    }
    @Bean
    public MemoryFinder memoryFinder() {
        return new MemoryFinder();
    }
}`, `65688565857610160000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="13"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">AutoConfiguration</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">ConditionalOnProperty</span><span class="mtk1">(name = </span><span class="mtk8">&quot;memory&quot;</span><span class="mtk1">, havingValue = </span><span class="mtk8">&quot;on&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">MemoryAutoConfig</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">MemoryController</span><span class="mtk1"> </span><span class="mtk11">memoryController</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">MemoryController</span><span class="mtk1">(</span><span class="mtk11">memoryFinder</span><span class="mtk1">());</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">MemoryFinder</span><span class="mtk1"> </span><span class="mtk11">memoryFinder</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">MemoryFinder</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>@AutoConfiguration</p>
<ul>
<li>스프링 부트가 제공하는 자동 구성 기능을 적용할 때 사용하는 애노테이션이다.</li>
</ul>
<p>@ConditionalOnProperty</p>
<ul>
<li>memory=on 이라는 환경 정보가 있을 때 라이브러리를 적용한다. (스프링 빈을 등록한다.)</li>
<li>라이브러리를 가지고 있더라도 상황에 따라서 해당 기능을 켜고 끌 수 있게 유연한 기능을 제공한다.</li>
</ul>
<p>자동 구성 대상 지정</p>
<p>이 부분이 중요하다. 스프링 부트 자동 구성을 적용하려면, 다음 파일에 자동 구성 대상을 꼭 지정해주어야 한다.</p>
<p>폴더 위치와 파일 이름이 길기 때문에 주의하자</p>
<p>파일 생성</p>
<p><code>src/main/resources/META-INF/spring/</code> 폴더 생성</p>
<p><code>org.springframework.boot.autoconfigure.AutoConfiguration.imports</code> 파일 생성</p>
<p>org.springframework.boot.autoconfigure.AutoConfiguration.imports안에 아래 클래스를 작성한다.</p>
<p>memory.MemoryAutoConfig</p>
<ul>
<li>앞서 만든 자동 구성인 memory.MemoryAutoConfig 를 패키지를 포함해서 지정해준다.</li>
<li>스프링 부트는 시작 시점에 <code>org.springframework.boot.autoconfigure.AutoConfiguration.imports</code> 의 정보를 읽어서 자동 구성으로 사용한다.</li>
<li>따라서 내부에 있는 MemoryAutoConfig 가 자동으로 실행된다.</li>
</ul>
<p>앞서 project-v1 에서는 memory-v1 을 사용하기 위해 스프링 빈을 직접 등록했다.</p>
<p>project-v2 에서 사용하는 memory-v2 라이브러리에는 스프링 부트 자동 구성이 적용되어 있다. 따라서 빈을 등록하는 별도의 설정을 하지 않아도 된다.</p>
<hr>
<p>정리</p>
<ul>
<li>스프링 부트가 제공하는 자동 구성 덕분에 복잡한 빈 등록이나 추가 설정 없이 단순하게 라이브러리의 추가만으로 프로젝트를 편리하게 구성할 수 있다.</li>
<li>@ConditionalOnXxx 덕분에 라이브러리 설정을 유연하게 제공할 수 있다.</li>
</ul>
<h4 id="자동-구성의-이해" style="position:relative;"><a href="#%EC%9E%90%EB%8F%99-%EA%B5%AC%EC%84%B1%EC%9D%98-%EC%9D%B4%ED%95%B4" aria-label="자동 구성의 이해 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자동 구성의 이해</h4>
<p>스프링 부트는 다음 경로에 있는 파일을 읽어서 스프링 부트 자동 구성으로 사용한다.<br>
<code>resources/META-INF/spring/</code><br>
<code>org.springframework.boot.autoconfigure.AutoConfiguration.imports</code></p>
<p>스프링 부트 자동 구성이 동작하는 원리는 다음 순서로 확인할 수 있다.
<code>@SpringBootApplication</code> -> <code>@EnableAutoConfiguration</code> -> <code>@Import(AutoConfigurationImportSelector.class)</code></p>
<p>@EnableAutoConfiguration이 어노테이션이 AutoConfiguration을 활성화하는 기능</p>
<p>@Import 는 주로 스프링 설정 정보( @Configuration )를 포함할 때 사용한다.</p>
<h4 id="importselector의-이해" style="position:relative;"><a href="#importselector%EC%9D%98-%EC%9D%B4%ED%95%B4" aria-label="importselector의 이해 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ImportSelector의 이해</h4>
<p>@Import 에 설정 정보를 추가하는 방법은 2가지가 있다.</p>
<ul>
<li>정적인 방법: @Import (클래스) 이것은 정적이다. 코드에 대상이 딱 박혀 있다. 설정으로 사용할 대상을 동적으로 변경할 수 없다.</li>
<li>동적인 방법: @Import ( ImportSelector ) 코드로 프로그래밍해서 설정으로 사용할 대상을 동적으로 선택할 수 있다.</li>
</ul>
<p>정적인 방법</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="70574082592429720000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Configuration
@Import({AConfig.class, BConfig.class})
public class AppConfig {...}`, `70574082592429720000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="14"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Configuration</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Import</span><span class="mtk1">({</span><span class="mtk12">AConfig</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">, </span><span class="mtk12">BConfig</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">})</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">AppConfig</span><span class="mtk1"> {...}</span></span></span></code></pre>
<p>스프링에서 다른 설정 정보를 추가하고 싶으면 다음과 같이 @Import 를 사용하면 된다.</p>
<p>동적인 방법</p>
<p>특정 조건에 따라서 설정 정보 선택</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="28287259717875245000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`public class HelloImportSelector implements ImportSelector {
    @Override
    public String[] selectImports(AnnotationMetadata importingClassMetadata) {
        return new String[]{&quot;hello.selector.HelloConfig&quot;};
    }
}`, `28287259717875245000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="15"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">HelloImportSelector</span><span class="mtk1"> </span><span class="mtk4">implements</span><span class="mtk1"> </span><span class="mtk10">ImportSelector</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">String</span><span class="mtk1">[] </span><span class="mtk11">selectImports</span><span class="mtk1">(</span><span class="mtk10">AnnotationMetadata</span><span class="mtk1"> </span><span class="mtk12">importingClassMetadata</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk10">String</span><span class="mtk1">[]{</span><span class="mtk8">&quot;hello.selector.HelloConfig&quot;</span><span class="mtk1">};</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>설정 정보를 동적으로 선택할 수 있게 해주는 ImportSelector 인터페이스를 구현했다.</li>
<li>여기서는 단순히 hello.selector.HelloConfig 설정 정보를 반환한다.</li>
<li>이렇게 반환된 설정 정보는 선택되어서 사용된다.</li>
<li>여기에 설정 정보로 사용할 클래스를 동적으로 프로그래밍 하면 된다.</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="28559430961823252000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`
public class ImportSelectorTest {
    @Test
    void staticConfig() {
        AnnotationConfigApplicationContext appContext = new AnnotationConfigApplicationContext(StaticConfig.class);
        HelloBean bean = appContext.getBean(HelloBean.class);
        assertThat(bean).isNotNull();
    }

    @Test
    void selectorConfig() {
        AnnotationConfigApplicationContext appContext = new AnnotationConfigApplicationContext(SelectorConfig.class);
        HelloBean bean = appContext.getBean(HelloBean.class);
        assertThat(bean).isNotNull();
    }

    @Configuration
    @Import(HelloConfig.class)
    public static class StaticConfig {
    }

    @Configuration
    @Import(HelloImportSelector.class)
    public static class SelectorConfig {
    }
}`, `28559430961823252000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="16"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">ImportSelectorTest</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Test</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">staticConfig</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">AnnotationConfigApplicationContext</span><span class="mtk1"> </span><span class="mtk12">appContext</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">AnnotationConfigApplicationContext</span><span class="mtk1">(</span><span class="mtk12">StaticConfig</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">HelloBean</span><span class="mtk1"> </span><span class="mtk12">bean</span><span class="mtk1"> = </span><span class="mtk12">appContext</span><span class="mtk1">.</span><span class="mtk11">getBean</span><span class="mtk1">(</span><span class="mtk12">HelloBean</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk11">assertThat</span><span class="mtk1">(bean).</span><span class="mtk11">isNotNull</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Test</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">selectorConfig</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">AnnotationConfigApplicationContext</span><span class="mtk1"> </span><span class="mtk12">appContext</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">AnnotationConfigApplicationContext</span><span class="mtk1">(</span><span class="mtk12">SelectorConfig</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">HelloBean</span><span class="mtk1"> </span><span class="mtk12">bean</span><span class="mtk1"> = </span><span class="mtk12">appContext</span><span class="mtk1">.</span><span class="mtk11">getBean</span><span class="mtk1">(</span><span class="mtk12">HelloBean</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk11">assertThat</span><span class="mtk1">(bean).</span><span class="mtk11">isNotNull</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Configuration</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Import</span><span class="mtk1">(</span><span class="mtk12">HelloConfig</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">StaticConfig</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Configuration</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Import</span><span class="mtk1">(</span><span class="mtk12">HelloImportSelector</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">SelectorConfig</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>staticConfig()</p>
<ul>
<li>스프링 컨테이너를 만들고, StaticConfig.class 를 초기 설정 정보로 사용했다. -> 스프링 컨테이너에 잘 등록된다.</li>
</ul>
<p>selectorConfig()</p>
<ul>
<li>selectorConfig() 는 SelectorConfig 를 초기 설정 정보로 사용</li>
<li>SelectorConfig 는 @Import(HelloImportSelector.class) 에서 ImportSelector 의 구현체인 HelloImportSelector 를 사용했다.</li>
<li>스프링은 HelloImportSelector 를 실행하고, “hello.selector.HelloConfig” 라는 문자를 반환 받는다</li>
<li>스프링은 이 문자에 맞는 대상을 설정 정보로 사용한다. 따라서 hello.selector.HelloConfig 이 설정 정보로 사용된다.</li>
</ul>
<h4 id="enableautoconfiguration-동작-방식" style="position:relative;"><a href="#enableautoconfiguration-%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D" aria-label="enableautoconfiguration 동작 방식 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>@EnableAutoConfiguration 동작 방식</h4>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="47327440621735370000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@AutoConfigurationPackage
@Import(AutoConfigurationImportSelector.class)
public @interface EnableAutoConfiguration {…}`, `47327440621735370000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="17"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">AutoConfigurationPackage</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Import</span><span class="mtk1">(</span><span class="mtk12">AutoConfigurationImportSelector</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> @</span><span class="mtk4">interface</span><span class="mtk1"> </span><span class="mtk10">EnableAutoConfiguration</span><span class="mtk1"> {…}</span></span></span></code></pre>
<ul>
<li>AutoConfigurationImportSelector 는 ImportSelector 의 구현체이다. 따라서 설정 정보를 동적으로 선택할 수 있다</li>
</ul>
<p>실제로 이 코드는 모든 라이브러리에 있는 다음 경로의 파일을 확인한다</p>
<ul>
<li><code>META-INF/spring/</code></li>
<li><code>org.springframework.boot.autoconfigure.AutoConfiguration.imports</code></li>
</ul>
<p>@SpringBootApplication -> @EnableAutoConfiguration -> @Import(AutoConfigurationImportSelector.class)<br>
-> resources/META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports 파일을 열어서 설정 정보 선택<br>
-> 해당 파일의 설정 정보가 스프링 컨테이너에 등록되고 사용</p>
<hr>
<h4 id="정리-2" style="position:relative;"><a href="#%EC%A0%95%EB%A6%AC-2" aria-label="정리 2 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정리</h4>
<p>스프링 부트의 자동 구성을 직접 만들어서 사용할 때는 다음을 참고하자.</p>
<ul>
<li>@AutoConfiguration 에 자동 구성의 순서를 지정할 수 있다.</li>
<li>@AutoConfiguration 도 설정 파일이다. 내부에 @Configuration 이 있는 것을 확인할 수 있다.
<ul>
<li>하지만 일반 스프링 설정과 라이프사이클이 다르기 때문에 컴포넌트 스캔의 대상이 되면 안된다.</li>
<li>파일에 지정해서 사용해야 한다.</li>
<li>resources/META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</li>
<li>그래서 스프링 부트가 제공하는 컴포넌트 스캔에서는 @AutoConfiguration 을 제외하는 <code>AutoConfigurationExcludeFilter</code> 필터가 포함되어 있다.</li>
<li>자동 구성이 내부에서 컴포넌트 스캔을 사용하면 안된다. 대신에 자동 구성 내부에서 @Import 는 사용할 수 있다</li>
</ul>
</li>
</ul>
<h4 id="자동-구성을-언제-사용하는가" style="position:relative;"><a href="#%EC%9E%90%EB%8F%99-%EA%B5%AC%EC%84%B1%EC%9D%84-%EC%96%B8%EC%A0%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B0%80" aria-label="자동 구성을 언제 사용하는가 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자동 구성을 언제 사용하는가?</h4>
<p>자동 구성을 알아야 하는 진짜 이유는 개발을 진행 하다보면 사용하는 특정 빈들이 어떻게 등록된 것인지 확인이 필요할 때가 있다.</p>
<p>이럴 때 스프링 부트의 자동 구성 코드를 읽을 수 있어야 한다.</p>
<p>그래야 문제가 발생했을 때 대처가 가능하다.</p>
<p>자동화는 매우 편리한 기능이지만 자동화만 믿고 있다가 실무에서 문제가 발생했을 때는 파고 들어가서 문제를 확인하는 정도는 이해해야 한다.</p>
<p>다음장에선 이런 방식으로 빈이 자동 등록되면, 빈을 등록할 때 사용하는 설정 정보는(ex - DB접속 URL, ID, PW) 어떻게 변경해야 하는지 알아본다.</p>
<h1 id="외부-설정과-프로필-1" style="position:relative;"><a href="#%EC%99%B8%EB%B6%80-%EC%84%A4%EC%A0%95%EA%B3%BC-%ED%94%84%EB%A1%9C%ED%95%84-1" aria-label="외부 설정과 프로필 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>외부 설정과 프로필 1</h1>
<h4 id="외부-설정이란" style="position:relative;"><a href="#%EC%99%B8%EB%B6%80-%EC%84%A4%EC%A0%95%EC%9D%B4%EB%9E%80" aria-label="외부 설정이란 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>외부 설정이란?</h4>
<blockquote>
<p>환경에 따라 변하는 설정값을 실행 시점에 주입</p>
</blockquote>
<p>외부 설정은 일반적으로 4가지 방법이 있다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/28d81fd91cd4f146955bec97d84f5a7e/260b9/10.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 42.94478527607362%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABQElEQVR42o2Q3aqCUBCFfT3RRxO68wF6g7rzIhJvu5AyuoiUJC01f6Lo12wd1kBy4lCdDcPee/bMN2ttBf9c3W4Xw+FQzo/H422d8gnybLxer1BVFbqut7l3UOUbrK5rbDYbdDodGIaB0+n00ckLsGka3O/3FnQ+nwW2Wq0QhiHiOEYQBDgej6L6crlIsI71LZBqWMTHfr8PTdPQ6/Ww3+8RRRHKskSappjNZsjzHFmWyf13cCgFKWxggpOTJMF0OoVpmrBtG0VRwPd9bLdbGep5njQxqHg+n0sNF53cbjcolEqb3A+HA5bLpTRQCYfR5nq9FgWj0QhVVWG324lKBoF0wndyXv6QifF4DNd14TgOBoMBLMsS0GQywWKxEPsEcSBhzy9gnqL+AKmGhbTPM61QKYcwqIRfxPdn8E4ndPgDlSGkAHiU37YAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/28d81fd91cd4f146955bec97d84f5a7e/a81b5/10.webp 163w,
/static/28d81fd91cd4f146955bec97d84f5a7e/da3ef/10.webp 325w,
/static/28d81fd91cd4f146955bec97d84f5a7e/309d5/10.webp 650w,
/static/28d81fd91cd4f146955bec97d84f5a7e/78344/10.webp 975w,
/static/28d81fd91cd4f146955bec97d84f5a7e/bdb72/10.webp 1300w,
/static/28d81fd91cd4f146955bec97d84f5a7e/1cf4a/10.webp 1432w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/28d81fd91cd4f146955bec97d84f5a7e/5e043/10.png 163w,
/static/28d81fd91cd4f146955bec97d84f5a7e/e5cc6/10.png 325w,
/static/28d81fd91cd4f146955bec97d84f5a7e/663f3/10.png 650w,
/static/28d81fd91cd4f146955bec97d84f5a7e/d880f/10.png 975w,
/static/28d81fd91cd4f146955bec97d84f5a7e/4c573/10.png 1300w,
/static/28d81fd91cd4f146955bec97d84f5a7e/260b9/10.png 1432w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/28d81fd91cd4f146955bec97d84f5a7e/663f3/10.png"
            alt="10"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<ul>
<li>OS 환경 변수: OS에서 지원하는 외부 설정, 해당 OS를 사용하는 모든 프로세스에서 사용</li>
<li>자바 시스템 속성: 자바에서 지원하는 외부 설정, 해당 JVM안에서 사용</li>
<li>자바 커맨드 라인 인수: 커맨드 라인에서 전달하는 외부 설정, 실행시 main(args) 메서드에서 사용</li>
<li>외부 파일(설정 데이터): 프로그램에서 외부 파일을 직접 읽어서 사용
<ul>
<li>애플리케이션에서 특정 위치의 파일을 읽도록 해둔다. 예) data/hello.txt</li>
<li>그리고 각 서버마다 해당 파일안에 다른 설정 정보를 남겨둔다.</li>
</ul>
</li>
</ul>
<h4 id="os-환경-변수" style="position:relative;"><a href="#os-%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98" aria-label="os 환경 변수 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>OS 환경 변수</h4>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="5157533148330540000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Slf4j
public class OsEnv {
    public static void main(String[] args) {
        Map<String, String> envMap = System.getenv();
        for (String key : envMap.keySet()) {
            log.info(&quot;env {}={}&quot;, key, System.getenv(key));
        }
    }
}`, `5157533148330540000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="18"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">OsEnv</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">main</span><span class="mtk1">(</span><span class="mtk10">String</span><span class="mtk1">[] </span><span class="mtk12">args</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">Map</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">, </span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">envMap</span><span class="mtk1"> = </span><span class="mtk12">System</span><span class="mtk1">.</span><span class="mtk11">getenv</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">for</span><span class="mtk1"> (</span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">key</span><span class="mtk1"> </span><span class="mtk15">:</span><span class="mtk1"> </span><span class="mtk12">envMap</span><span class="mtk1">.</span><span class="mtk11">keySet</span><span class="mtk1">()) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;env {}={}&quot;</span><span class="mtk1">, key, </span><span class="mtk12">System</span><span class="mtk1">.</span><span class="mtk11">getenv</span><span class="mtk1">(key));</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>필요한 곳에서 <code>System.getenv()</code>로 외부 설정을 사용할 수 있다.</p>
<h4 id="자바-시스템-속성" style="position:relative;"><a href="#%EC%9E%90%EB%B0%94-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%86%8D%EC%84%B1" aria-label="자바 시스템 속성 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>자바 시스템 속성</h4>
<ul>
<li>자바 시스템 속성(Java System properties)은 실행한 JVM 안에서 접근 가능한 외부 설정이다.</li>
<li>자바가 내부에서 미리 설정해두고 사용하는 속성들도 있다.</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="35224666362117920000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Slf4j
public class JavaSystemProperties {
    public static void main(String[] args) {
        Properties properties = System.getProperties();
        for (Object key : properties.keySet()) {
            log.info(&quot;prop {}={}&quot;, key,
                    System.getProperty(String.valueOf(key)));
        }
        String url = System.getProperty(&quot;url&quot;);
        String username = System.getProperty(&quot;username&quot;);
        String password = System.getProperty(&quot;password&quot;);
        log.info(&quot;url={}&quot;, url);
        log.info(&quot;username={}&quot;, username);
        log.info(&quot;password={}&quot;, password);
    }
}`, `35224666362117920000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="19"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">JavaSystemProperties</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">main</span><span class="mtk1">(</span><span class="mtk10">String</span><span class="mtk1">[] </span><span class="mtk12">args</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">Properties</span><span class="mtk1"> </span><span class="mtk12">properties</span><span class="mtk1"> = </span><span class="mtk12">System</span><span class="mtk1">.</span><span class="mtk11">getProperties</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">for</span><span class="mtk1"> (</span><span class="mtk10">Object</span><span class="mtk1"> </span><span class="mtk12">key</span><span class="mtk1"> </span><span class="mtk15">:</span><span class="mtk1"> </span><span class="mtk12">properties</span><span class="mtk1">.</span><span class="mtk11">keySet</span><span class="mtk1">()) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;prop {}={}&quot;</span><span class="mtk1">, key,</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">                    </span><span class="mtk12">System</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk12">String</span><span class="mtk1">.</span><span class="mtk11">valueOf</span><span class="mtk1">(key)));</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">url</span><span class="mtk1"> = </span><span class="mtk12">System</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;url&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">username</span><span class="mtk1"> = </span><span class="mtk12">System</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;username&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">password</span><span class="mtk1"> = </span><span class="mtk12">System</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;password&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;url={}&quot;</span><span class="mtk1">, url);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;username={}&quot;</span><span class="mtk1">, username);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;password={}&quot;</span><span class="mtk1">, password);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>예) java -Durl=dev -jar app.jar</p>
<p>System.getProperties() 를 사용하면 Map 과 유사한( Map 의 자식 타입) key=value 형식의 Properties 를 받을 수 있다.</p>
<p>jar 로 빌드되어 있다면 실행시 다음과 같이 자바 시스템 속성을 추가할 수 있다.</p>
<p><code>java -Durl=devdb -Dusername=dev_user -Dpassword=dev_pw -jar app.jar</code></p>
<h4 id="커맨드-라인-인수" style="position:relative;"><a href="#%EC%BB%A4%EB%A7%A8%EB%93%9C-%EB%9D%BC%EC%9D%B8-%EC%9D%B8%EC%88%98" aria-label="커맨드 라인 인수 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>커맨드 라인 인수</h4>
<p>커맨드 라인 인수(Command line arguments)는 애플리케이션 실행 시점에 외부 설정값을 main(args) 메서드의 args 파라미터로 전달하는 방법이다.</p>
<p>예) java -jar app.jar dataA dataB</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="88211842942556600000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Slf4j
public class CommandLineV1 {
    public static void main(String[] args) {
        for (String arg : args) {
            log.info(&quot;arg {}&quot;, arg);
        }
    }
}`, `88211842942556600000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="20"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">CommandLineV1</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">main</span><span class="mtk1">(</span><span class="mtk10">String</span><span class="mtk1">[] </span><span class="mtk12">args</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">for</span><span class="mtk1"> (</span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">arg</span><span class="mtk1"> </span><span class="mtk15">:</span><span class="mtk1"> args) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;arg {}&quot;</span><span class="mtk1">, arg);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<h4 id="커맨드라인-옵션-인수" style="position:relative;"><a href="#%EC%BB%A4%EB%A7%A8%EB%93%9C%EB%9D%BC%EC%9D%B8-%EC%98%B5%EC%85%98-%EC%9D%B8%EC%88%98" aria-label="커맨드라인 옵션 인수 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>커맨드라인 옵션 인수</h4>
<p>스프링에서는 커맨드 라인 인수를 key=value 형식으로 편리하게 사용할 수 있도록 스프링 만의 표준 방식을 정의</p>
<p><code>--key=value</code> 형식으로 사용한다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="13910229149449372000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Slf4j
public class CommandLineV2 {
    public static void main(String[] args) {
        for (String arg : args) {
            log.info(&quot;arg {}&quot;, arg);
        }
        ApplicationArguments appArgs = new DefaultApplicationArguments(args);
        log.info(&quot;SourceArgs = {}&quot;, List.of(appArgs.getSourceArgs()));
        log.info(&quot;NonOptionArgs = {}&quot;, appArgs.getNonOptionArgs());
        log.info(&quot;OptionNames = {}&quot;, appArgs.getOptionNames());
        Set<String> optionNames = appArgs.getOptionNames();
        for (String optionName : optionNames) {
            log.info(&quot;option args {}={}&quot;, optionName,
                    appArgs.getOptionValues(optionName));
        }
        List<String> url = appArgs.getOptionValues(&quot;url&quot;);
        List<String> username = appArgs.getOptionValues(&quot;username&quot;);
        List<String> password = appArgs.getOptionValues(&quot;password&quot;);
        List<String> mode = appArgs.getOptionValues(&quot;mode&quot;);
        log.info(&quot;url={}&quot;, url);
        log.info(&quot;username={}&quot;, username);
        log.info(&quot;password={}&quot;, password);
        log.info(&quot;mode={}&quot;, mode);
    }
}`, `13910229149449372000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="21"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">CommandLineV2</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">main</span><span class="mtk1">(</span><span class="mtk10">String</span><span class="mtk1">[] </span><span class="mtk12">args</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">for</span><span class="mtk1"> (</span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">arg</span><span class="mtk1"> </span><span class="mtk15">:</span><span class="mtk1"> args) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;arg {}&quot;</span><span class="mtk1">, arg);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">ApplicationArguments</span><span class="mtk1"> </span><span class="mtk12">appArgs</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">DefaultApplicationArguments</span><span class="mtk1">(args);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;SourceArgs = {}&quot;</span><span class="mtk1">, </span><span class="mtk12">List</span><span class="mtk1">.</span><span class="mtk11">of</span><span class="mtk1">(</span><span class="mtk12">appArgs</span><span class="mtk1">.</span><span class="mtk11">getSourceArgs</span><span class="mtk1">()));</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;NonOptionArgs = {}&quot;</span><span class="mtk1">, </span><span class="mtk12">appArgs</span><span class="mtk1">.</span><span class="mtk11">getNonOptionArgs</span><span class="mtk1">());</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;OptionNames = {}&quot;</span><span class="mtk1">, </span><span class="mtk12">appArgs</span><span class="mtk1">.</span><span class="mtk11">getOptionNames</span><span class="mtk1">());</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">Set</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">optionNames</span><span class="mtk1"> = </span><span class="mtk12">appArgs</span><span class="mtk1">.</span><span class="mtk11">getOptionNames</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">for</span><span class="mtk1"> (</span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">optionName</span><span class="mtk1"> </span><span class="mtk15">:</span><span class="mtk1"> optionNames) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;option args {}={}&quot;</span><span class="mtk1">, optionName,</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">                    </span><span class="mtk12">appArgs</span><span class="mtk1">.</span><span class="mtk11">getOptionValues</span><span class="mtk1">(optionName));</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">List</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">url</span><span class="mtk1"> = </span><span class="mtk12">appArgs</span><span class="mtk1">.</span><span class="mtk11">getOptionValues</span><span class="mtk1">(</span><span class="mtk8">&quot;url&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">List</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">username</span><span class="mtk1"> = </span><span class="mtk12">appArgs</span><span class="mtk1">.</span><span class="mtk11">getOptionValues</span><span class="mtk1">(</span><span class="mtk8">&quot;username&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">List</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">password</span><span class="mtk1"> = </span><span class="mtk12">appArgs</span><span class="mtk1">.</span><span class="mtk11">getOptionValues</span><span class="mtk1">(</span><span class="mtk8">&quot;password&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="19"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">List</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">mode</span><span class="mtk1"> = </span><span class="mtk12">appArgs</span><span class="mtk1">.</span><span class="mtk11">getOptionValues</span><span class="mtk1">(</span><span class="mtk8">&quot;mode&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="20"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;url={}&quot;</span><span class="mtk1">, url);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="21"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;username={}&quot;</span><span class="mtk1">, username);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="22"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;password={}&quot;</span><span class="mtk1">, password);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="23"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;mode={}&quot;</span><span class="mtk1">, mode);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="24"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="25"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>Tip!</p>
<p>참고로 옵션 인수는 –username=userA –username=userB 처럼 하나의 키에 여러 값을 포함할 수 있기 때문에 appArgs.getOptionValues(key) 의 결과는 리스트( List )를 반환한다.</p>
<h4 id="커맨드-라인-옵션-인수와-스프링-부트" style="position:relative;"><a href="#%EC%BB%A4%EB%A7%A8%EB%93%9C-%EB%9D%BC%EC%9D%B8-%EC%98%B5%EC%85%98-%EC%9D%B8%EC%88%98%EC%99%80-%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8" aria-label="커맨드 라인 옵션 인수와 스프링 부트 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>커맨드 라인 옵션 인수와 스프링 부트</h4>
<ul>
<li>스프링 부트는 커맨드 라인을 포함해서 커맨드 라인 옵션 인수를 활용할 수 있는 ApplicationArguments 를 스프링 빈으로 등록해둔다.</li>
<li>그 안에 입력한 커맨드 라인을 저장해둔다.</li>
<li>해당 빈을 주입 받으면 커맨드 라인으로 입력한 값을 어디서든 사용할 수 있다.</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="96890666813956010000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Slf4j
@Component
public class CommandLineBean {
    private final ApplicationArguments arguments;
    public CommandLineBean(ApplicationArguments arguments) {
        this.arguments = arguments;
    }
    @PostConstruct
    public void init() {
        log.info(&quot;source {}&quot;, List.of(arguments.getSourceArgs()));
        log.info(&quot;optionNames {}&quot;, arguments.getOptionNames());
        Set<String> optionNames = arguments.getOptionNames();
        for (String optionName : optionNames) {
            log.info(&quot;option args {}={}&quot;, optionName,
                    arguments.getOptionValues(optionName));
        }
    }
}`, `96890666813956010000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="22"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Component</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">CommandLineBean</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk4">final</span><span class="mtk1"> </span><span class="mtk10">ApplicationArguments</span><span class="mtk1"> </span><span class="mtk12">arguments</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk11">CommandLineBean</span><span class="mtk1">(</span><span class="mtk10">ApplicationArguments</span><span class="mtk1"> </span><span class="mtk12">arguments</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">arguments</span><span class="mtk1"> = arguments;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">PostConstruct</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">init</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;source {}&quot;</span><span class="mtk1">, </span><span class="mtk12">List</span><span class="mtk1">.</span><span class="mtk11">of</span><span class="mtk1">(</span><span class="mtk12">arguments</span><span class="mtk1">.</span><span class="mtk11">getSourceArgs</span><span class="mtk1">()));</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;optionNames {}&quot;</span><span class="mtk1">, </span><span class="mtk12">arguments</span><span class="mtk1">.</span><span class="mtk11">getOptionNames</span><span class="mtk1">());</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">Set</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">optionNames</span><span class="mtk1"> = </span><span class="mtk12">arguments</span><span class="mtk1">.</span><span class="mtk11">getOptionNames</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">for</span><span class="mtk1"> (</span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">optionName</span><span class="mtk1"> </span><span class="mtk15">:</span><span class="mtk1"> optionNames) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;option args {}={}&quot;</span><span class="mtk1">, optionName,</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">                    </span><span class="mtk12">arguments</span><span class="mtk1">.</span><span class="mtk11">getOptionValues</span><span class="mtk1">(optionName));</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<h4 id="스프링-통합" style="position:relative;"><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-%ED%86%B5%ED%95%A9" aria-label="스프링 통합 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>스프링 통합</h4>
<p>정책에 따라서 설정값을 사용하는 방법이 달라질 수 있고, 잘못된 방법으로 사용할 수 있다.</p>
<p>스프링은 이 문제를 Environment 와 PropertySource 라는 추상화를 통해서 해결한다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b7d54b3425ee182aca47295d413378b6/f28c3/11.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 42.331288343558285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHklEQVR42p2Ra4uCUBCG/f9/J4TASk2Kok+CV1Az7eKli4IXsvJdZhZ3l/207cDLnDPn8JyZ9wh4M5qmwW63g+/7CIKAReswDJGmKYR3gW3bIssyLJdLTCYTjMdjqKrK4KIoILxeLzweD3Rdh+fz+aW+7zlTnc5JAzBJEui6jvl8jtlshtVqxV3fbjcIeZ7DNE1YloXtdgvHceC6Ltc8z+NxKNNI9/sd1+uVgXS+WCwgyzI2m803kC4QiHQ6ndijqqpQliVDBo/iOObuLpcLA6muaRokSYJt2zgcDp9AGm3Q7/hZG9YEJfPX6zVEUcRoNGIv6VH2cLj8F1HUdc2TGIYBRVEwnU7ZwyiKuPt//fLxeGTt93u2gjLtz+czPgBvv1pTWe3FggAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b7d54b3425ee182aca47295d413378b6/a81b5/11.webp 163w,
/static/b7d54b3425ee182aca47295d413378b6/da3ef/11.webp 325w,
/static/b7d54b3425ee182aca47295d413378b6/309d5/11.webp 650w,
/static/b7d54b3425ee182aca47295d413378b6/78344/11.webp 975w,
/static/b7d54b3425ee182aca47295d413378b6/bdb72/11.webp 1300w,
/static/b7d54b3425ee182aca47295d413378b6/3724c/11.webp 1424w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/b7d54b3425ee182aca47295d413378b6/5e043/11.png 163w,
/static/b7d54b3425ee182aca47295d413378b6/e5cc6/11.png 325w,
/static/b7d54b3425ee182aca47295d413378b6/663f3/11.png 650w,
/static/b7d54b3425ee182aca47295d413378b6/d880f/11.png 975w,
/static/b7d54b3425ee182aca47295d413378b6/4c573/11.png 1300w,
/static/b7d54b3425ee182aca47295d413378b6/f28c3/11.png 1424w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b7d54b3425ee182aca47295d413378b6/663f3/11.png"
            alt="11"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>PropertySource</p>
<ul>
<li>org.springframework.core.env.PropertySource</li>
<li>스프링은 PropertySource 라는 추상 클래스를 제공하고, 각각의 외부 설정를 조회하는 XxxPropertySource 구현체를 만들어두었다.</li>
<li>스프링은 로딩 시점에 필요한 PropertySource 들을 생성하고, Environment 에서 사용할 수 있게 연결해둔다.</li>
</ul>
<p>Environment</p>
<ul>
<li>org.springframework.core.env.Environment</li>
<li>Environment 를 통해서 특정 외부 설정에 종속되지 않고, 일관성 있게 key=value 형식의 외부 설정에 접근할 수 있다.</li>
<li>environment.getProperty(key) 를 통해서 값을 조회할 수 있다.</li>
</ul>
<p>설정 데이터(파일)</p>
<p>여기에 우리가 잘 아는 application.properties , application.yml 도 PropertySource 에 추가된다.</p>
<p>따라서 Environment 를 통해서 접근할 수 있다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="54794446742751355000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Slf4j
@Component
public class EnvironmentCheck {
    private final Environment env;
    public EnvironmentCheck(Environment env) {
        this.env = env;
    }
    @PostConstruct
    public void init() {
        String url = env.getProperty(&quot;url&quot;);
        String username = env.getProperty(&quot;username&quot;);
        String password = env.getProperty(&quot;password&quot;);
        log.info(&quot;env url={}&quot;, url);
        log.info(&quot;env username={}&quot;, username);
        log.info(&quot;env password={}&quot;, password);
    }
}`, `54794446742751355000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="23"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Component</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">EnvironmentCheck</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk4">final</span><span class="mtk1"> </span><span class="mtk10">Environment</span><span class="mtk1"> </span><span class="mtk12">env</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk11">EnvironmentCheck</span><span class="mtk1">(</span><span class="mtk10">Environment</span><span class="mtk1"> </span><span class="mtk12">env</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">env</span><span class="mtk1"> = env;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">PostConstruct</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">init</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">url</span><span class="mtk1"> = </span><span class="mtk12">env</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;url&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">username</span><span class="mtk1"> = </span><span class="mtk12">env</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;username&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">password</span><span class="mtk1"> = </span><span class="mtk12">env</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;password&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;env url={}&quot;</span><span class="mtk1">, url);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;env username={}&quot;</span><span class="mtk1">, username);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;env password={}&quot;</span><span class="mtk1">, password);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>정리</p>
<ul>
<li>커맨드 라인 옵션 인수, 자바 시스템 속성 모두 Environment 를 통해서 동일한 방법으로 읽을 수 있다</li>
<li>스프링은 Environment 를 통해서 외부 설정을 읽는 방법을 추상화했다.</li>
<li>덕분에 자바 시스템 속성을 사용하다가 만약 커맨드 라인 옵션 인수를 사용하도록 읽는 방법이 변경되어도, 개발 소스 코드는 전혀 변경하지 않아도 된다.</li>
</ul>
<p>우선순위</p>
<ul>
<li>더 유연한 것이 우선권을 가진다</li>
<li>범위가 넒은 것 보다 좁은 것이 우선권을 가진다.</li>
</ul>
<h4 id="설정-데이터1---외부파일" style="position:relative;"><a href="#%EC%84%A4%EC%A0%95-%EB%8D%B0%EC%9D%B4%ED%84%B01---%EC%99%B8%EB%B6%80%ED%8C%8C%EC%9D%BC" aria-label="설정 데이터1   외부파일 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>설정 데이터1 - 외부파일</h4>
<p>지금까지 살펴본 방법은 관리가 어렵다</p>
<p>등장하는 대안으로는 설정값을 파일에 넣어서 관리하는 방법이다</p>
<p><code>.properties</code> 라는 파일은 key=value 형식을 사용해서 설정값을 관리하기에 적합하다.</p>
<ul>
<li>예를 들면 개발 서버와 운영 서버 각각에 application.properties 라는 같은 이름의 파일을 준비해둔다.</li>
<li>그리고 애플리케이션 로딩 시점에 해당 파일을 읽어서 그 속에 있는 값들을 외부 설정값으로 사용하면 된다.</li>
</ul>
<p>Tip!</p>
<p>지금부터 설명할 내용은 application.properties 대신에 yml 형식의 application.yml 에도 동일하게 적용된다</p>
<p>남은 문제</p>
<ul>
<li>외부 설정을 별도의 파일로 관리하게 되면 설정 파일 자체를 관리하기 번거로운 문제가 발생한다.</li>
<li>서버가 10대면 변경사항이 있을 때 10대 서버의 설정 파일을 모두 각각 변경해야 하는 불편함이 있다.</li>
<li>설정 파일이 별도로 관리되기 때문에 설정값의 변경 이력을 확인하기 어렵다.</li>
<li>특히 설정값의 변경 이력이 프로젝트 코드들과 어떻게 영향을 주고 받는지 그 이력을 같이 확인하기 어렵다.</li>
</ul>
<h4 id="설정-데이터2---내부파일" style="position:relative;"><a href="#%EC%84%A4%EC%A0%95-%EB%8D%B0%EC%9D%B4%ED%84%B02---%EB%82%B4%EB%B6%80%ED%8C%8C%EC%9D%BC" aria-label="설정 데이터2   내부파일 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>설정 데이터2 - 내부파일</h4>
<p>이 문제를 해결하는 간단한 방법은 설정 파일을 프로젝트 내부에 포함해서 관리하는 것이다. 그리고 빌드 시점에 함께 빌드되게 하는 것이다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/447a9464b25d6125f86cb3ae185288ad/622c8/12.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 42.94478527607362%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABUElEQVR42o1RWa6CQBCcK3gIjuChvAcfHoFwDy+g4YMYEmWJJsYFBBc0YHBf66X6BWN478NKOkOanq6qKYUv8Xg8cDqdpM7ns9Ttdvszp75duFgsMJlMMB6P4bqunOwRnU4Hpmni+XxC3e93YS/PEq/X663ser1it9vheDxiNBrBcRzM53NkWSYzjUYDtVpN1Kv9fg/W4XBAURTyzWXlwu12iyRJsFwuZYHnebBtW9SxR7RaLei6LsRqvV4jiiLEcSwXaMX3fbHFy/xP0AFJqDRN07dy2mSVIlS73RZGy7LQ7XZlmG/V7/cRBAEGg4H0qIh2Z7OZkHKG6gk6C8PwN5RPuyyyfoLsl8tF1POk/V6vh9VqhTzPZabZbELTNOn9mzKlV63QKhVROUOZTqeinDAMA/V6HZvNBqp8/Gq6VdAJU2S6w+FQEicJSemM6hjKD51RofmqiEaTAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/447a9464b25d6125f86cb3ae185288ad/a81b5/12.webp 163w,
/static/447a9464b25d6125f86cb3ae185288ad/da3ef/12.webp 325w,
/static/447a9464b25d6125f86cb3ae185288ad/309d5/12.webp 650w,
/static/447a9464b25d6125f86cb3ae185288ad/78344/12.webp 975w,
/static/447a9464b25d6125f86cb3ae185288ad/bdb72/12.webp 1300w,
/static/447a9464b25d6125f86cb3ae185288ad/617b0/12.webp 1384w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/447a9464b25d6125f86cb3ae185288ad/5e043/12.png 163w,
/static/447a9464b25d6125f86cb3ae185288ad/e5cc6/12.png 325w,
/static/447a9464b25d6125f86cb3ae185288ad/663f3/12.png 650w,
/static/447a9464b25d6125f86cb3ae185288ad/d880f/12.png 975w,
/static/447a9464b25d6125f86cb3ae185288ad/4c573/12.png 1300w,
/static/447a9464b25d6125f86cb3ae185288ad/622c8/12.png 1384w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/447a9464b25d6125f86cb3ae185288ad/663f3/12.png"
            alt="12"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>외부 설정으로 넘어온 프로필 값이 dev 라면 application-dev.properties 를 읽고 prod 라면
application-prod.properties 를 읽어서 사용하면 된다.</p>
<p>프로필</p>
<ul>
<li>스프링은 이런 곳에서 사용하기 위해 프로필이라는 개념을 지원한다.</li>
<li>spring.profiles.active 외부 설정에 값을 넣으면 해당 프로필을 사용한다고 판단한다.</li>
<li>프로필에 따라서 다음과 같은 규칙으로 해당 프로필에 맞는 내부 파일(설정 데이터)을 조회한다.
<ul>
<li><code>application-{profile}.properties</code></li>
</ul>
</li>
</ul>
<h4 id="하나의-파일로-통합" style="position:relative;"><a href="#%ED%95%98%EB%82%98%EC%9D%98-%ED%8C%8C%EC%9D%BC%EB%A1%9C-%ED%86%B5%ED%95%A9" aria-label="하나의 파일로 통합 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>하나의 파일로 통합</h4>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/753c5a972c9997d73bd32007a2702d24/55991/13.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 34.355828220858896%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABYElEQVR42kWR626CQBSEef8XaptYYxsa0CLFGvESIkV3wVJYWG7FIkyzp9GeZHP+nJnMN6sJIbDdbrHf77Hb7eC6LtI0hZphGHCdtm0hpURZlpC5xPl8vt0M/f+ddjgcYFkWGSZJQqIoikhYVRWquiLRzJ7ifnSH55cnTPQJ5gsLy/USi9UC7JPdzDVlZBgGHMfBZrNB0zTI85wSdF1Hu65rTOcmxuNHuO4KnDO07Te6S4e+v+CD+wjDkHSaSsIYo1Rqq8SqhutcsWcLG/PVEu/bNb1YZkjKHCcpEETsD10l5JzDtm3qzvd9SqlMVWdFURB6XVUwLRvG1IS7WYOFHDwKEUYhjuwIzw8ohLonZF3XCTkIAupNdakM+74nbDWm9YaH0Rgv5gyvtoM0L/BzGdB2PfbHkMxUXdrpdILneZRO7TiOkWXZDeGKLIsCX0mCVAh6IsuQigxJKlDXze2XfwHo0Ql3OlhW4QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/753c5a972c9997d73bd32007a2702d24/a81b5/13.webp 163w,
/static/753c5a972c9997d73bd32007a2702d24/da3ef/13.webp 325w,
/static/753c5a972c9997d73bd32007a2702d24/309d5/13.webp 650w,
/static/753c5a972c9997d73bd32007a2702d24/78344/13.webp 975w,
/static/753c5a972c9997d73bd32007a2702d24/bdb72/13.webp 1300w,
/static/753c5a972c9997d73bd32007a2702d24/6b515/13.webp 1390w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/753c5a972c9997d73bd32007a2702d24/5e043/13.png 163w,
/static/753c5a972c9997d73bd32007a2702d24/e5cc6/13.png 325w,
/static/753c5a972c9997d73bd32007a2702d24/663f3/13.png 650w,
/static/753c5a972c9997d73bd32007a2702d24/d880f/13.png 975w,
/static/753c5a972c9997d73bd32007a2702d24/4c573/13.png 1300w,
/static/753c5a972c9997d73bd32007a2702d24/55991/13.png 1390w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/753c5a972c9997d73bd32007a2702d24/663f3/13.png"
            alt="13"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>주의!</p>
<ul>
<li>속성 파일 구분 기호에는 선행 공백이 없어야 하며 정확히 3개의 하이픈 문자가 있어야 한다.</li>
<li>구분 기호 바로 앞과 뒤의 줄은 같은 주석 접두사가 아니어야 한다.</li>
<li>파일을 분할하는 #— 주석 위 아래는 주석을 적으면 안된다</li>
</ul>
<h4 id="우선순위" style="position:relative;"><a href="#%EC%9A%B0%EC%84%A0%EC%88%9C%EC%9C%84" aria-label="우선순위 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>우선순위</h4>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="23610332991879290000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`url=local.db.com
username=local_user
password=local_pw
#---
spring.config.activate.on-profile=dev
url=dev.db.com
username=dev_user
password=dev_pw
#---
spring.config.activate.on-profile=prod
url=prod.db.com
username=prod_user
password=prod_pw
#---
url=hello.db.com`, `23610332991879290000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="properties" data-index="24"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">url</span><span class="mtk1">=local.db.com</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">username</span><span class="mtk1">=local_user</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">password</span><span class="mtk1">=local_pw</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">#---</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">spring.config.activate.on-profile</span><span class="mtk1">=dev</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">url</span><span class="mtk1">=dev.db.com</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">username</span><span class="mtk1">=dev_user</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">password</span><span class="mtk1">=dev_pw</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">#---</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">spring.config.activate.on-profile</span><span class="mtk1">=prod</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">url</span><span class="mtk1">=prod.db.com</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">username</span><span class="mtk1">=prod_user</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">password</span><span class="mtk1">=prod_pw</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">#---</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">url</span><span class="mtk1">=hello.db.com</span></span></span></code></pre>
<p>단순하게 문서를 위에서 아래로 순서대로 읽으면서 값을 설정한다. 이때 기존 데이터가 있으면 덮어쓴다.</p>
<hr>
<p>우선순위는 위에서 아래로 적용된다. 아래가 더 우선순위가 높다.</p>
<p>자주 사용하는 우선순위</p>
<ul>
<li>설정 데이터( application.properties )</li>
<li>OS 환경변수</li>
<li>자바 시스템 속성</li>
<li>커맨드 라인 옵션 인수</li>
<li>@TestPropertySource (테스트에서 사용)</li>
</ul>
<p>설정 데이터 우선순위</p>
<ul>
<li>jar 내부 application.properties</li>
<li>jar 내부 프로필 적용 파일 application-{profile}.properties</li>
<li>jar 외부 application.properties</li>
<li>jar 외부 프로필 적용 파일 application-{profile}.properties</li>
</ul>
<p>정리</p>
<ul>
<li>실무에서 대부분의 개발자들은 applicaiton.properties 에 외부 설정값들을 보관한다.</li>
<li>사용하다가 일부 속성을 변경할 필요가 있다면 더 높은 우선순위를 가지는 자바 시스템 속성이나 커맨드 라인 옵션 인수를 사용하면 되는 것이다.</li>
</ul>
<h1 id="외부-설정과-프로필-2" style="position:relative;"><a href="#%EC%99%B8%EB%B6%80-%EC%84%A4%EC%A0%95%EA%B3%BC-%ED%94%84%EB%A1%9C%ED%95%84-2" aria-label="외부 설정과 프로필 2 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>외부 설정과 프로필 2</h1>
<h4 id="외부-설정-사용---environment" style="position:relative;"><a href="#%EC%99%B8%EB%B6%80-%EC%84%A4%EC%A0%95-%EC%82%AC%EC%9A%A9---environment" aria-label="외부 설정 사용   environment permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>외부 설정 사용 - Environment</h4>
<p>다음과 같은 외부 설정들은 스프링이 제공하는 Environment 를 통해서 일관된 방식으로 조회할 수 있다.</p>
<p>스프링이 지원하는 다양한 외부 설정 조회 방법</p>
<ul>
<li>Environment</li>
<li>@Value - 값 주입</li>
<li>@ConfigurationProperties - 타입 안전한 설정 속성</li>
</ul>
<p>외부 속성을 사용하기 위해 preperties를 작성</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="67473687070835850000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`my.datasource.url=local.db.com
my.datasource.username=local_user
my.datasource.password=local_pw
my.datasource.etc.max-connection=1
my.datasource.etc.timeout=3500ms
my.datasource.etc.options=CACHE,ADMIN`, `67473687070835850000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="properties" data-index="25"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">my.datasource.url</span><span class="mtk1">=local.db.com</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk4">my.datasource.username</span><span class="mtk1">=local_user</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">my.datasource.password</span><span class="mtk1">=local_pw</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk4">my.datasource.etc.max-connection</span><span class="mtk1">=1</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk4">my.datasource.etc.timeout</span><span class="mtk1">=3500ms</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk4">my.datasource.etc.options</span><span class="mtk1">=CACHE,ADMIN</span></span></span></code></pre>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="80986230056737690000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Slf4j
@Configuration
public class MyDataSourceEnvConfig {
    private final Environment env;
    public MyDataSourceEnvConfig(Environment env) {
        this.env = env;
    }
    @Bean
    public MyDataSource myDataSource() {
        String url = env.getProperty(&quot;my.datasource.url&quot;);
        String username = env.getProperty(&quot;my.datasource.username&quot;);
        String password = env.getProperty(&quot;my.datasource.password&quot;);
        int maxConnection = env.getProperty(&quot;my.datasource.etc.max-connection&quot;, Integer.class);
        Duration timeout = env.getProperty(&quot;my.datasource.etc.timeout&quot;, Duration.class);
        List<String> options = env.getProperty(&quot;my.datasource.etc.options&quot;, List.class);
        return new MyDataSource(url, username, password, maxConnection, timeout, options);
    }
}`, `80986230056737690000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="26"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Configuration</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">MyDataSourceEnvConfig</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk4">final</span><span class="mtk1"> </span><span class="mtk10">Environment</span><span class="mtk1"> </span><span class="mtk12">env</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk11">MyDataSourceEnvConfig</span><span class="mtk1">(</span><span class="mtk10">Environment</span><span class="mtk1"> </span><span class="mtk12">env</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">env</span><span class="mtk1"> = env;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">MyDataSource</span><span class="mtk1"> </span><span class="mtk11">myDataSource</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">url</span><span class="mtk1"> = </span><span class="mtk12">env</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;my.datasource.url&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">username</span><span class="mtk1"> = </span><span class="mtk12">env</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;my.datasource.username&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">password</span><span class="mtk1"> = </span><span class="mtk12">env</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;my.datasource.password&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">int</span><span class="mtk1"> </span><span class="mtk12">maxConnection</span><span class="mtk1"> = </span><span class="mtk12">env</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;my.datasource.etc.max-connection&quot;</span><span class="mtk1">, </span><span class="mtk12">Integer</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">Duration</span><span class="mtk1"> </span><span class="mtk12">timeout</span><span class="mtk1"> = </span><span class="mtk12">env</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;my.datasource.etc.timeout&quot;</span><span class="mtk1">, </span><span class="mtk12">Duration</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk10">List</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">options</span><span class="mtk1"> = </span><span class="mtk12">env</span><span class="mtk1">.</span><span class="mtk11">getProperty</span><span class="mtk1">(</span><span class="mtk8">&quot;my.datasource.etc.options&quot;</span><span class="mtk1">, </span><span class="mtk12">List</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">MyDataSource</span><span class="mtk1">(url, username, password, maxConnection, timeout, options);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>Environment 를 사용하면 외부 설정의 종류와 관계없이 코드 안에서 일관성 있게 외부 설정을 조회할 수 있다.</li>
<li>Environment.getProperty(key, Type) 를 호출할 때 타입 정보를 주면 해당 타입으로 변환해준다. (스프링 내부 변환기가 작동한다.)
<ul>
<li>env.getProperty(“my.datasource.etc.max-connection”, Integer.class) : 문자 숫자로 변환</li>
<li>env.getProperty(“my.datasource.etc.timeout”, Duration.class) : 문자 Duration (기간) 변환</li>
<li>env.getProperty(“my.datasource.etc.options”, List.class) : 문자 List 변환 ( A,B [A,B] )</li>
</ul>
</li>
</ul>
<h4 id="외부설정-사용---value" style="position:relative;"><a href="#%EC%99%B8%EB%B6%80%EC%84%A4%EC%A0%95-%EC%82%AC%EC%9A%A9---value" aria-label="외부설정 사용   value permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>외부설정 사용 - @Value</h4>
<ul>
<li>@Value 에 ${} 를 사용해서 외부 설정의 키 값을 주면 원하는 값을 주입 받을 수 있다.</li>
<li>@Value 는 필드에 사용할 수도 있고, 파라미터에 사용할 수도 있다.</li>
<li>만약 키를 찾지 못할 경우 코드에서 기본값을 사용하려면 다음과 같이 : 뒤에 기본값을 적어주면 된다.
<ul>
<li>예) <code>@Value("${my.datasource.etc.max-connection:1}")</code></li>
</ul>
</li>
</ul>
<h4 id="외부설정-사용---configurationproperties" style="position:relative;"><a href="#%EC%99%B8%EB%B6%80%EC%84%A4%EC%A0%95-%EC%82%AC%EC%9A%A9---configurationproperties" aria-label="외부설정 사용   configurationproperties permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>외부설정 사용 - @ConfigurationProperties</h4>
<p>Type-safe Configuration Properties</p>
<ul>
<li>스프링은 외부 설정의 묶음 정보를 객체로 변환하는 기능을 제공한다. 이것을 타입 안전한 설정 속성이라 한다</li>
<li>외부 설정을 자바 코드로 관리</li>
<li>설정 정보 그 자체도 타입을 가지게 된다.</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="98421175410806280000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Data
@ConfigurationProperties(&quot;my.datasource&quot;)
public class MyDataSourcePropertiesV1 {
    private String url;
    private String username;
    private String password;
    private Etc etc = new Etc();
    @Data
    public static class Etc {
        private int maxConnection;
        private Duration timeout;
        private List<String> options = new ArrayList<>();
    }
}`, `98421175410806280000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="27"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Data</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">ConfigurationProperties</span><span class="mtk1">(</span><span class="mtk8">&quot;my.datasource&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">MyDataSourcePropertiesV1</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">url</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">username</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">password</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">Etc</span><span class="mtk1"> </span><span class="mtk12">etc</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">Etc</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Data</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">Etc</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">int</span><span class="mtk1"> </span><span class="mtk12">maxConnection</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">Duration</span><span class="mtk1"> </span><span class="mtk12">timeout</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">List</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">options</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk10">ArrayList</span><span class="mtk1">&lt;&gt;();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>외부 설정을 주입 받을 객체를 생성한다. 그리고 각 필드를 외부 설정의 키 값에 맞추어 준비한다.</li>
<li>@ConfigurationProperties 이 있으면 외부 설정을 주입 받는 객체라는 뜻이다. 여기에 외부 설정 KEY의 묶음 시작점인 my.datasource 를 적어준다.</li>
<li>기본 주입 방식은 자바빈 프로퍼티 방식이다. Getter , Setter 가 필요하다. (롬복의 @Data 에 의해 자동 생성된다.)</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="35913210331342225000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Slf4j
@EnableConfigurationProperties(MyDataSourcePropertiesV1.class)
public class MyDataSourceConfigV1 {
    private final MyDataSourcePropertiesV1 properties;
    public MyDataSourceConfigV1(MyDataSourcePropertiesV1 properties) {
        this.properties = properties;
    }
    @Bean
    public MyDataSource dataSource() {
        return new MyDataSource(
                properties.getUrl(),
                properties.getUsername(),
                properties.getPassword(),
                properties.getEtc().getMaxConnection(),
                properties.getEtc().getTimeout(),
                properties.getEtc().getOptions());
    }
}`, `35913210331342225000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="28"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">EnableConfigurationProperties</span><span class="mtk1">(</span><span class="mtk12">MyDataSourcePropertiesV1</span><span class="mtk1">.</span><span class="mtk12">class</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">MyDataSourceConfigV1</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk4">final</span><span class="mtk1"> </span><span class="mtk10">MyDataSourcePropertiesV1</span><span class="mtk1"> </span><span class="mtk12">properties</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk11">MyDataSourceConfigV1</span><span class="mtk1">(</span><span class="mtk10">MyDataSourcePropertiesV1</span><span class="mtk1"> </span><span class="mtk12">properties</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">properties</span><span class="mtk1"> = properties;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">MyDataSource</span><span class="mtk1"> </span><span class="mtk11">dataSource</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">MyDataSource</span><span class="mtk1">(</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">                </span><span class="mtk12">properties</span><span class="mtk1">.</span><span class="mtk11">getUrl</span><span class="mtk1">(),</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">                </span><span class="mtk12">properties</span><span class="mtk1">.</span><span class="mtk11">getUsername</span><span class="mtk1">(),</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">                </span><span class="mtk12">properties</span><span class="mtk1">.</span><span class="mtk11">getPassword</span><span class="mtk1">(),</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">                </span><span class="mtk12">properties</span><span class="mtk1">.</span><span class="mtk11">getEtc</span><span class="mtk1">().</span><span class="mtk11">getMaxConnection</span><span class="mtk1">(),</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">                </span><span class="mtk12">properties</span><span class="mtk1">.</span><span class="mtk11">getEtc</span><span class="mtk1">().</span><span class="mtk11">getTimeout</span><span class="mtk1">(),</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">                </span><span class="mtk12">properties</span><span class="mtk1">.</span><span class="mtk11">getEtc</span><span class="mtk1">().</span><span class="mtk11">getOptions</span><span class="mtk1">());</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>@EnableConfigurationProperties(MyDataSourcePropertiesV1.class)
<ul>
<li>스프링에게 사용할 @ConfigurationProperties 를 지정해주어야 한다. 이렇게 하면 해당 클래스는 스프링 빈으로 등록되고, 필요한 곳에서 주입 받아서 사용할 수 있다.</li>
</ul>
</li>
<li>private final MyDataSourcePropertiesV1 properties 설정 속성을 생성자를 통해 주입 받아서 사용한다.</li>
</ul>
<p>타입 안전</p>
<ul>
<li>ConfigurationProperties 를 사용하면 타입 안전한 설정 속성을 사용할 수 있다</li>
<li>타입이 다르면 오류 발생 (ex - Int인데 String인 경우)</li>
</ul>
<p>정리</p>
<p>application.properties 에 필요한 외부 설정을 추가하고, @ConfigurationProperties 를 통해서 MyDataSourcePropertiesV1 에 외부 설정의 값들을 설정</p>
<hr>
<p>표기법 변환</p>
<p>스프링은 캐밥 표기법을 자바 낙타 표기법으로 중간에서 자동으로 변환해준다.</p>
<ul>
<li>application.properties 에서는 max-connection</li>
<li>자바 코드에서는 maxConnection</li>
</ul>
<p>@ConfigurationPropertiesScan</p>
<ul>
<li>@ConfigurationProperties 를 하나하나 직접 등록할 때는 @EnableConfigurationProperties 를 사용한다.</li>
<li>@ConfigurationProperties 를 특정 범위로 자동 등록할 때는 @ConfigurationPropertiesScan 을 사용하면 된다.</li>
</ul>
<p>여기서 문제 상황</p>
<ul>
<li>Setter 를 가지고 있기 때문에 누군가 실수로 값을 변경하는 문제가 발생할 수 있다.</li>
<li>Setter 를 제거하고 대신에 생성자를 사용하면 중간에 데이터를 변경하는 실수를 근본적으로 방지할 수 있다.</li>
<li><strong>좋은 프로그램은 제약이 있는 프로그램이다</strong></li>
</ul>
<hr>
<p>@ConfigurationProperties 는 Getter, Setter를 사용하는 자바빈 프로퍼티 방식이 아니라 생성자를 통해서 객체를 만드는 기능도 지원한다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="92039898578205310000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`
@Getter
@ConfigurationProperties(&quot;my.datasource&quot;)
public class MyDataSourcePropertiesV2 {
    private String url;
    private String username;
    private String password;
    private Etc etc;
    public MyDataSourcePropertiesV2(String url, String username, String password, @DefaultValue Etc etc) {
        this.url = url;
        this.username = username;
        this.password = password;
        this.etc = etc;
    }
    @Getter
    public static class Etc {
        private int maxConnection;
        private Duration timeout;
        private List<String> options;
        public Etc(int maxConnection, Duration timeout, @DefaultValue(&quot;DEFAULT&quot;) List<String> options) {
            this.maxConnection = maxConnection;
            this.timeout = timeout;
            this.options = options;
        }
    }
}`, `92039898578205310000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="29"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Getter</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">ConfigurationProperties</span><span class="mtk1">(</span><span class="mtk8">&quot;my.datasource&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">MyDataSourcePropertiesV2</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">url</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">username</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">password</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">Etc</span><span class="mtk1"> </span><span class="mtk12">etc</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk11">MyDataSourcePropertiesV2</span><span class="mtk1">(</span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">url</span><span class="mtk1">, </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">username</span><span class="mtk1">, </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk12">password</span><span class="mtk1">, @</span><span class="mtk10">DefaultValue</span><span class="mtk1"> </span><span class="mtk10">Etc</span><span class="mtk1"> </span><span class="mtk12">etc</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">url</span><span class="mtk1"> = url;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">username</span><span class="mtk1"> = username;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">password</span><span class="mtk1"> = password;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">etc</span><span class="mtk1"> = etc;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Getter</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">Etc</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">int</span><span class="mtk1"> </span><span class="mtk12">maxConnection</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">Duration</span><span class="mtk1"> </span><span class="mtk12">timeout</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">List</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">options</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk11">Etc</span><span class="mtk1">(</span><span class="mtk10">int</span><span class="mtk1"> </span><span class="mtk12">maxConnection</span><span class="mtk1">, </span><span class="mtk10">Duration</span><span class="mtk1"> </span><span class="mtk12">timeout</span><span class="mtk1">, @</span><span class="mtk10">DefaultValue</span><span class="mtk1">(</span><span class="mtk8">&quot;DEFAULT&quot;</span><span class="mtk1">) </span><span class="mtk10">List</span><span class="mtk1">&lt;</span><span class="mtk10">String</span><span class="mtk1">&gt; </span><span class="mtk12">options</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">maxConnection</span><span class="mtk1"> = maxConnection;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">timeout</span><span class="mtk1"> = timeout;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">options</span><span class="mtk1"> = options;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>생성자를 만들어 두면 생성자를 통해서 설정 정보를 주입한다.</li>
<li>@Getter 롬복이 자동으로 getter 를 만들어준다.</li>
<li>@DefaultValue : 해당 값을 찾을 수 없는 경우 기본값을 사용한다.
<ul>
<li><code>@DefaultValue Etc etc</code>
<ul>
<li>etc 를 찾을 수 없을 경우 Etc 객체를 생성하고 내부에 들어가는 값은 비워둔다. ( null , 0 )</li>
</ul>
</li>
<li><code>@DefaultValue("DEFAULT") List&#x3C;String> options</code>
<ul>
<li>options 를 찾을 수 없을 경우 DEFAULT 라는 이름의 값을 사용한다.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>정리</p>
<p>application.properties 에 필요한 외부 설정을 추가하고, @ConfigurationProperties 의 생성자 주입을통해서 값을 읽어들였다. Setter 가 없으므로 개발자가 중간에 실수로 값을 변경하는 문제가 발생하지 않는다.</p>
<p>문제</p>
<ul>
<li>숫자에 문자가 들어오는 것 같은 기본적인 타입 문제들은 해결이 되었따.</li>
<li>숫자의 범위 지정같은 경우는 어떻게 할까</li>
</ul>
<hr>
<p>@ConfigurationProperties 은 자바 객체이기 때문에 스프링이 자바 빈 검증기를 사용할 수 있도록 지원</p>
<ul>
<li>@Validated 애노테이션이 있어야 검증을 실행한다. (클래스에 달아줘야 함)</li>
<li>필드에 어노테이션을 추가한다
<ul>
<li>@NotEmpty url , username , password 는 항상 값이 있어야 한다. 필수 값이 된다.</li>
<li>@Min(1) @Max(999) maxConnection : 최소 1 , 최대 999 의 값을 허용한다.</li>
<li>@DurationMin(seconds = 1) @DurationMax(seconds = 60) : 최소 1, 최대 60초를 허용한다.</li>
</ul>
</li>
</ul>
<p><code>jakarta.validation.constraints.Max</code><br>
패키지 이름에 jakarta.validation 으로 시작하는 것은 자바 표준 검증기에서 지원하는 기능이다</p>
<hr>
<p>ConfigurationProperties 장점</p>
<ul>
<li>외부 설정을 객체로 편리하게 변환해서 사용할 수 있다.</li>
<li>외부 설정의 계층을 객체로 편리하게 표현할 수 있다.</li>
<li>외부 설정을 타입 안전하게 사용할 수 있다.</li>
<li>검증기를 적용할 수 있다.</li>
</ul>
<h4 id="yaml" style="position:relative;"><a href="#yaml" aria-label="yaml permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>YAML</h4>
<p>스프링은 설정 데이터를 사용할 때 application.properties 뿐만 아니라 application.yml 이라는 형식도 지원한다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="42493615888740500000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`my:
  datasource:
    url: local.db.com
    username: local_user
    password: local_pw
    etc:
      maxConnection: 2
      timeout: 60s
      options: LOCAL, CACHE
---
spring:
  config:
    activate:
    on-profile: dev
my:
  datasource:
    url: dev.db.com
    username: dev_user
    password: dev_pw
    etc:
      maxConnection: 10
      timeout: 60s
      options: DEV, CACHE
---
spring:
  config:
    activate:
      on-profile: prod
my:
  datasource:
    url: prod.db.com
    username: prod_user
    password: prod_pw
    etc:
      maxConnection: 50
      timeout: 10s
      options: PROD, CACHE`, `42493615888740500000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="yaml" data-index="30"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">my</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">datasource</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">url</span><span class="mtk1">: </span><span class="mtk8">local.db.com</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">username</span><span class="mtk1">: </span><span class="mtk8">local_user</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">password</span><span class="mtk1">: </span><span class="mtk8">local_pw</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">etc</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">maxConnection</span><span class="mtk1">: </span><span class="mtk7">2</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">timeout</span><span class="mtk1">: </span><span class="mtk8">60s</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">options</span><span class="mtk1">: </span><span class="mtk8">LOCAL, CACHE</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">---</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">spring</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">config</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">activate</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">on-profile</span><span class="mtk1">: </span><span class="mtk8">dev</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">my</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">datasource</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">url</span><span class="mtk1">: </span><span class="mtk8">dev.db.com</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">username</span><span class="mtk1">: </span><span class="mtk8">dev_user</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">password</span><span class="mtk1">: </span><span class="mtk8">dev_pw</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">etc</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">maxConnection</span><span class="mtk1">: </span><span class="mtk7">10</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">timeout</span><span class="mtk1">: </span><span class="mtk8">60s</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">options</span><span class="mtk1">: </span><span class="mtk8">DEV, CACHE</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">---</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">spring</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">config</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">activate</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">on-profile</span><span class="mtk1">: </span><span class="mtk8">prod</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">my</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">datasource</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">url</span><span class="mtk1">: </span><span class="mtk8">prod.db.com</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">username</span><span class="mtk1">: </span><span class="mtk8">prod_user</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">password</span><span class="mtk1">: </span><span class="mtk8">prod_pw</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">etc</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">maxConnection</span><span class="mtk1">: </span><span class="mtk7">50</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">timeout</span><span class="mtk1">: </span><span class="mtk8">10s</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">options</span><span class="mtk1">: </span><span class="mtk8">PROD, CACHE</span></span></span></code></pre>
<p>주의
application.properties , application.yml 을 같이 사용하면 application.properties가 우선권을 가진다</p>
<h4 id="profile" style="position:relative;"><a href="#profile" aria-label="profile permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>@Profile</h4>
<ul>
<li>프로필과 외부 설정을 사용해서 각 환경마다 설정값을 다르게 적용하는 것은 이해했다.</li>
<li>설정값이 다른 정도가 아니라 각 환경마다 서로 다른 빈을 등록해야 한다면 어떻게 해야할까?
<ul>
<li>ex) 로컬 개발 환경에서는 실제 결제가 발생하면 문제가 되니 가짜 결제 기능이 있는 스프링 빈을 등록하고, 운영 환경에서는 실제 결제 기능을 제공하는 스프링 빈을 등록한다고 가정</li>
</ul>
</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="54367006406105030000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Slf4j
@Configuration
public class PayConfig {
    @Bean
    @Profile(&quot;default&quot;)
    public LocalPayClient localPayClient() {
        log.info(&quot;LocalPayClient 빈 등록&quot;);
        return new LocalPayClient();
    }
    @Bean
    @Profile(&quot;prod&quot;)
    public ProdPayClient prodPayClient() {
        log.info(&quot;ProdPayClient 빈 등록&quot;);
        return new ProdPayClient();
    }
}`, `54367006406105030000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="31"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Configuration</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">PayConfig</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Profile</span><span class="mtk1">(</span><span class="mtk8">&quot;default&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">LocalPayClient</span><span class="mtk1"> </span><span class="mtk11">localPayClient</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;LocalPayClient 빈 등록&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">LocalPayClient</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Profile</span><span class="mtk1">(</span><span class="mtk8">&quot;prod&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">ProdPayClient</span><span class="mtk1"> </span><span class="mtk11">prodPayClient</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;ProdPayClient 빈 등록&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">ProdPayClient</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>@Profile 애노테이션을 사용하면 해당 프로필이 활성화된 경우에만 빈을 등록한다.</li>
<li>스프링은 @Conditional 기능을 활용해서 개발자가 더 편리하게 사용할 수 있는 @Profile 기능을 제공하는 것이다.</li>
</ul>
<p>@Profile 을 사용하면 각 환경 별로 외부 설정 값을 분리하는 것을 넘어서, 등록되는 스프링 빈도 분리할 수 있다</p>
<h1 id="액츄에이터" style="position:relative;"><a href="#%EC%95%A1%EC%B8%84%EC%97%90%EC%9D%B4%ED%84%B0" aria-label="액츄에이터 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>액츄에이터</h1>
<h4 id="프로덕션-준비-기능이란" style="position:relative;"><a href="#%ED%94%84%EB%A1%9C%EB%8D%95%EC%85%98-%EC%A4%80%EB%B9%84-%EA%B8%B0%EB%8A%A5%EC%9D%B4%EB%9E%80" aria-label="프로덕션 준비 기능이란 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로덕션 준비 기능이란?</h4>
<ul>
<li>
<p>서비스에 문제가 없는지 모니터링하고 지표들을 심어서 감시하는 활동</p>
</li>
<li>
<p>운영 환경에서 서비스할 때 필요한 이런 기능들을 프로덕션 준비 기능이라 한다.</p>
</li>
<li>
<p>프로덕션을 운영에 배포할 때 준비해야 하는 비 기능적 요소들을 뜻한다</p>
</li>
<li>
<p>애플리케이션이 현재 살아있는지, 로그 정보는 정상 설정 되었는지, 커넥션 풀은 얼마나 사용되고 있는지 등</p>
</li>
<li>
<p>지표(metric), 추적(trace), 감사(auditing)</p>
</li>
<li>
<p>모니터링</p>
</li>
</ul>
<p>스프링 부트가 제공하는 액추에이터는 이런 프로덕션 준비 기능을 매우 편리하게 사용할 수 있는 다양한 편의 기능들을 제공한다.</p>
<p>더 나아가서 마이크로미터, 프로메테우스, 그라파나 같은 최근 유행하는 모니터링 시스템과 매우 쉽게 연동할 수 있는 기능도 제공한다.</p>
<hr>
<ul>
<li>localhost:8080/actuator/health -> 이 기능은 현재 서버가 잘 동작하고 있는지 애플리케이션의 헬스 상태를 나타낸다.</li>
<li>액츄에이터는 /actuator 경로를 통해서 기능을 제공한다 -> 액츄에이터가 제공하는 수 많은 기능을 확인할 수 있다.</li>
<li>액츄에이터가 제공하는 기능 하나하나를 엔드포인트라 한다. health 는 헬스 정보를, beans 는 스프링 컨테이너에 등록된 빈을 보여준다</li>
</ul>
<p>액츄에이터 기능을 웹에 노출</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="23780081934384435000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`management:
  endpoints:
    web:
      exposure:
        include: '*'`, `23780081934384435000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="yml" data-index="32"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">management</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">endpoints</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">web</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">exposure</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">include</span><span class="mtk1">: </span><span class="mtk8">&#39;*&#39;</span></span></span></code></pre>
<h4 id="엔드-포인트-설정" style="position:relative;"><a href="#%EC%97%94%EB%93%9C-%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EC%84%A4%EC%A0%95" aria-label="엔드 포인트 설정 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>엔드 포인트 설정</h4>
<p>엔드포인트를 사용하려면 다음 2가지 과정이 모두 필요하다.</p>
<ol>
<li>엔드포인트 활성화</li>
<li>엔드포인트 노출</li>
</ol>
<ul>
<li>엔드포인트를 활성화 한다는 것은 해당 기능 자체를 사용할지 말지 on , off 를 선택</li>
<li>엔드포인트를 노출하는 것은 활성화된 엔드포인트를 HTTP에 노출할지 아니면 JMX에 노출할지 선택</li>
<li>엔드포인트는 대부분 기본으로 활성화</li>
<li>따라서 어떤 엔드포인트를 노출할지 선택하면 된다</li>
<li>위의 yml파일이 웹에 노출하는 설정이다.</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="89788202293623600000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`management:
  endpoint:
    shutdown:
      enabled: true
  endpoints:
    web:
      exposure:
        include: '*'`, `89788202293623600000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="yml" data-index="33"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">management</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">endpoint</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">shutdown</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">enabled</span><span class="mtk1">: </span><span class="mtk4">true</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">endpoints</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">web</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">exposure</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">include</span><span class="mtk1">: </span><span class="mtk8">&#39;*&#39;</span></span></span></code></pre>
<p>shutdown기능은 기본적으로 꺼져있는데 키면 /actuator/shutdown시 서버가 종료된다.</p>
<h4 id="다양한-엔드포인트" style="position:relative;"><a href="#%EB%8B%A4%EC%96%91%ED%95%9C-%EC%97%94%EB%93%9C%ED%8F%AC%EC%9D%B8%ED%8A%B8" aria-label="다양한 엔드포인트 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>다양한 엔드포인트</h4>
<ul>
<li>beans : 스프링 컨테이너에 등록된 스프링 빈을 보여준다.</li>
<li>conditions : condition 을 통해서 빈을 등록할 때 평가 조건과 일치하거나 일치하지 않는 이유를 표시한다.</li>
<li>configprops : @ConfigurationProperties 를 보여준다.</li>
<li>env : Environment 정보를 보여준다.</li>
<li>health : 애플리케이션 헬스 정보를 보여준다.</li>
<li>httpexchanges : HTTP 호출 응답 정보를 보여준다. HttpExchangeRepository 를 구현한 빈을 별도로 등록해야 한다.</li>
<li>info : 애플리케이션 정보를 보여준다.</li>
<li>loggers : 애플리케이션 로거 설정을 보여주고 변경도 할 수 있다.</li>
<li>metrics : 애플리케이션의 메트릭 정보를 보여준다.</li>
<li>mappings : @RequestMapping 정보를 보여준다.</li>
<li>threaddump : 쓰레드 덤프를 실행해서 보여준다.</li>
<li>shutdown : 애플리케이션을 종료한다. 이 기능은 기본으로 비활성화 되어 있다.</li>
</ul>
<p>health , info , loggers , httpexchanges , metrics 는 더 자세히 알아본다.</p>
<h4 id="헬스-정보" style="position:relative;"><a href="#%ED%97%AC%EC%8A%A4-%EC%A0%95%EB%B3%B4" aria-label="헬스 정보 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>헬스 정보</h4>
<p>헬스 정보를 사용하면 애플리케이션에 문제가 발생했을 때 문제를 빠르게 인지할 수 있다</p>
<ul>
<li>헬스 정보는 단순히 애플리케이션이 요청에 응답을 할 수 있는지 판단하는 것을 넘어서 애플리케이션이 사용하는 데이터베이스가 응답하는지, 디스크 사용량에는 문제가 없는지 같은 다양한 정보들을 포함해서 만들어진다.</li>
</ul>
<p>헬스 정보를 더 자세히 보려면 다음 옵션을 지정한다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="77792002173137240000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`management:
  endpoint:
    health:
      show-details: always
      # 간단하게 노출
      # show-components: always`, `77792002173137240000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="yml" data-index="34"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">management</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">endpoint</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">health</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">show-details</span><span class="mtk1">: </span><span class="mtk8">always</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3"># 간단하게 노출</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3"># show-components: always</span></span></span></code></pre>
<p>Tip!</p>
<ul>
<li>자세한 헬스 기본 지원 기능은 다음 <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html#actuator.endpoints.health.auto-configured-health-indicators" target="_blank" rel="nofollow noopener noreferrer">공식 메뉴얼</a>을 참고하자</li>
</ul>
<h4 id="애플리케이션-정보" style="position:relative;"><a href="#%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%A0%95%EB%B3%B4" aria-label="애플리케이션 정보 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>애플리케이션 정보</h4>
<p>info 엔드포인트는 애플리케이션의 기본 정보를 노출한다.</p>
<ul>
<li>java : 자바 런타임 정보</li>
<li>os : OS 정보</li>
<li>env : Environment 에서 info. 로 시작하는 정보</li>
<li>build : 빌드 정보, META-INF/build-info.properties 파일이 필요하다.</li>
<li>git : git 정보, git.properties 파일이 필요하다.</li>
</ul>
<p>java, os, env 정보</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="88045534659574050000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`management:
  endpoint:
    shutdown:
      enabled: true
    health:
      show-details: always
  endpoints:
    web:
      exposure:
        include: '*'
  info:
    java:
      enabled: true
    os:
      enabled: true
    env:
      enabled: true
info:
  app:
    name: hello-actuator
    company: yh`, `88045534659574050000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="yml" data-index="35"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">management</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">endpoint</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">shutdown</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">enabled</span><span class="mtk1">: </span><span class="mtk4">true</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">health</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">show-details</span><span class="mtk1">: </span><span class="mtk8">always</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">endpoints</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">web</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">exposure</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">include</span><span class="mtk1">: </span><span class="mtk8">&#39;*&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">info</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">java</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">enabled</span><span class="mtk1">: </span><span class="mtk4">true</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">os</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">enabled</span><span class="mtk1">: </span><span class="mtk4">true</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">env</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">enabled</span><span class="mtk1">: </span><span class="mtk4">true</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk4">info</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="19"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">app</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="20"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">hello-actuator</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="21"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">company</span><span class="mtk1">: </span><span class="mtk8">yh</span></span></span></code></pre>
<p>build정보</p>
<ul>
<li>빌드 정보를 노출하려면 빌드 시점에 META-INF/build-info.properties 파일을 만들어야 한다.</li>
<li>gradle 을 사용하면 다음 내용을 추가하면 된다</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="67714983741805445000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`springBoot {
  buildInfo()
}`, `67714983741805445000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="gradle" data-index="36"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">springBoot {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  buildInfo()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>이렇게 하고 빌드를 해보면 build 폴더안에 resources/main/META-INF/build-info.properties 파일을 확인할 수 있다</p>
<p>git</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="46238937712624886000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`\`\`\`groovy
plugins {
  ...
  id &quot;com.gorylenko.gradle-git-properties&quot; version &quot;2.4.1&quot; //git info
}`, `46238937712624886000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="gradle" data-index="37"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">```groovy</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">plugins {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  ...</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  id </span><span class="mtk8">&quot;com.gorylenko.gradle-git-properties&quot;</span><span class="mtk1"> version </span><span class="mtk8">&quot;2.4.1&quot;</span><span class="mtk1"> </span><span class="mtk3">//git info</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>빌드를 해보면 build 폴더안에 resources/main/git.properties 파일을 확인할 수 있다</p>
<p>더 자세한 정보를 보고 싶으면 다음 옵션을 적용한다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="95038165538207880000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`management:
  info:
    git:
      mode: 'full'`, `95038165538207880000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="yml" data-index="38"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">management</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">info</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">git</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">mode</span><span class="mtk1">: </span><span class="mtk8">&#39;full&#39;</span></span></span></code></pre>
<h4 id="로거" style="position:relative;"><a href="#%EB%A1%9C%EA%B1%B0" aria-label="로거 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>로거</h4>
<p>loggers 엔드포인트를 사용하면 로깅과 관련된 정보를 확인하고, 또 실시간으로 변경할 수도 있다. 코드를 통해서 알아보자.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="70195820491218070000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`logging:
  level:
    hello.controller: debug`, `70195820491218070000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="yml" data-index="39"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">logging</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">level</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">hello.controller</span><span class="mtk1">: </span><span class="mtk8">debug</span></span></span></code></pre>
<p>hello.controller 패키지와 그 하위는 debug 레벨을 출력하도록 했다. 이제 앞서 만든 LogController 클래스도 debug 레벨의 영향을 받는다.</p>
<ul>
<li>로그를 별도로 설정하지 않으면 스프링 부트는 기본으로 INFO 를 사용한다. 실행 결과를 보면 ROOT 의 configuredLevel 가 INFO 인 것을 확인할 수 있다. 그 하위도 모두 INFO 레벨이 적용된다.</li>
<li>앞서 우리는 hello.controller 는 DEBUG 로 설정했다. 그래서 해당 부분에서 configuredLevel이 DEBUG 로 설정된 것을 확인할 수 있다. 그 하위도 DEBUG 레벨이 적용된다.</li>
</ul>
<h4 id="실시간-로그-레벨-변경" style="position:relative;"><a href="#%EC%8B%A4%EC%8B%9C%EA%B0%84-%EB%A1%9C%EA%B7%B8-%EB%A0%88%EB%B2%A8-%EB%B3%80%EA%B2%BD" aria-label="실시간 로그 레벨 변경 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>실시간 로그 레벨 변경</h4>
<p>개발 서버는 보통 DEBUG 로그를 사용하지만, 운영 서버는 보통 요청이 아주 많다. 따라서 로그도 너무 많이 남기 때문에 DEBUG 로그까지 모두 출력하게 되면 성능이나 디스크에 영향을 주게 된다. 그래서 운영 서버는 중요하다고 판단되는 INFO 로그 레벨을 사용한다.</p>
<p>loggers 엔드포인트를 사용하면 애플리케이션을 다시 시작하지 않고, 실시간으로 로그 레벨을 변경할 수 있다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/72f3e3de08f51744182c65c322bee7ad/cc0ea/14.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 19.018404907975462%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAt0lEQVR42l3M62qEQAyGYe//EqULo3NyRaqdU2bc4lsc+mPZwEO+JJBhM4ZDa36MYVcTYZ5JzhOdJ8y653AzlriuSK202sg5U0W4rov3GtQ0MY4jxlq+Hg+0tbh1Y/ZPtHFY/0Rpi7ae2fq+W5YFpRTWOYpUXq9fWjt7H75zYzqEaS/dFitpWYh+odSTUioijfJB7ps0YipdiLk/H2IW9lg4/oUk5JBIIZKykN+kD7ncanfPtZ78AZVMMPrsjjxVAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/72f3e3de08f51744182c65c322bee7ad/a81b5/14.webp 163w,
/static/72f3e3de08f51744182c65c322bee7ad/da3ef/14.webp 325w,
/static/72f3e3de08f51744182c65c322bee7ad/309d5/14.webp 650w,
/static/72f3e3de08f51744182c65c322bee7ad/78344/14.webp 975w,
/static/72f3e3de08f51744182c65c322bee7ad/bdb72/14.webp 1300w,
/static/72f3e3de08f51744182c65c322bee7ad/3ac9e/14.webp 1368w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/72f3e3de08f51744182c65c322bee7ad/5e043/14.png 163w,
/static/72f3e3de08f51744182c65c322bee7ad/e5cc6/14.png 325w,
/static/72f3e3de08f51744182c65c322bee7ad/663f3/14.png 650w,
/static/72f3e3de08f51744182c65c322bee7ad/d880f/14.png 975w,
/static/72f3e3de08f51744182c65c322bee7ad/4c573/14.png 1300w,
/static/72f3e3de08f51744182c65c322bee7ad/cc0ea/14.png 1368w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/72f3e3de08f51744182c65c322bee7ad/663f3/14.png"
            alt="14"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<h4 id="http-요청-응답-기록" style="position:relative;"><a href="#http-%EC%9A%94%EC%B2%AD-%EC%9D%91%EB%8B%B5-%EA%B8%B0%EB%A1%9D" aria-label="http 요청 응답 기록 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HTTP 요청 응답 기록</h4>
<p>HTTP 요청과 응답의 과거 기록을 확인하고 싶다면 httpexchanges 엔드포인트를 사용하면 된다</p>
<p>스프링 부트는 기본으로 InMemoryHttpExchangeRepository 구현체를 제공한다</p>
<p>참고로 이 기능은 매우 단순하고 기능에 제한이 많기 때문에 개발 단계에서만 사용하고, 실제 운영 서비스에서는 모니터링 툴이나 <strong>핀포인트</strong>, Zipkin 같은 다른 기술을 사용하는 것이 좋다.</p>
<h4 id="액츄에이터와-보안" style="position:relative;"><a href="#%EC%95%A1%EC%B8%84%EC%97%90%EC%9D%B4%ED%84%B0%EC%99%80-%EB%B3%B4%EC%95%88" aria-label="액츄에이터와 보안 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>액츄에이터와 보안</h4>
<p>액츄에이터의 엔드포인트들은 외부 인터넷에서 접근이 불가능하게 막고, 내부에서만 접근 가능한 내부망을 사용하는 것이 안전하다.</p>
<p>액츄에이터 포트 설정
<code>management.server.port=9292</code></p>
<p>액츄에이터 URL 경로에 인증 설정</p>
<p>포트를 분리하는 것이 어렵고 어쩔 수 없이 외부 인터넷 망을 통해서 접근해야 한다면 /actuator 경로에 서블릿 필터, 또는 스프링 시큐티리를 통해서 인증된 사용자만 접근 가능하도록 추가 개발이 필요하다.</p>
<p>제일 좋은 방법은 내부망에서만 사용 가능하게 설정하는 것이다.</p>
<h4 id="정리-3" style="position:relative;"><a href="#%EC%A0%95%EB%A6%AC-3" aria-label="정리 3 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정리</h4>
<h1 id="마이크로미터-프로메테우스-그라파나" style="position:relative;"><a href="#%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EB%AF%B8%ED%84%B0-%ED%94%84%EB%A1%9C%EB%A9%94%ED%85%8C%EC%9A%B0%EC%8A%A4-%EA%B7%B8%EB%9D%BC%ED%8C%8C%EB%82%98" aria-label="마이크로미터 프로메테우스 그라파나 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>마이크로미터, 프로메테우스, 그라파나</h1>
<h4 id="마이크로미터" style="position:relative;"><a href="#%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EB%AF%B8%ED%84%B0" aria-label="마이크로미터 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>마이크로미터</h4>
<p>모니터링 툴이 작동하려면 시스템의 다양한 지표들을 각각의 모니터링 툴에 맞도록 만들어서 보내주어야 한다</p>
<p>모니터링 툴을 변경하면 기존 측정에 사용한 코드를 전부 변경해야 하는데 이러한 문제를 해결하는 것이 <strong>마이크로미터</strong> 라이브러리다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/879d2c9dd8288f922c543419aa78a7bb/622c8/15.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.46625766871166%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABhElEQVR42n1Ty07DMBDMz3KGIx/BjQsnvoFLD5wRaoWQWhUVCOXQtHFeTuK0aZp3B42LKyQKK43Wm9jj2YetyXiC0XCExcJBlmVI0xRKKe3ruoa2/R7o++/lHn8Z/1lVVWG324GeBE3TwPd9CCEQRZHeZEjMmvsInjFg3Pc9rFO3kigMQ8RxfCCqK3RvM6CuUVYVpJRYr9fI8xybzUb7JEl0ZpYhWa1WsG0bcZLAFwLOYgHhukiLAsHTEO75GTZK4WP+CZMVzzATehoFHBVSclmWaJsGQZJCyBieECirGvPXGV6mU6RKafVUR0J6A8ZHwh9V1c5/fIC4H8ALQkRSwrHfIQd3yIIAbd9ju91qEpMuwbhtW1hkZf4aUQQ3W8O9vsLy9gZhnqMDkIyfsby80CWQMkamlCYlSGouYCksdsag6zpNHIWBrmUSxyiKAivHgfA83QzHcTQJx4ox16ZJv1P+x8wksJNUwilgQ0hEz+8UY506eBqHwWbz2BgqI/gYjGKSfwH7YvuovQjDCgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/879d2c9dd8288f922c543419aa78a7bb/a81b5/15.webp 163w,
/static/879d2c9dd8288f922c543419aa78a7bb/da3ef/15.webp 325w,
/static/879d2c9dd8288f922c543419aa78a7bb/309d5/15.webp 650w,
/static/879d2c9dd8288f922c543419aa78a7bb/78344/15.webp 975w,
/static/879d2c9dd8288f922c543419aa78a7bb/bdb72/15.webp 1300w,
/static/879d2c9dd8288f922c543419aa78a7bb/617b0/15.webp 1384w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/879d2c9dd8288f922c543419aa78a7bb/5e043/15.png 163w,
/static/879d2c9dd8288f922c543419aa78a7bb/e5cc6/15.png 325w,
/static/879d2c9dd8288f922c543419aa78a7bb/663f3/15.png 650w,
/static/879d2c9dd8288f922c543419aa78a7bb/d880f/15.png 975w,
/static/879d2c9dd8288f922c543419aa78a7bb/4c573/15.png 1300w,
/static/879d2c9dd8288f922c543419aa78a7bb/622c8/15.png 1384w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/879d2c9dd8288f922c543419aa78a7bb/663f3/15.png"
            alt="15"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1975ac02ad89350eab1fad872fad7dea/e7c3c/16.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 93.86503067484662%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACJUlEQVR42oWU144CMQxF8/8fxQsgmgBRJXrvZWhDH7w6lowGFnYjWZmxHfva14m7XC6y3W6FPbwej4dK+PtdPi03m82kWCzKcDjUwOfzWeXbgf+WOxwOMplM5Hg8aqDNZqOBPc+T9Xotp9NJfN+X0Wgk/X5fer2efqM39C8BV6uVlEoldSLQbrfTHf1yuZRutyuRSET3RCIh0WhUOp2O2j4G3O/3Wi5IQcI/yObzuSwWC0WKvV6vSz6fV2m32+r3MSCHCoXCs4eUTPlBEKjYIjDEYcPvzx6CBnTfFj4EsgW66/X6gtB2921UbN1uNw0YXvf7/ZfuifBdQf/G47Eyj9AvCJtOpxocsqgItgeDgdogiPEjkQujomwMrFwuJ7FYTFmlRPoH0xzmHxusp1Ip1Vvr3HspoIOAarUq5XJZKpWKoiMRhLG3Wi3JZrPqwzekghRA7uD7z2FGcQ8CHXDKQ2g+hBgJJAUtOzrEfLWHoKEXZIrH49ozC/ROUPj/m81tPO9Zps0hSPkmEf3BHh4T0OFHz7Axw5AJckUIYzSb+4lQMlewVqtJJpPRnYMcwp9A9AwdFTWbTWUfspwh4cZwvWA3nU6rIwdIBAKI4ZtkLHYQIaAHCOgd0HlF7DEwRhEy2+uCH4fs6jGjnCMpdkCRxAG/0WhoGSg4RFYCgDaZTCpiAqOjbAKC2pIRmBeIWXQctp7ghNGIAA0BQG5vJEEpMTw2JpT8AwTyqZMJc5dZAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/1975ac02ad89350eab1fad872fad7dea/a81b5/16.webp 163w,
/static/1975ac02ad89350eab1fad872fad7dea/da3ef/16.webp 325w,
/static/1975ac02ad89350eab1fad872fad7dea/309d5/16.webp 650w,
/static/1975ac02ad89350eab1fad872fad7dea/78344/16.webp 975w,
/static/1975ac02ad89350eab1fad872fad7dea/bdb72/16.webp 1300w,
/static/1975ac02ad89350eab1fad872fad7dea/9039b/16.webp 1448w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/1975ac02ad89350eab1fad872fad7dea/5e043/16.png 163w,
/static/1975ac02ad89350eab1fad872fad7dea/e5cc6/16.png 325w,
/static/1975ac02ad89350eab1fad872fad7dea/663f3/16.png 650w,
/static/1975ac02ad89350eab1fad872fad7dea/d880f/16.png 975w,
/static/1975ac02ad89350eab1fad872fad7dea/4c573/16.png 1300w,
/static/1975ac02ad89350eab1fad872fad7dea/e7c3c/16.png 1448w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/1975ac02ad89350eab1fad872fad7dea/663f3/16.png"
            alt="16"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<ul>
<li>마이크로미터는 애플리케이션 메트릭 파사드라고 불리는데, 애플리케이션의 메트릭(측정 지표)을 마이크로미터가 정한 표준 방법으로 모아서 제공</li>
<li>마이크로미터가 추상화를 통해서 구현체를 쉽게 갈아끼울 수 있도록 해두었다.</li>
<li>스프링 부트 액츄에이터는 마이크로미터를 기본으로 내장해서 사용</li>
<li>개발자는 마이크로미터가 정한 표준 방법으로 메트릭(측정 지표)를 전달하면 된다. 그리고 사용하는 모니터링 툴에 맞는 구현체를 선택하면 된다. 이후에 모니터링 툴이 변경되어도 해당 구현체만 변경하면 된다. 애플리케이션 코드는 모니터링 툴이 변경되어도 그대로 유지할 수 있다.</li>
</ul>
<h4 id="메트릭-확인하기" style="position:relative;"><a href="#%EB%A9%94%ED%8A%B8%EB%A6%AD-%ED%99%95%EC%9D%B8%ED%95%98%EA%B8%B0" aria-label="메트릭 확인하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>메트릭 확인하기</h4>
<p>스프링 부트 액츄에이터는 마이크로미터가 제공하는 지표 수집을 @AutoConfiguration 을 통해 자동으로 등록</p>
<p><a href="http://localhost:8080/actuator/metrics" target="_blank" rel="nofollow noopener noreferrer">http://localhost:8080/actuator/metrics</a><br>
metrics 엔드포인트를 사용하면 기본으로 제공되는 메트릭들을 확인할 수 있다.</p>
<p><a href="http://localhost:8080/actuator/metrics/%7Bname%7D" target="_blank" rel="nofollow noopener noreferrer">http://localhost:8080/actuator/metrics/{name}</a><br>
metrics 엔드포인트는 다음과 같은 패턴을 사용해서 더 자세히 확인할 수 있다.</p>
<p>해당 Tag를 기반으로 정보를 필터링해서 확인할 수 있다.<br>
tag=KEY:VALUE 과 같은 형식을 사용해야 한다.</p>
<h4 id="다양한-메트릭" style="position:relative;"><a href="#%EB%8B%A4%EC%96%91%ED%95%9C-%EB%A9%94%ED%8A%B8%EB%A6%AD" aria-label="다양한 메트릭 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>다양한 메트릭</h4>
<ul>
<li>JVM 메트릭
<ul>
<li>jvm으로 시작한다</li>
<li>메모리 및 버퍼 풀 세부 정보</li>
<li>가비지 수집 관련 통계</li>
<li>스레드 활용</li>
<li>로드 및 언로드된 클래스 수</li>
<li>JVM 버전 정보</li>
<li>JIT 컴파일 시간</li>
</ul>
</li>
<li>시스템 메트릭
<ul>
<li>system. , process. , disk. 으로 시작한다.</li>
<li>CPU 지표</li>
<li>파일 디스크립터 메트릭</li>
<li>가동 시간 메트릭</li>
<li>사용 가능한 디스크 공간</li>
</ul>
</li>
<li>애플리케이션 시작 메트릭
<ul>
<li>시작 시간 메트릭을 제공</li>
</ul>
</li>
<li>스프링 MVC 메트릭
<ul>
<li>스프링 MVC 컨트롤러가 처리하는 모든 요청을 다룬다.</li>
<li>메트릭 이름: http.server.requests</li>
</ul>
</li>
<li>톰캣 메트릭
<ul>
<li>톰캣 메트릭은 tomcat. 으로 시작한다.</li>
<li>톰캣 메트릭을 모두 사용하려면 옵션을 켜야한다.</li>
</ul>
</li>
<li>데이터 소스 메트릭
<ul>
<li>DataSource , 커넥션 풀에 관한 메트릭을 확인할 수 있다.</li>
<li>jdbc.connections. 으로 시작한다.</li>
<li>최대 커넥션, 최소 커넥션, 활성 커넥션, 대기 커넥션 수 등을 확인할 수 있다.</li>
</ul>
</li>
<li>로그 메트릭
<ul>
<li>logback.events : logback 로그에 대한 메트릭을 확인할 수 있다.</li>
<li>trace , debug , info , warn , error 각각의 로그 레벨에 따른 로그 수를 확인할 수 있다.</li>
</ul>
</li>
<li>사용자 정의 메트릭</li>
<li>기타 메트릭
<ul>
<li>HTTP 클라이언트 메트릭( RestTemplate , WebClient )</li>
<li>캐시 메트릭</li>
<li>작업 실행과 스케줄 메트릭</li>
<li>스프링 데이터 리포지토리 메트릭</li>
<li>몽고DB 메트릭</li>
<li>레디스 메트릭</li>
</ul>
</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="3073326085311745000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`server:
  tomcat:
    mbeanregistry:
      enabled: true`, `3073326085311745000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="yml" data-index="40"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">server</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">tomcat</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">mbeanregistry</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">enabled</span><span class="mtk1">: </span><span class="mtk4">true</span></span></span></code></pre>
<p>tomcat 메트릭 사용 옵션</p>
<h4 id="프로메테우스와-그라파나" style="position:relative;"><a href="#%ED%94%84%EB%A1%9C%EB%A9%94%ED%85%8C%EC%9A%B0%EC%8A%A4%EC%99%80-%EA%B7%B8%EB%9D%BC%ED%8C%8C%EB%82%98" aria-label="프로메테우스와 그라파나 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로메테우스와 그라파나</h4>
<p>프로메테우스</p>
<ul>
<li>과거 이력까지 함께 확인</li>
<li>메트릭을 지속적으로 수집해 DB에 저장</li>
</ul>
<p>그라파나</p>
<ul>
<li>데이터를 불러서 사용자가 보기 편하게 보여주는 대시보드</li>
<li>데이터를 그래프로 보여주는 툴</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b076f638f4a18b5dcf6eb4ac73c78047/1d7f3/17.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 32.515337423312886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABE0lEQVR42pVRuU7FQAzM//8DLSWioKShTYooXRKRvN0cyn3f5yD7CXhKgcRKo90deWyPrWRZiuM4cJ4n3/85pLkeJc9zNE0Dy7IQBAHmeWbs+86CR9H3/5G//hUhBJIkwTAM6Pse0zShrmt0XfdXa+ymbVssy4Lj+HWnSCmRZRmKokBZlqiqijuOouiHW9eVBdOyopAuCvUDUZwgiWO0/YjX5ye8v73cE3qeB7JtmiZ0XYeqqrBtG4ZhQNM05hzHQRiGoOK+EPBsE2maYp4nLn5zPyFuLnesUDAlpLmRTbJOoAQUQBzZItBohJSQfgDf9zGOIyeU0uNi9FZoEZSQhASaI9mk4OtGaVFX3PkN27bxWL4AnYQXocfKojgAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/b076f638f4a18b5dcf6eb4ac73c78047/a81b5/17.webp 163w,
/static/b076f638f4a18b5dcf6eb4ac73c78047/da3ef/17.webp 325w,
/static/b076f638f4a18b5dcf6eb4ac73c78047/309d5/17.webp 650w,
/static/b076f638f4a18b5dcf6eb4ac73c78047/78344/17.webp 975w,
/static/b076f638f4a18b5dcf6eb4ac73c78047/bdb72/17.webp 1300w,
/static/b076f638f4a18b5dcf6eb4ac73c78047/37c77/17.webp 1430w"
              sizes="(max-width: 650px) 100vw, 650px"
              type="image/webp"
            />
          <source
            srcset="/static/b076f638f4a18b5dcf6eb4ac73c78047/5e043/17.png 163w,
/static/b076f638f4a18b5dcf6eb4ac73c78047/e5cc6/17.png 325w,
/static/b076f638f4a18b5dcf6eb4ac73c78047/663f3/17.png 650w,
/static/b076f638f4a18b5dcf6eb4ac73c78047/d880f/17.png 975w,
/static/b076f638f4a18b5dcf6eb4ac73c78047/4c573/17.png 1300w,
/static/b076f638f4a18b5dcf6eb4ac73c78047/1d7f3/17.png 1430w"
            sizes="(max-width: 650px) 100vw, 650px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/b076f638f4a18b5dcf6eb4ac73c78047/663f3/17.png"
            alt="17"
            title=""
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<ol>
<li>스프링 부트 액츄에이터와 마이크로미터를 사용하면 수 많은 메트릭을 자동으로 생성</li>
</ol>
<ul>
<li>마이크로미터 프로메테우스 구현체는 프로메테우스가 읽을 수 있는 포멧으로 메트릭을 생성</li>
</ul>
<ol start="2">
<li>프로메테우스는 이렇게 만들어진 메트릭을 지속해서 수집</li>
<li>프로메테우스는 수집한 메트릭을 내부 DB에 저장</li>
<li>사용자는 그라파나 대시보드 툴을 통해 그래프로 편리하게 메트릭 조회</li>
</ol>
<hr>
<h4 id="프로메테우스" style="position:relative;"><a href="#%ED%94%84%EB%A1%9C%EB%A9%94%ED%85%8C%EC%9A%B0%EC%8A%A4" aria-label="프로메테우스 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로메테우스</h4>
<p>키면 기본 경로 - <a href="http://localhost:9090/" target="_blank" rel="nofollow noopener noreferrer">http://localhost:9090/</a></p>
<p>2가지 작업이 필요하다</p>
<ol>
<li>애플리케이션 설정: 프로메테우스가 애플리케이션의 메트릭을 가져갈 수 있도록 애플리케이션에서 프로메테우스 포멧에 맞추어 메트릭 만들기</li>
<li>프로메테우스 설정: 프로메테우스가 우리 애플리케이션의 메트릭을 주기적으로 수집하도록 설정</li>
</ol>
<p>어플리케이션 설정</p>
<p>프로메테우스가 어플리케이션의 메트릭을 가져가려면 프로메테우스가 사용하는 포멧에 맞춰 메트릭을 만들어야 한다.</p>
<p><code>actuator/metrics</code>에서 보았던 포맷(JSON)은 이해하지 못한다. -> 마이크로미터가 이런부분 해결</p>
<p>각각의 메트릭들은 내부에서 마이크로미터 표준 방식으로 측정되고 있다. 따라서 어떤 구현체를 사용할지 지정만 해주면 된다.</p>
<p>build.gradle 추가</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="47370765225985620000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`implementation 'io.micrometer:micrometer-registry-prometheus' //추가`, `47370765225985620000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="groovy" data-index="41"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">implementation </span><span class="mtk8">&#39;io.micrometer:micrometer-registry-prometheus&#39;</span><span class="mtk1"> </span><span class="mtk3">//추가</span></span></span></code></pre>
<ul>
<li>스프링 부트와 액츄에이터가 자동으로 마이크로미터 프로메테우스 구현체를 등록해서 동작하도록 설정해준다.</li>
<li>액츄에이터에 프로메테우스 메트릭 수집 엔드포인트가 자동으로 추가
<ul>
<li>/actuator/prometheus</li>
</ul>
</li>
</ul>
<p>포맷 차이</p>
<ul>
<li>jvm.info jvm*info : 프로메테우스는 . 대신에 * 포멧을 사용한다. . 대신에 _ 포멧으로 변환된 것을 확인할 수 있다.</li>
<li>logback.events logback_events_total : 로그수 처럼 지속해서 숫자가 증가하는 메트릭을 카운터라 한다. 프로메테우스는 카운터 메트릭의 마지막에는 관례상 _total 을 붙인다.</li>
<li>http.server.requests
<ul>
<li>http_server_requests_seconds_count : 요청 수</li>
<li>http_server_requests_seconds_sum : 시간 합(요청수의 시간을 합함)</li>
<li>http_server_requests_seconds_max : 최대 시간(가장 오래걸린 요청 수)</li>
</ul>
</li>
</ul>
<hr>
<h4 id="프로메테우스---수집-설정" style="position:relative;"><a href="#%ED%94%84%EB%A1%9C%EB%A9%94%ED%85%8C%EC%9A%B0%EC%8A%A4---%EC%88%98%EC%A7%91-%EC%84%A4%EC%A0%95" aria-label="프로메테우스   수집 설정 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로메테우스 - 수집 설정</h4>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="8003406734478747000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`# my global config
global:
  scrape_interval: 15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.
  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.
  # scrape_timeout is set to the global default (10s).

# Alertmanager configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets:
          # - alertmanager:9093

# Load rules once and periodically evaluate them according to the global 'evaluation_interval'.
rule_files:
  # - &quot;first_rules.yml&quot;
  # - &quot;second_rules.yml&quot;

# A scrape configuration containing exactly one endpoint to scrape:
# Here it's Prometheus itself.
scrape_configs:
  # The job name is added as a label \`job=<job_name>\` to any timeseries scraped from this config.
  - job_name: &quot;prometheus&quot;

    # metrics_path defaults to '/metrics'
    # scheme defaults to 'http'.

    static_configs:
      - targets: [&quot;localhost:9090&quot;]
  - job_name: &quot;spring-actuator&quot;
    metrics_path: &quot;/actuator/prometheus&quot;
    scrape_interval: 1s
    static_configs:
   - targets: [&quot;localhost:8080&quot;]
`, `8003406734478747000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="yml" data-index="42"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3"># my global config</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">global</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">scrape_interval</span><span class="mtk1">: </span><span class="mtk8">15s</span><span class="mtk1"> </span><span class="mtk3"># Set the scrape interval to every 15 seconds. Default is every 1 minute.</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">evaluation_interval</span><span class="mtk1">: </span><span class="mtk8">15s</span><span class="mtk1"> </span><span class="mtk3"># Evaluate rules every 15 seconds. The default is every 1 minute.</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3"># scrape_timeout is set to the global default (10s).</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3"># Alertmanager configuration</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">alerting</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">alertmanagers</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    - </span><span class="mtk4">static_configs</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        - </span><span class="mtk4">targets</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk3"># - alertmanager:9093</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3"># Load rules once and periodically evaluate them according to the global &#39;evaluation_interval&#39;.</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">rule_files</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3"># - &quot;first_rules.yml&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3"># - &quot;second_rules.yml&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3"># A scrape configuration containing exactly one endpoint to scrape:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3"># Here it&#39;s Prometheus itself.</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">scrape_configs</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  - </span><span class="mtk4">job_name</span><span class="mtk1">: </span><span class="mtk8">&quot;prometheus&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3"># metrics_path defaults to &#39;/metrics&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3"># scheme defaults to &#39;http&#39;.</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">static_configs</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      - </span><span class="mtk4">targets</span><span class="mtk1">: [</span><span class="mtk8">&quot;localhost:9090&quot;</span><span class="mtk1">]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  - </span><span class="mtk4">job_name</span><span class="mtk1">: </span><span class="mtk8">&quot;spring-actuator&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">metrics_path</span><span class="mtk1">: </span><span class="mtk8">&quot;/actuator/prometheus&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">scrape_interval</span><span class="mtk1">: </span><span class="mtk8">1s</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">static_configs</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">   - </span><span class="mtk4">targets</span><span class="mtk1">: [</span><span class="mtk8">&quot;localhost:8080&quot;</span><span class="mtk1">]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span></code></pre>
<ul>
<li>job_name : 수집하는 이름이다. 임의의 이름을 사용하면 된다.</li>
<li>metrics_path : 수집할 경로를 지정한다.</li>
<li>scrape_interval : 수집할 주기를 설정한다.</li>
<li>targets : 수집할 서버의 IP, PORT를 지정한다</li>
</ul>
<p>Tip!</p>
<ul>
<li>scrape_interval 여기서는 예제를 빠르게 확인하기 위해서 수집 주기를 1s 로 했지만, 수집 주기의 기본 값은 1m 이다.</li>
<li>수집 주기가 너무 짧으면 애플리케이션 성능에 영향을 줄 수 있으므로 운영에서는 10s ~ 1m 정도를 권장한다. (물론 시스템 상황에 따라서 다르다.)</li>
</ul>
<h4 id="프로메테우스-기본-기능" style="position:relative;"><a href="#%ED%94%84%EB%A1%9C%EB%A9%94%ED%85%8C%EC%9A%B0%EC%8A%A4-%EA%B8%B0%EB%B3%B8-%EA%B8%B0%EB%8A%A5" aria-label="프로메테우스 기본 기능 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로메테우스 기본 기능</h4>
<ul>
<li>Table -> Evaluation time을 수정해서 과거 시간 조회 가능</li>
<li>Graph -> 메트릭을 그래프로 조회 가능</li>
</ul>
<p>필터</p>
<p>레이블을 기준으로 필터를 사용할 수 있다. 필터는 중괄호 ({})문법을 사용한다.</p>
<p>레이블 일치 연산자</p>
<ul>
<li>= 제공된 문자열과 정확히 동일한 레이블 선택</li>
<li>!= 제공된 문자열과 같지 않은 레이블 선택</li>
<li>=~ 제공된 문자열과 정규식 일치하는 레이블 선택</li>
<li>!~ 제공된 문자열과 정규식 일치하지 않는 레이블 선택</li>
</ul>
<p>ex</p>
<ul>
<li>http_server_requests_seconds_count{uri=“/log”, method=“GET”}</li>
<li>http_server_requests_seconds_count{uri!=“/actuator/prometheus”}</li>
<li>http_server_requests_seconds_count{method=~“GET|POST”}</li>
<li>http_server_requests_seconds_count{uri!~“/actuator.*“}</li>
</ul>
<p>연산자와 쿼리 함수</p>
<ul>
<li>+, -, *, /, %, ^(승수/지수) 지원</li>
<li>sum : 값의 합계
<ul>
<li>ex) sum(http_server_requests_seconds_count)</li>
</ul>
</li>
<li>sum by : SQL의 group by와 유사
<ul>
<li>ex) sum by(method, status)(http_server_requests_seconds_count)</li>
</ul>
</li>
<li>count : 메트릭 자체의 수 카운트
<ul>
<li>ex) count(http_server_requests_seconds_count)</li>
</ul>
</li>
<li>topk : 상위 3개 메트릭 조회
<ul>
<li>ex) topk(3, http_server_requests_seconds_count)</li>
</ul>
</li>
<li>오프셋 수정자 : 현재를 기준으로 특정 과거 시점의 데이터를 반환
<ul>
<li>ex) http_server_requests_seconds_count offset 10m</li>
</ul>
</li>
<li>범위 벡터 선택기
<ul>
<li>ex) http_server_requests_seconds_count[1m]
<ul>
<li>마지막에 [1m] , [60s] 와 같이 표현한다. 지난 1분간의 모든 기록값을 선택한다.</li>
<li>범위 벡터 선택기는 차트에 바로 표현할 수 없다. 데이터로는 확인할 수 있다.</li>
<li>범위 벡터 선택의 결과를 차트에 표현하기 위해서는 약간의 가공이 필요한데, 조금 뒤에 설명하는 상대적인 증가 확인 방법을 참고하자.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="프로메테우스---게이지와-카운터" style="position:relative;"><a href="#%ED%94%84%EB%A1%9C%EB%A9%94%ED%85%8C%EC%9A%B0%EC%8A%A4---%EA%B2%8C%EC%9D%B4%EC%A7%80%EC%99%80-%EC%B9%B4%EC%9A%B4%ED%84%B0" aria-label="프로메테우스   게이지와 카운터 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로메테우스 - 게이지와 카운터</h4>
<ul>
<li>게이지(Gauge)
<ul>
<li>임의로 오르내릴 수 있는 값</li>
<li>ex) CPU사용량, 메모리 사용량, 사용중인 커넥션</li>
</ul>
</li>
<li>카운터(Counter)
<ul>
<li>단순하게 증가하는 단일 누적 값</li>
<li>ex) HTTP 요청 수, 로그 발생 수</li>
</ul>
</li>
</ul>
<p>카운터는 단순하게 증가하는 값이기 때문에 특정 시간에 얼마나 고객의 요청이 들어왔는지 확인하기 매우 어렵다</p>
<p>이런 문제를 해결하기 위해 increase(), rate(), irate()같은 함수를 지원한다</p>
<ul>
<li>increase() : 지정한 시간 단위별로 증가를 확인할 수 있다.
<ul>
<li>ex) increase(http_server_requests_seconds_count{uri=“/log”}[1m])</li>
</ul>
</li>
<li>rate() : 범위 벡터에서 초당 평균 증가율을 계산한다.
<ul>
<li>ex) rate(data[1m])</li>
</ul>
</li>
<li>irate() : 범위 벡터에서 초당 순간 증가율을 계산한다.
<ul>
<li>ex) irate(http_server_requests_seconds_count{uri=“/log”}[1m])</li>
</ul>
</li>
</ul>
<p>Tip!!</p>
<p>더 자세한 내용은 다음 프로메테우스 공식 메뉴얼을 참고하자<br>
기본기능: <a href="https://prometheus.io/docs/prometheus/latest/querying/basics/" target="_blank" rel="nofollow noopener noreferrer">https://prometheus.io/docs/prometheus/latest/querying/basics/</a><br>
연산자: <a href="https://prometheus.io/docs/prometheus/latest/querying/operators/" target="_blank" rel="nofollow noopener noreferrer">https://prometheus.io/docs/prometheus/latest/querying/operators/</a><br>
함수: <a href="https://prometheus.io/docs/prometheus/latest/querying/functions/" target="_blank" rel="nofollow noopener noreferrer">https://prometheus.io/docs/prometheus/latest/querying/functions/</a></p>
<h4 id="그라파나" style="position:relative;"><a href="#%EA%B7%B8%EB%9D%BC%ED%8C%8C%EB%82%98" aria-label="그라파나 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>그라파나</h4>
<p>그라파나에서 프로메테우스를 데이터소스로 사용해서 데이터를 읽어야 한다.</p>
<ol>
<li>대시보드 생성</li>
</ol>
<ul>
<li>왼쪽 Dashboard 메뉴 선택</li>
<li>new 버튼 -> New Dashboard선택</li>
<li>save dashboard</li>
<li>이름 지정 후 저장</li>
</ul>
<ol start="2">
<li>대시보드에 패널 만들기</li>
</ol>
<ul>
<li>대시보드가 큰 틀이라면 패널은 그 안에 모듈처럼 들어가는 실제 그래프를 보여주는 컴포넌트
<ul>
<li>오른쪽 상단의 Add panel 버튼(차트 모양) 선택</li>
<li>Add a new panel 메뉴 선택</li>
<li>패널의 정보를 입력할 수 있는 화면이 나타난다.</li>
<li>아래에 보면 Run queries 버튼 오른쪽에 Builder , Code 라는 버튼이 보이는데, Code 를 선택</li>
<li>Enter a PromQL query… 이라는 부분에 메트릭을 입력하면 된다</li>
</ul>
</li>
</ul>
<h4 id="공유-대시보드-활용" style="position:relative;"><a href="#%EA%B3%B5%EC%9C%A0-%EB%8C%80%EC%8B%9C%EB%B3%B4%EB%93%9C-%ED%99%9C%EC%9A%A9" aria-label="공유 대시보드 활용 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>공유 대시보드 활용</h4>
<p><a href="https://grafana.com/grafana/dashboards/" target="_blank" rel="nofollow noopener noreferrer">https://grafana.com/grafana/dashboards/</a> -> 접속</p>
<p>JVM (Micrometer), springBoot 2.1 System Monitor 이 두가지가 많이 사용된다.</p>
<h4 id="그라파나---메트릭을-통한-문제-확인" style="position:relative;"><a href="#%EA%B7%B8%EB%9D%BC%ED%8C%8C%EB%82%98---%EB%A9%94%ED%8A%B8%EB%A6%AD%EC%9D%84-%ED%86%B5%ED%95%9C-%EB%AC%B8%EC%A0%9C-%ED%99%95%EC%9D%B8" aria-label="그라파나   메트릭을 통한 문제 확인 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>그라파나 - 메트릭을 통한 문제 확인</h4>
<p>실무에서 주로 많이 발생하는 다음 4가지 대표적인 예시를 확인해보자.</p>
<ul>
<li>CPU 사용량 초과</li>
<li>JVM 메모리 사용량 초과</li>
<li>커넥션 풀 고갈</li>
<li>에러 로그 급증</li>
</ul>
<h4 id="정리-4" style="position:relative;"><a href="#%EC%A0%95%EB%A6%AC-4" aria-label="정리 4 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정리</h4>
<p>메트릭을 보는 것은 정확한 값을 보는 것이 목적이 아니다. 대략적인 값과 추세를 확인하는 것이 주 목적이다.</p>
<h1 id="모니터링-메트릭-활용" style="position:relative;"><a href="#%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81-%EB%A9%94%ED%8A%B8%EB%A6%AD-%ED%99%9C%EC%9A%A9" aria-label="모니터링 메트릭 활용 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모니터링 메트릭 활용</h1>
<ul>
<li>비즈니스에 특화된 부분을 모니터링 하고 싶을 때 메트릭을 만들어 등록</li>
</ul>
<h4 id="메트릭-등록1---카운터" style="position:relative;"><a href="#%EB%A9%94%ED%8A%B8%EB%A6%AD-%EB%93%B1%EB%A1%9D1---%EC%B9%B4%EC%9A%B4%ED%84%B0" aria-label="메트릭 등록1   카운터 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>메트릭 등록1 - 카운터</h4>
<p>마이크로미터를 사용해 메트릭을 직접 등록이 가능</p>
<p>MeterRegistry</p>
<ul>
<li>마이크로미터 기능을 제공하는 핵심 컴포넌트</li>
<li>스프링을 통해서 주입 받아 사용하고, 이곳을 통해서 카운터, 게이지 등을 등록한다.</li>
</ul>
<p>Counter(카운터)</p>
<ul>
<li>단조롭게 증가하는 단일 누적 측정항목
<ul>
<li>단일 값</li>
<li>보통 하나씩 증가</li>
<li>누적이므로 전체 값을 포함</li>
<li>관례상 마지막에 <code>_total</code> 붙인다</li>
</ul>
</li>
<li>값은 증가하거나 0으로 초기화하는 것만 가능</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="41223395089383416000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`package hello.order.v1;

import hello.order.OrderService;
import io.micrometer.core.instrument.Counter;
import io.micrometer.core.instrument.MeterRegistry;
import lombok.extern.slf4j.Slf4j;

import java.util.concurrent.atomic.AtomicInteger;

@Slf4j
public class OrderServiceV1 implements OrderService {
    private final MeterRegistry registry;
    private AtomicInteger stock = new AtomicInteger(100);
    public OrderServiceV1(MeterRegistry registry) {
        this.registry = registry;
    }

    @Override
    public void order() {
        log.info(&quot;주문&quot;);
        stock.decrementAndGet();
        Counter.builder(&quot;my.order&quot;)
                .tag(&quot;class&quot;, this.getClass().getName())
                .tag(&quot;method&quot;, &quot;order&quot;)
                .description(&quot;order&quot;)
                .register(registry).increment();
    }

    @Override
    public void cancel() {
        log.info(&quot;취소&quot;);
        stock.incrementAndGet();
        Counter.builder(&quot;my.order&quot;)
                .tag(&quot;class&quot;, this.getClass().getName())
                .tag(&quot;method&quot;, &quot;cancel&quot;)
                .description(&quot;order&quot;)
                .register(registry).increment();
    }

    @Override
    public AtomicInteger getStock() {
        return stock;
    }
}
`, `41223395089383416000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="43"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">package</span><span class="mtk1"> hello.order.v1;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> hello.order.OrderService;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> io.micrometer.core.instrument.Counter;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> io.micrometer.core.instrument.MeterRegistry;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> lombok.extern.slf4j.Slf4j;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> java.util.concurrent.atomic.AtomicInteger;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">OrderServiceV1</span><span class="mtk1"> </span><span class="mtk4">implements</span><span class="mtk1"> </span><span class="mtk10">OrderService</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk4">final</span><span class="mtk1"> </span><span class="mtk10">MeterRegistry</span><span class="mtk1"> </span><span class="mtk12">registry</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">AtomicInteger</span><span class="mtk1"> </span><span class="mtk12">stock</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">AtomicInteger</span><span class="mtk1">(</span><span class="mtk7">100</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk11">OrderServiceV1</span><span class="mtk1">(</span><span class="mtk10">MeterRegistry</span><span class="mtk1"> </span><span class="mtk12">registry</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk12">registry</span><span class="mtk1"> = registry;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="19"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">order</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="20"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;주문&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="21"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">stock</span><span class="mtk1">.</span><span class="mtk11">decrementAndGet</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="22"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">Counter</span><span class="mtk1">.</span><span class="mtk11">builder</span><span class="mtk1">(</span><span class="mtk8">&quot;my.order&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="23"></span><span class="grvsc-source"><span class="mtk1">                .</span><span class="mtk11">tag</span><span class="mtk1">(</span><span class="mtk8">&quot;class&quot;</span><span class="mtk1">, </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk11">getClass</span><span class="mtk1">().</span><span class="mtk11">getName</span><span class="mtk1">())</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="24"></span><span class="grvsc-source"><span class="mtk1">                .</span><span class="mtk11">tag</span><span class="mtk1">(</span><span class="mtk8">&quot;method&quot;</span><span class="mtk1">, </span><span class="mtk8">&quot;order&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="25"></span><span class="grvsc-source"><span class="mtk1">                .</span><span class="mtk11">description</span><span class="mtk1">(</span><span class="mtk8">&quot;order&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="26"></span><span class="grvsc-source"><span class="mtk1">                .</span><span class="mtk11">register</span><span class="mtk1">(registry).</span><span class="mtk11">increment</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="27"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="28"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="29"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="30"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">cancel</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="31"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;취소&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="32"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">stock</span><span class="mtk1">.</span><span class="mtk11">incrementAndGet</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="33"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">Counter</span><span class="mtk1">.</span><span class="mtk11">builder</span><span class="mtk1">(</span><span class="mtk8">&quot;my.order&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="34"></span><span class="grvsc-source"><span class="mtk1">                .</span><span class="mtk11">tag</span><span class="mtk1">(</span><span class="mtk8">&quot;class&quot;</span><span class="mtk1">, </span><span class="mtk4">this</span><span class="mtk1">.</span><span class="mtk11">getClass</span><span class="mtk1">().</span><span class="mtk11">getName</span><span class="mtk1">())</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="35"></span><span class="grvsc-source"><span class="mtk1">                .</span><span class="mtk11">tag</span><span class="mtk1">(</span><span class="mtk8">&quot;method&quot;</span><span class="mtk1">, </span><span class="mtk8">&quot;cancel&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="36"></span><span class="grvsc-source"><span class="mtk1">                .</span><span class="mtk11">description</span><span class="mtk1">(</span><span class="mtk8">&quot;order&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="37"></span><span class="grvsc-source"><span class="mtk1">                .</span><span class="mtk11">register</span><span class="mtk1">(registry).</span><span class="mtk11">increment</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="38"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="39"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="40"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="41"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">AtomicInteger</span><span class="mtk1"> </span><span class="mtk11">getStock</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="42"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> stock;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="43"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="44"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="45"></span><span class="grvsc-source"></span></span></code></pre>
<ul>
<li>Counter.builder(name) 를 통해서 카운터를 생성한다. name 에는 메트릭 이름을 지정한다.</li>
<li>tag 를 사용했는데, 프로메테우스에서 필터할 수 있는 레이블로 사용된다.</li>
<li>주문과 취소는 메트릭 이름은 같고 tag 를 통해서 구분하도록 했다.</li>
<li>register(registry) : 만든 카운터를 MeterRegistry 에 등록한다. 이렇게 등록해야 실제 동작한다.</li>
<li>increment() : 카운터의 값을 하나 증가한다.</li>
</ul>
<p>액츄에이터 메트릭 확인
<a href="http://localhost:8080/actuator/metrics/my.order" target="_blank" rel="nofollow noopener noreferrer">http://localhost:8080/actuator/metrics/my.order</a></p>
<p>프로메테우스 포멧 메트릭 확인
<a href="http://localhost:8080/actuator/prometheus" target="_blank" rel="nofollow noopener noreferrer">http://localhost:8080/actuator/prometheus</a></p>
<p>참고: 카운터는 계속 증가하기 때문에 특정 시간에 얼마나 증가했는지 확인하려면 increase() , rate() 같은 함수와 함께 사용하는 것이 좋다.</p>
<h4 id="메트릭-등록---counted" style="position:relative;"><a href="#%EB%A9%94%ED%8A%B8%EB%A6%AD-%EB%93%B1%EB%A1%9D---counted" aria-label="메트릭 등록   counted permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>메트릭 등록 - @Counted</h4>
<p>OrderServiceV1 의 가장 큰 단점은 메트릭을 관리하는 로직이 핵심 비즈니스 개발 로직에 침투했다는 점이다.</p>
<p>스프링 AOP를 사용하면 해결된다.</p>
<p>마이크로미터는 이런 상황에 맞추어 AOP구성요소를 이미 다 만들어두었다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="92575473386985930000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`package hello.order.v2;

import hello.order.OrderService;
import io.micrometer.core.annotation.Counted;
import lombok.extern.slf4j.Slf4j;

import java.util.concurrent.atomic.AtomicInteger;

@Slf4j
public class OrderServiceV2 implements OrderService {
    private AtomicInteger stock = new AtomicInteger(100);
    @Counted(&quot;my.order&quot;)
    @Override
    public void order() {
        log.info(&quot;주문&quot;);
        stock.decrementAndGet();
    }
    @Counted(&quot;my.order&quot;)
    @Override
    public void cancel() {
        log.info(&quot;취소&quot;);
        stock.incrementAndGet();
    }
    @Override
    public AtomicInteger getStock() {
        return stock;
    }
}`, `92575473386985930000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="44"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">package</span><span class="mtk1"> hello.order.v2;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> hello.order.OrderService;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> io.micrometer.core.annotation.Counted;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> lombok.extern.slf4j.Slf4j;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> java.util.concurrent.atomic.AtomicInteger;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">OrderServiceV2</span><span class="mtk1"> </span><span class="mtk4">implements</span><span class="mtk1"> </span><span class="mtk10">OrderService</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">AtomicInteger</span><span class="mtk1"> </span><span class="mtk12">stock</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">AtomicInteger</span><span class="mtk1">(</span><span class="mtk7">100</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Counted</span><span class="mtk1">(</span><span class="mtk8">&quot;my.order&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">order</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;주문&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">stock</span><span class="mtk1">.</span><span class="mtk11">decrementAndGet</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Counted</span><span class="mtk1">(</span><span class="mtk8">&quot;my.order&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="19"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="20"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">cancel</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="21"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;취소&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="22"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">stock</span><span class="mtk1">.</span><span class="mtk11">incrementAndGet</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="23"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="24"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="25"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">AtomicInteger</span><span class="mtk1"> </span><span class="mtk11">getStock</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="26"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> stock;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="27"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="28"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>@Counted 애노테이션을 측정을 원하는 메서드에 적용한다. 주문과 취소 메서드에 적용했다.</li>
<li>그리고 메트릭 이름을 지정하면 된다. 여기서는 이전과 같은 my.order 를 적용했다.</li>
<li>참고로 이렇게 사용하면 tag 에 method 를 기준으로 분류해서 적용한다.</li>
</ul>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="41294704971516035000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Configuration
public class OrderConfigV2 {
    @Bean
    public OrderService orderService() {
        return new OrderServiceV2();
    }
    @Bean
    public CountedAspect countedAspect(MeterRegistry registry) {
        return new CountedAspect(registry);
    }
}`, `41294704971516035000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="45"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Configuration</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">OrderConfigV2</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">OrderService</span><span class="mtk1"> </span><span class="mtk11">orderService</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">OrderServiceV2</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">CountedAspect</span><span class="mtk1"> </span><span class="mtk11">countedAspect</span><span class="mtk1">(</span><span class="mtk10">MeterRegistry</span><span class="mtk1"> </span><span class="mtk12">registry</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">CountedAspect</span><span class="mtk1">(registry);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>CountedAspect 를 등록하면 @Counted 를 인지해서 Counter 를 사용하는 AOP를 적용한다.</li>
<li>주의! CountedAspect를 빈으로 등록하지 않으면 @Counted 관련 AOP가 동작하지 않는다.</li>
</ul>
<h4 id="메트릭-등록3---timer" style="position:relative;"><a href="#%EB%A9%94%ED%8A%B8%EB%A6%AD-%EB%93%B1%EB%A1%9D3---timer" aria-label="메트릭 등록3   timer permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>메트릭 등록3 - Timer</h4>
<p>Timer</p>
<ul>
<li>Timer는 좀 특별한 메트릭 측정 도구인데, 시간을 측정하는데 사용된다.
<ul>
<li>카운터와 유사한데, Timer 를 사용하면 실행 시간도 함께 측정할 수 있다.</li>
<li>Timer 는 다음과 같은 내용을 한번에 측정해준다.
<ul>
<li>seconds_count : 누적 실행 수 - 카운터</li>
<li>seconds_sum : 실행 시간의 합 - sum</li>
<li>seconds_max : 최대 실행 시간(가장 오래걸린 실행 시간) - 게이지
<ul>
<li>내부에 타임 윈도우라는 개념이 있어서 1~3분 마다 최대 실행 시간이 다시 계산된다.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>코드 적용 후 액츄에이터 메트릭 확인</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="98937493192949470000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`{
  'name': 'my.order',
  'description': 'order',
  'baseUnit': 'seconds',
  'measurements':
    [
      { 'statistic': 'COUNT', 'value': 5 },
      { 'statistic': 'TOTAL_TIME', 'value': 1.929075042 },
      { 'statistic': 'MAX', 'value': 0.509926375 },
    ],
  'availableTags':
    [
      { 'tag': 'method', 'values': ['cancel', 'order'] },
      { 'tag': 'class', 'values': ['hello.order.v3.OrderServiceV3'] },
    ],
}`, `98937493192949470000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="yml" data-index="46"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">{</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">&#39;name&#39;</span><span class="mtk1">: </span><span class="mtk8">&#39;my.order&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">&#39;description&#39;</span><span class="mtk1">: </span><span class="mtk8">&#39;order&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">&#39;baseUnit&#39;</span><span class="mtk1">: </span><span class="mtk8">&#39;seconds&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">&#39;measurements&#39;</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">    [</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">      { </span><span class="mtk8">&#39;statistic&#39;</span><span class="mtk1">: </span><span class="mtk8">&#39;COUNT&#39;</span><span class="mtk1">, </span><span class="mtk8">&#39;value&#39;</span><span class="mtk1">: </span><span class="mtk7">5</span><span class="mtk1"> },</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">      { </span><span class="mtk8">&#39;statistic&#39;</span><span class="mtk1">: </span><span class="mtk8">&#39;TOTAL_TIME&#39;</span><span class="mtk1">, </span><span class="mtk8">&#39;value&#39;</span><span class="mtk1">: </span><span class="mtk7">1.929075042</span><span class="mtk1"> },</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">      { </span><span class="mtk8">&#39;statistic&#39;</span><span class="mtk1">: </span><span class="mtk8">&#39;MAX&#39;</span><span class="mtk1">, </span><span class="mtk8">&#39;value&#39;</span><span class="mtk1">: </span><span class="mtk7">0.509926375</span><span class="mtk1"> },</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">    ],</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">&#39;availableTags&#39;</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">    [</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">      { </span><span class="mtk8">&#39;tag&#39;</span><span class="mtk1">: </span><span class="mtk8">&#39;method&#39;</span><span class="mtk1">, </span><span class="mtk8">&#39;values&#39;</span><span class="mtk1">: [</span><span class="mtk8">&#39;cancel&#39;</span><span class="mtk1">, </span><span class="mtk8">&#39;order&#39;</span><span class="mtk1">] },</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">      { </span><span class="mtk8">&#39;tag&#39;</span><span class="mtk1">: </span><span class="mtk8">&#39;class&#39;</span><span class="mtk1">, </span><span class="mtk8">&#39;values&#39;</span><span class="mtk1">: [</span><span class="mtk8">&#39;hello.order.v3.OrderServiceV3&#39;</span><span class="mtk1">] },</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">    ],</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<ul>
<li>measurements 항목을 보면 COUNT , TOTAL_TIME , MAX 이렇게 총 3가지 측정 항목을 확인할 수 있다.
<ul>
<li>COUNT : 누적 실행 수(카운터와 같다)</li>
<li>TOTAL_TIME : 실행 시간의 합(각각의 실행 시간의 누적 합이다)</li>
<li>MAX : 최대 실행 시간(가장 오래 걸린 실행시간이다)</li>
</ul>
</li>
</ul>
<p>프로메테우스 포멧 메트릭 확인</p>
<pre class="grvsc-container default-dark" data-language="" data-index="47"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"># HELP my_order_seconds order</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># TYPE my_order_seconds summary</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">my_order_seconds_count{class=&quot;hello.order.v3.OrderServiceV3&quot;,method=&quot;order&quot;,}</span></span>
<span class="grvsc-line"><span class="grvsc-source">3.0</span></span>
<span class="grvsc-line"><span class="grvsc-source">my_order_seconds_sum{class=&quot;hello.order.v3.OrderServiceV3&quot;,method=&quot;order&quot;,}</span></span>
<span class="grvsc-line"><span class="grvsc-source">1.518434959</span></span>
<span class="grvsc-line"><span class="grvsc-source">my_order_seconds_count{class=&quot;hello.order.v3.OrderServiceV3&quot;,method=&quot;cancel&quot;,}</span></span>
<span class="grvsc-line"><span class="grvsc-source">2.0</span></span>
<span class="grvsc-line"><span class="grvsc-source">my_order_seconds_sum{class=&quot;hello.order.v3.OrderServiceV3&quot;,method=&quot;cancel&quot;,}</span></span>
<span class="grvsc-line"><span class="grvsc-source">0.410640083</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># HELP my_order_seconds_max order</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># TYPE my_order_seconds_max gauge</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">my_order_seconds_max{class=&quot;hello.order.v3.OrderServiceV3&quot;,method=&quot;order&quot;,}</span></span>
<span class="grvsc-line"><span class="grvsc-source">0.509926375</span></span>
<span class="grvsc-line"><span class="grvsc-source">my_order_seconds_max{class=&quot;hello.order.v3.OrderServiceV3&quot;,method=&quot;cancel&quot;,}</span></span>
<span class="grvsc-line"><span class="grvsc-source">0.20532925</span></span></code></pre>
<ul>
<li>프로메테우스로 다음 접두사가 붙으면서 3가지 메트릭을 제공한다.
<ul>
<li>seconds_count : 누적 실행 수</li>
<li>seconds_sum : 실행 시간의 합</li>
<li>seconds_max : 최대 실행 시간(가장 오래걸린 실행 시간), 프로메테우스 gague
<ul>
<li>참고: 내부에 타임 윈도우라는 개념이 있어서 1~3분 마다 최대 실행 시간이 다시 계산된다.</li>
</ul>
</li>
</ul>
</li>
<li>여기서 평균 실행 시간도 계산할 수 있다.</li>
<li>seconds_sum / seconds_count = 평균 실행시간</li>
</ul>
<h4 id="메트릭-등록4---timed" style="position:relative;"><a href="#%EB%A9%94%ED%8A%B8%EB%A6%AD-%EB%93%B1%EB%A1%9D4---timed" aria-label="메트릭 등록4   timed permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>메트릭 등록4 - @Timed</h4>
<p>타이머는 @Timed 라는 애노테이션을 통해 AOP를 적용할 수 있다.</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="27577469609997808000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`package hello.order.v4;

import hello.order.OrderService;
import io.micrometer.core.annotation.Timed;
import lombok.extern.slf4j.Slf4j;

import java.util.Random;
import java.util.concurrent.atomic.AtomicInteger;

@Timed(&quot;my.order&quot;)
@Slf4j
public class OrderServiceV4 implements OrderService {
    private AtomicInteger stock = new AtomicInteger(100);
    @Override
    public void order() {
        log.info(&quot;주문&quot;);
        stock.decrementAndGet();
        sleep(500);
    }
    @Override
    public void cancel() {
        log.info(&quot;취소&quot;);
        stock.incrementAndGet();
        sleep(200);
    }
    private static void sleep(int l) {
        try {
            Thread.sleep(l + new Random().nextInt(200));
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }
    }
    @Override
    public AtomicInteger getStock() {
        return stock;
    }
}`, `27577469609997808000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="48"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">package</span><span class="mtk1"> hello.order.v4;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> hello.order.OrderService;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> io.micrometer.core.annotation.Timed;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> lombok.extern.slf4j.Slf4j;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> java.util.Random;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> java.util.concurrent.atomic.AtomicInteger;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Timed</span><span class="mtk1">(</span><span class="mtk8">&quot;my.order&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">OrderServiceV4</span><span class="mtk1"> </span><span class="mtk4">implements</span><span class="mtk1"> </span><span class="mtk10">OrderService</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk10">AtomicInteger</span><span class="mtk1"> </span><span class="mtk12">stock</span><span class="mtk1"> = </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">AtomicInteger</span><span class="mtk1">(</span><span class="mtk7">100</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">order</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;주문&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">stock</span><span class="mtk1">.</span><span class="mtk11">decrementAndGet</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk11">sleep</span><span class="mtk1">(</span><span class="mtk7">500</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="19"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="20"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="21"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">cancel</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="22"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;취소&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="23"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk12">stock</span><span class="mtk1">.</span><span class="mtk11">incrementAndGet</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="24"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk11">sleep</span><span class="mtk1">(</span><span class="mtk7">200</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="25"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="26"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">private</span><span class="mtk1"> </span><span class="mtk4">static</span><span class="mtk1"> </span><span class="mtk10">void</span><span class="mtk1"> </span><span class="mtk11">sleep</span><span class="mtk1">(</span><span class="mtk10">int</span><span class="mtk1"> </span><span class="mtk12">l</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="27"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">try</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="28"></span><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">Thread</span><span class="mtk1">.</span><span class="mtk11">sleep</span><span class="mtk1">(l + </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">Random</span><span class="mtk1">().</span><span class="mtk11">nextInt</span><span class="mtk1">(</span><span class="mtk7">200</span><span class="mtk1">));</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="29"></span><span class="grvsc-source"><span class="mtk1">        } </span><span class="mtk15">catch</span><span class="mtk1"> (</span><span class="mtk10">InterruptedException</span><span class="mtk1"> </span><span class="mtk12">e</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="30"></span><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk15">throw</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">RuntimeException</span><span class="mtk1">(e);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="31"></span><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="32"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="33"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="34"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">AtomicInteger</span><span class="mtk1"> </span><span class="mtk11">getStock</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="35"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> stock;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="36"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="37"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="17063076069586835000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`package hello.order.v4;

import hello.order.OrderService;
import io.micrometer.core.aop.TimedAspect;
import io.micrometer.core.instrument.MeterRegistry;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class OrderConfigV4 {
    @Bean
    OrderService orderService() {
        return new OrderServiceV4();
    }
    @Bean
    public TimedAspect timedAspect(MeterRegistry registry) {
        return new TimedAspect(registry);
    }
}`, `17063076069586835000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="49"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk4">package</span><span class="mtk1"> hello.order.v4;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> hello.order.OrderService;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> io.micrometer.core.aop.TimedAspect;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> io.micrometer.core.instrument.MeterRegistry;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.springframework.context.annotation.Bean;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk4">import</span><span class="mtk1"> org.springframework.context.annotation.Configuration;</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Configuration</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">OrderConfigV4</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="12"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk10">OrderService</span><span class="mtk1"> </span><span class="mtk11">orderService</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="13"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">OrderServiceV4</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="14"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="15"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="16"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">TimedAspect</span><span class="mtk1"> </span><span class="mtk11">timedAspect</span><span class="mtk1">(</span><span class="mtk10">MeterRegistry</span><span class="mtk1"> </span><span class="mtk12">registry</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="17"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk15">new</span><span class="mtk1"> </span><span class="mtk11">TimedAspect</span><span class="mtk1">(registry);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="18"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="19"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>TimedAspect 를 적용해야 @Timed 에 AOP가 적용된다.</p>
<h4 id="메트릭-등록5---게이지" style="position:relative;"><a href="#%EB%A9%94%ED%8A%B8%EB%A6%AD-%EB%93%B1%EB%A1%9D5---%EA%B2%8C%EC%9D%B4%EC%A7%80" aria-label="메트릭 등록5   게이지 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>메트릭 등록5 - 게이지</h4>
<ul>
<li>Gauge(게이지)
<ul>
<li><a href="https://prometheus.io/docs/concepts/metric_types/#gauge" target="_blank" rel="nofollow noopener noreferrer">https://prometheus.io/docs/concepts/metric_types/#gauge</a></li>
<li>게이지는 임의로 오르내릴 수 있는 단일 숫자 값을 나타내는 메트릭</li>
<li>값의 현재 상태를 보는데 사용</li>
<li>값이 증가하거나 감소할 수 있음</li>
<li>예) 차량의 속도, CPU 사용량, 메모리 사용량</li>
</ul>
</li>
</ul>
<p>게이지 단순하게 등록하기</p>
<div
              class="gatsby-code-button-container copyButtonContainer"
              data-toaster-id="22022847334947017000"
              data-toaster-class="gatsby-code-button-toaster copyButtonToaster"
              data-toaster-text-class="gatsby-code-button-toaster-text copyButtonToasterText"
              data-toaster-text="customToasterText"
              data-toaster-duration="3500"
              onClick="copyToClipboard(`@Slf4j
@Configuration
public class StockConfigV2 {
    @Bean
    public MeterBinder stockSize(OrderService orderService) {
        return registry -> Gauge.builder(&quot;my.stock&quot;, orderService, service -> {
            log.info(&quot;stock gauge call&quot;);
            return service.getStock().get();
        }).register(registry);
    }
}`, `22022847334947017000`)"
            >
              <div
                class="gatsby-code-button copyButtonClass"
                data-tooltip=""
              >
                copyButtonText<svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>
              </div>
            </div>
<pre class="grvsc-container default-dark" data-language="java" data-index="50"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="1"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Slf4j</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="2"></span><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Configuration</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="3"></span><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">StockConfigV2</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="4"></span><span class="grvsc-source"><span class="mtk1">    @</span><span class="mtk10">Bean</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="5"></span><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">MeterBinder</span><span class="mtk1"> </span><span class="mtk11">stockSize</span><span class="mtk1">(</span><span class="mtk10">OrderService</span><span class="mtk1"> </span><span class="mtk12">orderService</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="6"></span><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk15">return</span><span class="mtk1"> registry </span><span class="mtk4">-&gt;</span><span class="mtk1"> </span><span class="mtk12">Gauge</span><span class="mtk1">.</span><span class="mtk11">builder</span><span class="mtk1">(</span><span class="mtk8">&quot;my.stock&quot;</span><span class="mtk1">, orderService, service </span><span class="mtk4">-&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="7"></span><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk12">log</span><span class="mtk1">.</span><span class="mtk11">info</span><span class="mtk1">(</span><span class="mtk8">&quot;stock gauge call&quot;</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="8"></span><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk12">service</span><span class="mtk1">.</span><span class="mtk11">getStock</span><span class="mtk1">().</span><span class="mtk11">get</span><span class="mtk1">();</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="9"></span><span class="grvsc-source"><span class="mtk1">        }).</span><span class="mtk11">register</span><span class="mtk1">(registry);</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="10"></span><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-gutter-pad"></span><span class="grvsc-gutter grvsc-line-number" aria-hidden="true" data-content="11"></span><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<h4 id="정리-5" style="position:relative;"><a href="#%EC%A0%95%EB%A6%AC-5" aria-label="정리 5 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정리</h4>
<p>메트릭은 100% 정확한 숫자를 보는데 사용하는 것이 아니다. 약간의 오차를 감안하고 실시간으로 대략의 데이터를 보는 목적으로 사용한다.</p>
<p>마이크로미터 핵심 기능
Counter, Gauge, Timer, Tags</p>
<p>Tag, 레이블</p>
<ul>
<li>Tag를 사용하면 데이터를 나누어서 확인할 수 있다.</li>
<li>Tag는 카디널리티가 낮으면서 그룹화 할 수 있는 단위에 사용해야 한다.</li>
<li>예) 성별, 주문 상태, 결제 수단[신용카드, 현금] 등등</li>
<li>카디널리티가 높으면 안된다. 예) 주문번호, PK 같은 것</li>
</ul>
<h4 id="실무-모니터링-화면-팁" style="position:relative;"><a href="#%EC%8B%A4%EB%AC%B4-%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81-%ED%99%94%EB%A9%B4-%ED%8C%81" aria-label="실무 모니터링 화면 팁 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>실무 모니터링 화면 팁</h4>
<p>모니터링 3단계</p>
<ul>
<li>대시보드</li>
<li>애플리케이션 추적 - 핀포인트</li>
<li>로그</li>
</ul>
<h4 id="대시보드" style="position:relative;"><a href="#%EB%8C%80%EC%8B%9C%EB%B3%B4%EB%93%9C" aria-label="대시보드 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>대시보드</h4>
<p>전체를 한눈에 볼 수 있는 가장 높은 뷰</p>
<p>제품</p>
<ul>
<li>마이크로미터, 프로메테우스, 그라파나 등등</li>
</ul>
<p>모니터링 대상</p>
<ul>
<li>시스템 메트릭(CPU, 메모리)</li>
<li>애플리케이션 메트릭(톰캣 쓰레드 풀, DB 커넥션 풀, 애플리케이션 호출 수)</li>
<li>비즈니스 메트릭(주문수, 취소수)</li>
</ul>
<h4 id="애플리케이션-추적" style="position:relative;"><a href="#%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%B6%94%EC%A0%81" aria-label="애플리케이션 추적 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>애플리케이션 추적</h4>
<p>주로 각각의 HTTP 요청을 추적, 일부는 마이크로서비스 환경에서 분산 추적</p>
<p>제품</p>
<ul>
<li>핀포인트(오픈소스), 스카우트(오픈소스), 와탭(상용), 제니퍼(상용)</li>
</ul>
<h4 id="로그" style="position:relative;"><a href="#%EB%A1%9C%EA%B7%B8" aria-label="로그 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>로그</h4>
<ul>
<li>가장 자세한 추적, 원하는데로 커스텀 가능</li>
<li>같은 HTTP 요청을 묶어서 확인할 수 있는 방법이 중요, MDC 적용</li>
</ul>
<p>파일로 직접 로그를 남기는 경우</p>
<ul>
<li>일반 로그와 에러 로그는 파일을 구분해서 남기자</li>
<li>에러 로그만 확인해서 문제를 바로 정리할 수 있음</li>
</ul>
<p>클라우드에 로그를 저장하는 경우</p>
<ul>
<li>검색이 잘 되도록 구분</li>
</ul>
<h4 id="모니터링-정리" style="position:relative;"><a href="#%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81-%EC%A0%95%EB%A6%AC" aria-label="모니터링 정리 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>모니터링 정리</h4>
<ul>
<li>각각 용도가 다르다.</li>
<li>관찰을 할 때는 전체 점점 좁게</li>
<li>핀포인트는 정말 좋다. 강추 마이크로 서비스 분산 모니터링도 가능, 대용량 트래픽에 대응</li>
</ul>
<h4 id="알람" style="position:relative;"><a href="#%EC%95%8C%EB%9E%8C" aria-label="알람 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>알람</h4>
<p>모니터링 툴에서 일정 이상 수치가 넘어가면, 슬랙, 문자 등을 연동</p>
<p>경고와 심각을 잘 나누어서 업무와 삶에 방해가 되지 않도록 해야함</p>
<h1 id="reference" style="position:relative;"><a href="#reference" aria-label="reference permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference</h1>
<p><a href="https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-%ED%95%B5%EC%8B%AC%EC%9B%90%EB%A6%AC-%ED%99%9C%EC%9A%A9/dashboard" target="_blank" rel="nofollow noopener noreferrer">스프링 부트 핵심 원리와 활용 - 김영한</a></p>
<style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line > * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: ' ';
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {
    content: ' ';
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .default-dark {
    background-color: #1E1E1E;
    color: #D4D4D4;
  }
  .default-dark .mtk4 { color: #569CD6; }
  .default-dark .mtk1 { color: #D4D4D4; }
  .default-dark .mtk10 { color: #4EC9B0; }
  .default-dark .mtk11 { color: #DCDCAA; }
  .default-dark .mtk12 { color: #9CDCFE; }
  .default-dark .mtk8 { color: #CE9178; }
  .default-dark .mtk3 { color: #6A9955; }
  .default-dark .mtk15 { color: #C586C0; }
  .default-dark .mtk7 { color: #B5CEA8; }
  .default-dark .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));
  }
</style></div><style data-emotion="css 1sq4j6o">.css-1sq4j6o{width:25%;padding:8px;position:-webkit-sticky;position:sticky;-webkit-align-self:flex-start;-ms-flex-item-align:flex-start;align-self:flex-start;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;top:72px;border:1px solid rgba(0, 0, 0, 0.12);border-radius:6px;}@media (max-width: 1080px){.css-1sq4j6o{display:none;}}</style><div class="css-1sq4j6o e1iookw12"><ul>
<li><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8-%EC%86%8C%EA%B0%9C">스프링 부트 소개</a></li>
<li><a href="#%EC%9B%B9-%EC%84%9C%EB%B2%84%EC%99%80-%EC%84%9C%EB%B8%94%EB%A6%BF-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88">웹 서버와 서블릿 컨테이너</a></li>
<li><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8%EC%99%80-%EB%82%B4%EC%9E%A5-%ED%86%B0%EC%BA%A3">스프링 부트와 내장 톰캣</a></li>
<li><a href="#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8-%EC%8A%A4%ED%83%80%ED%84%B0%EC%99%80-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EA%B4%80%EB%A6%AC">스프링 부트 스타터와 라이브러리 관리</a></li>
<li><a href="#%EC%9E%90%EB%8F%99-%EA%B5%AC%EC%84%B1">자동 구성</a></li>
<li><a href="#%EC%99%B8%EB%B6%80-%EC%84%A4%EC%A0%95%EA%B3%BC-%ED%94%84%EB%A1%9C%ED%95%84-1">외부 설정과 프로필 1</a></li>
<li><a href="#%EC%99%B8%EB%B6%80-%EC%84%A4%EC%A0%95%EA%B3%BC-%ED%94%84%EB%A1%9C%ED%95%84-2">외부 설정과 프로필 2</a></li>
<li><a href="#%EC%95%A1%EC%B8%84%EC%97%90%EC%9D%B4%ED%84%B0">액츄에이터</a></li>
<li><a href="#%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EB%AF%B8%ED%84%B0-%ED%94%84%EB%A1%9C%EB%A9%94%ED%85%8C%EC%9A%B0%EC%8A%A4-%EA%B7%B8%EB%9D%BC%ED%8C%8C%EB%82%98">마이크로미터, 프로메테우스, 그라파나</a></li>
<li><a href="#%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81-%EB%A9%94%ED%8A%B8%EB%A6%AD-%ED%99%9C%EC%9A%A9">모니터링 메트릭 활용</a></li>
<li><a href="#reference">Reference</a></li>
</ul></div></div><div class="css-0 e1iookw11"><div id="disqus_thread"></div></div></div></div><style data-emotion="css 9w9jmx">.css-9w9jmx{display:grid;place-items:center;margin-top:auto;padding:50px 0;font-size:15px;text-align:center;line-height:1.5;}@media (max-width: 768px){.css-9w9jmx{font-size:13px;}}</style><footer class="css-9w9jmx e1bfepno0">Thank You for Visiting My Blog, I hope you have an amazing day 😆<br/>© 2023 Ian, Powered By Gatsby.</footer></div></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/SpringBootCorePrinciples/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-6e88cdb9a8736ce745b3.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-5c97ada4935f63ea4dac.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-2a79c43e773fc0b792b9.js\"],\"component---src-pages-search-tsx\":[\"/component---src-pages-search-tsx-94ebe93d875ac40c1cab.js\"],\"component---src-templates-post-tsx\":[\"/component---src-templates-post-tsx-0eb74eeef903c575f946.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="6d4bbf9e8e00c6311832";</script><script src="/webpack-runtime-063578a15eb63226c8fa.js" async></script><script src="/framework-3a490fc63390479c2f13.js" async></script><script src="/app-6e88cdb9a8736ce745b3.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>